<?xml version="1.0" encoding="ISO-8859-1"?>
<AmiBroker-Analysis CompactMode="0">
<General>
<FormatVersion>1</FormatVersion>
<Symbol>ITA</Symbol>
<FormulaPath>Formulas\\Indicators\\code_HungCanslim\\1. Bo loc Caslim.afl</FormulaPath>
<FormulaContent>_SECTION_BEGIN("MA");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 30, 2, 300, 1, 10 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") ); \r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("Price");\r\nSetChartOptions(0,chartShowArrows|chartShowDates);\r\n_N(Title = StrFormat("{{NAME}} - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 ) ) ));\r\nPlot( C, "Close", ParamColor("Color", colorBlack ), styleDots | ParamStyle("Style") | GetPriceStyle() ); \r\n_SECTION_END();\r\n\r\n\r\n\r\nmua =  \r\n(C &gt;= Ref(C,-1)\r\nAND C &gt;= Ref(C,-2)\r\nAND C &gt;= Ref(C,-3)\r\nAND C &gt;= Ref(C,-4) \r\nAND C&gt;=MA(C,30)\r\nAND C&gt;1.01*Ref(C,-1)\r\nAND HHV(C,5) &gt;= HHV(C,15)\r\nAND Ref(C,-1)&lt;1.04*Ref(C,-2)\r\n\r\n)\r\n\r\n\r\n\r\n\r\n;\r\n \r\n\r\nban =  \r\n  \r\n    C &lt;= Ref(L,-1)\r\nAND C &lt;= Ref(L,-2)\r\nAND C &lt;= Ref(L,-3)\r\nAND C &lt;= Ref(L,-4)\r\nAND C &lt;= Ref(L,-5)\r\nAND C &lt;= Ref(L,-6)\r\nAND C &lt;= Ref(L,-7)\r\nAND C &lt;= Ref(L,-8)\r\n\r\n\r\n ;\r\n\r\n\r\n\r\n\r\n\r\n \r\nBuy = ExRem(mua, ban);\r\nSell = ExRem(ban, mua);\r\n\r\nPlotShapes(IIf(Buy,shapeUpArrow,shapeNone),colorBlue,0,Low,Offset=-10);\r\nPlotShapes(IIf(Sell,shapeDownArrow,shapeNone),colorRed,0,High,Offset=-10);\r\n\r\n\r\n\r\n;\r\nban1= \r\n(C &lt;= Ref(L,-1)\r\nAND C &lt;= Ref(L,-2)\r\nAND C &lt;= Ref(L,-3)\r\nAND C &lt;= Ref(L,-4))\r\n\r\nOR\r\n\r\n(C&lt;=0.95*HHV(H,1))\r\n;\r\nShort = ExRem(ban1, mua) AND C*V&gt;1000000 AND C&gt;=5;\r\n\r\n  Cover= \r\nC &gt; 1.02*Ref(H,-1) \r\nAND C&gt;=Ref(H,-2)\r\nAND (V &gt;= 1.3*MA(V,50) OR V &gt;= 1.3*MA(V,15))  \r\nAND C &gt;= (H + L)/ 2 \r\nAND C &gt; O\r\nAND C*V&gt;=1000000\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-3)\r\n\r\nAND C&gt;=5\r\nAND C&gt;MA(C,30)\r\nAND C &gt;= Ref(C,-2)\r\nAND C &gt;= Ref(C,-3)\r\nAND C &gt;= Ref(C,-4) \r\nAND C &gt;= Ref(C,-5)\r\nAND C &lt;1.15*LLV(C,10)\r\n\r\n;\r\n\r\nsideway = ( \r\n(C-LLV(L,5))/ LLV(L,5)&lt;=0.1\r\nAND C&gt;=5\r\nAND C*V &gt;= 1000000\r\nAND C&gt;MA(C,30)\r\n\r\nAND MA(V,15)&gt;50000\r\nAND C&lt;200\r\n\r\nAND HHV(C,5) &lt;1.1* LLV(C,5)\r\n\r\nAND HHV(C,10) &lt;1.15* LLV(C,10)\r\n\r\n \r\n\r\nAND RSI(14) &gt;=53\r\nAND RSI(14) &lt;60\r\nAND C&gt;=1.01*Ref(C,-1)\r\n)\r\n\r\n;\r\n\r\n\r\n\r\nPlotShapes(IIf(Short,shapeDownArrow,shapeNone),colorRed,0,High,Offset=-10);\r\n\r\nPlotShapes(IIf(Cover, shapeUpArrow,shapeNone),colorCustom12,0,Low,Offset=-10);    \r\n\r\n\r\n/*\r\n//batday\r\n(C*V&gt;=3000000\r\nAND C&gt;=5\r\nAND (C-L)/L &gt;=0.02\r\nAND C&lt;MA(C,30)\r\nAND MA(V,15) &gt;=100000\r\nAND C*V&lt;1000000000\r\nAND HHV(H,20) &gt;1.2*C\r\nAND Ref(RSI(14),-1) &lt;=35\r\nAND LLV(V,50) &gt;20000\r\nAND C &lt;1.15*LLV(C,10)\r\n\r\n)\r\nOR \r\n\r\n//tanggia\r\n(\r\nC*V&gt;=3000000\r\nAND C&gt;=3\r\nAND C&gt; 1.01*Ref(C,-1)\r\nAND LLV(V,50) &gt;30000\r\nAND C &lt;1.25*LLV(C,10)\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-1)\r\n\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-3)\r\nAND Ref(C,-3)&lt;=1.04*Ref(C,-2)\r\n\r\n)\r\n\r\n;*/\r\n\r\nBuy = \r\n (  C &gt;= Ref(H,-1) \r\nAND C &gt;= Ref(H,-2) \r\nAND C &gt;= Ref(H,-3) \r\nAND C &gt;= Ref(H,-4)\r\nAND C&gt;=5\r\nAND C&gt;=O\r\nAND C*V&gt;=3000000\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-3)\r\nAND Ref(V,-1) &lt; 1.3*MA(V,15)\r\nAND C &lt;1.2*LLV(C,10)\r\nAND V&gt;Ref(V,-1)\r\n)\r\nOR\r\n(\r\n    C &gt;= Ref(H,-1) \r\nAND C &gt;= Ref(H,-2) \r\nAND C &gt;= Ref(H,-3) \r\nAND C &gt;= Ref(H,-4)\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\n\r\nAND C&gt;=5\r\nAND C&gt;=O\r\nAND C&gt;=1.02*Ref(C,-1)\r\nAND C&gt;=Ref(C,-2)\r\nAND V&gt;=Ref(V,-1)\r\nAND V &gt;= 1.3*MA(V,15) \r\nAND C*V&gt;=3000000\r\n\r\n\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(V,-1)&gt;=100000\r\nAND C&gt;=5\r\nAND C&gt;1.3*LLV(L,50)\r\nAND C &lt;=1.15*LLV(C,10)\r\nAND Ref(V,-1) &lt; 1.3*MA(V,15)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND V&gt;Ref(V,-1)\r\n)\r\n\r\nOR \r\n(\r\nC &gt; 1.02*Ref(C,-1) \r\nAND C&gt;=Ref(C,-2)\r\nAND V &gt;= 1.3*MA(V,15)  \r\nAND MA(V,15)&gt;= 100000 \r\nAND MA(V,50)&gt;= 100000 \r\nAND C&gt; MA(C,15) \r\nAND V&gt;Ref(V,-1)\r\nAND C &gt;= (H + L)/ 2 \r\nAND C &gt; O\r\nAND C&gt;=5\r\nAND C*V&gt;=3000000\r\nAND C&gt;1.3*LLV(L,50)\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-3)\r\nAND Ref(C,-3)&lt;=1.04*Ref(C,-4)\r\nAND Ref(V,-1)&gt;=30000\r\nAND Ref(V,-5)&gt;=50000\r\nAND Ref(V,-10)&gt;=50000\r\nAND Ref(V,-15)&gt;=50000\r\nAND Ref(V,-20)&gt;=50000\r\nAND C&gt;= 0.8*HHV(C,60)\r\nAND C&gt; 1.2*LLV(L,60)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND Ref(V,-1) &lt; 1.3*MA(V,15)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND V&gt;Ref(V,-1)\r\n)\r\nOR\r\n(\r\nC &gt; Ref(H,-1) \r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-3)\r\nAND C &gt; Ref(H,-2) \r\nAND C &gt; Ref(H,-3) \r\nAND C &gt; Ref(H,-4)\r\nAND C&gt;MA(C,15)\r\nAND Ref(C,-1)&gt;MA(C,15)\r\nAND C&gt;=O\r\nAND C&gt;=5\r\nAND C&gt;=1.02*Ref(C,-1)\r\nAND C*V&gt;=3000000\r\nAND C&gt;1.3*LLV(L,50)\r\nAND V &gt;= 1.3*MA(V,15)\r\nAND V&gt;=Ref(V,-1)\r\nAND Ref(V,-5)&gt;=50000\r\nAND Ref(V,-10)&gt;=50000\r\nAND Ref(V,-15)&gt;=50000\r\nAND Ref(V,-20)&gt;=50000\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND Ref(V,-1) &lt; 1.3*MA(V,15)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND V&gt;Ref(V,-1)\r\n)\r\n\r\n\r\nOR\r\n(\r\nC &gt; 1.02*Ref(C,-1) \r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-3)\r\nAND C&gt;=Ref(C,-2)\r\nAND V &gt;= 1.3*MA(V,15)\r\nAND V&gt;=0.8*Ref(V,-1)\r\nAND MA(V,15)&gt;= 50000 \r\nAND MA(V,50)&gt;= 50000 \r\nAND C&gt; MA(C,15) \r\nAND C &gt;= (H + L)/ 2 \r\nAND C &gt; O\r\nAND C&gt;=5\r\nAND C*V&gt;=3000000\r\n\r\nAND C&gt;1.3*LLV(L,50)\r\nAND Ref(C,-1)&lt;=1.05*Ref(C,-2)\r\nAND Ref(V,-5)&gt;=50000\r\nAND Ref(V,-10)&gt;=50000\r\nAND Ref(V,-15)&gt;=50000\r\nAND Ref(V,-20)&gt;=50000\r\nAND C&gt;= 0.8*HHV(C,60)\r\nAND C&gt; 1.2*LLV(L,60)\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND Ref(V,-1) &lt; 1.3*MA(V,15)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND V&gt;Ref(V,-1)\r\n)\r\nOR \r\n( \r\nC &gt; Ref(H,-1) \r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-3)\r\nAND C &gt; Ref(H,-2) \r\nAND C &gt; Ref(H,-3) \r\nAND C &gt; Ref(H,-4)\r\nAND C&gt;MA(C,15)\r\nAND Ref(C,-1)&gt;MA(C,15)\r\nAND C&gt;=O\r\nAND C&gt;=1.02*Ref(C,-1)\r\nAND V&gt;=Ref(V,-1)\r\nAND C&gt;5\r\nAND C*V&gt;=3000000\r\nAND V &gt;= 1.3*MA(V,15)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND Ref(V,-1) &lt; 1.3*MA(V,15)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND V&gt;Ref(V,-1)\r\n)\r\n\r\nOR\r\n(C &gt; 1.02*Ref(H,-1) \r\nAND C&gt;=Ref(H,-2)\r\nAND (V &gt;= 1.3*MA(V,50) OR V &gt;= 1.3*MA(V,15))  \r\nAND C &gt;= (H + L)/ 2 \r\nAND C &gt; O\r\nAND C*V&gt;=1000000\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-3)\r\n\r\nAND C&gt;=5\r\nAND C&gt;MA(C,30)\r\nAND C &gt;= Ref(C,-2)\r\nAND C &gt;= Ref(C,-3)\r\nAND C &gt;= Ref(C,-4) \r\nAND C &gt;= Ref(C,-5)\r\nAND Ref(V,-1) &gt;=30000\r\n\r\nAND C &lt;1.15*LLV(C,10)\r\nAND Ref(V,-1) &lt; 1.3*MA(V,15)\r\nAND C &lt;1.15*LLV(C,10)\r\nAND V&gt;Ref(V,-1)\r\n)\r\nOR\r\n(C &gt;= Ref(C,-1)\r\nAND C &gt;= Ref(C,-2)\r\nAND C &gt;= Ref(C,-3)\r\nAND C &gt;= Ref(C,-4) \r\nAND C&gt;=MA(C,30)\r\nAND C&gt;1.01*Ref(C,-1)\r\nAND HHV(C,5) &gt;= HHV(C,15)\r\nAND Ref(C,-1)&lt;1.04*Ref(C,-2)\r\nAND Ref(V,-1) &lt; 1.3*MA(V,15)\r\n)\r\n\r\n;\r\nCover= \r\nC &gt; 1.02*Ref(H,-1) \r\nAND C&gt;=Ref(H,-2)\r\nAND (V &gt;= 1.3*MA(V,50) OR V &gt;= 1.3*MA(V,15))  \r\nAND C &gt;= (H + L)/ 2 \r\nAND C &gt; O\r\nAND C*V&gt;=1000000\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\n\r\n\r\nAND C&gt;=5\r\n\r\nAND C &gt;= Ref(C,-2)\r\nAND C &gt;= Ref(C,-3)\r\nAND C &gt;= Ref(C,-4) \r\n\r\n\r\nAND V&gt; Ref(V,-1)\r\n\r\n;\r\nbatday= (C*V&gt;=5000000\r\nAND C&gt;=3\r\nAND (C-L)/L &gt;=0.02\r\nAND C&lt;MA(C,30)\r\nAND MA(V,15) &gt;=100000\r\nAND Ref(V,-5)&gt;=50000\r\nAND Ref(V,-10)&gt;=50000\r\nAND Ref(V,-15)&gt;=50000\r\nAND Ref(V,-20)&gt;=50000\r\nAND C*V&lt;1000000000\r\nAND HHV(H,20) &gt;1.2*C\r\nAND Ref(RSI(14),-1) &lt;=35\r\nAND Ref(C,-1)&lt;=1.04*Ref(C,-2)\r\nAND Ref(C,-2)&lt;=1.04*Ref(C,-3)\r\n\r\n)\r\n\r\n;\r\n\r\nFilter = BatDay OR Buy OR Sell OR Cover;\r\nAddColumn( BatDay, "BatDay", 1, colorYellow, IIf (Filter,colorDarkOliveGreen, colorPaleGreen),65);\r\nAddColumn( Buy, "Buy", 1, colorYellow, IIf (Filter,colorDarkOliveGreen, colorPaleGreen),65);\r\nAddColumn( Sell, "Sell", 1, colorYellow, IIf (Filter,colorDarkOliveGreen, colorPaleGreen),65);\r\nAddColumn( Cover, "Cover", 1, colorYellow, IIf (Filter,colorDarkOliveGreen, colorPaleGreen),65);\r\ncao=Ref(HHV(C,10),-1);\r\nthap=Ref(LLV(C,10),-1);\r\ntl=(cao-thap)/cao*100;\r\nAddColumn(Ref(C,-2), "Price -2", 1.2);\r\nAddColumn(Ref(C,-1), "Price -1", 1.2);\r\nAddColumn(ROC(C,1),"%Tang ", 1.2,colorYellow,IIf(C&gt; Ref(C,-1),colorGreen,colorBrown),50);\r\nAddColumn(C,"Price",1.2,colorYellow,IIf(C&gt;Ref(C,-1),colorGreen,colorBrown),50);\r\nAddColumn(V,"Volume",1,colorYellow,IIf(V&gt;Ref(V,-1),colorGreen,colorBrown),90);\r\nAddColumn(MA(C,20), "MA(20)", 1.2);\r\nAddColumn(MA(C,50), "MA(50)", 1.2);\r\nAddColumn(tl,"Tích Luy (%)",1.2,IIf(tl&lt;=10,colorDefault,colorBlue),colorDefault,80);\r\nAddColumn(C*V,"Gia tri GD ",1,colorBlack,colorDefault,90);\r\nAddColumn(((V - MA(V,50))/MA(V,50))*100 ,"% Dot bien KL");\r\nAddColumn((((C - Ref(C,-20))/Ref(C,-20))*100 +((C - Ref(C,-40))/Ref(C,-40))*100+((C - Ref(C,-60))/Ref(C,-60))*100)/3 ,"BQ tang 3Tg");\r\nAddColumn(RSI(14),"RSI");\r\nAddColumn(O," Open ",1.2); \r\nAddColumn(H," High ",1.2,colorYellow,colorGreen,50);\r\nAddColumn(L," Low ",1.2,colorYellow,colorDarkRed,50);\r\n\r\n\r\nAddSummaryRows(16, 1.2,5);\r\nSetSortColumns( -5 ) ;\r\nSAN = MarketID( 1 );\r\nTSAN=WriteIf(Filter,""+SAN,"");\r\nAddTextColumn(TSAN, "SAN GD", 1, colorYellow, IIf (Filter,colorDarkOliveGreen, colorPaleGreen),65);\r\n\r\nNGANH = StrRight(IndustryID(1),StrLen(IndustryID(1))-StrFind(IndustryID(1)," "));\r\nNHOMNGANH=WriteIf(Filter,""+NGANH,"");\r\nAddTextColumn(NHOMNGANH, "NHOM NGANH", 1, colorYellow, IIf (Filter,colorDarkOliveGreen, colorPaleGreen),150);\r\n_SECTION_END();\r\n\r\n_SECTION_BEGIN("MA1");\r\nP = ParamField("Price field",-1);\r\nPeriods = Param("Periods", 40, 2, 300, 1, 10 );\r\nPlot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( "Color", colorCycle ), ParamStyle("Style") ); \r\n_SECTION_END();\r\n\r\n\r\nx = MA(C,5);\r\ny = MA (C,30);\r\n\r\nPlotOHLC( x, x, y, y, "", IIf(x &gt; y,colorPaleGreen, colorPink),styleNoLabel|styleCloud );\r\n_SECTION_BEGIN("MA5-MA30 Crossover");\r\n\r\n_SECTION_BEGIN("SupportResistance");\r\n// START SCRIPT UNTUK SUPPORT / RESISTANT\r\n \r\n \r\nWarnaResistant = ParamColor("Warna Garis Resistant",colorRed);\r\nWarnaSupport = ParamColor("Warna Garis Support",colorGreen);\r\nR1_show = 0;\r\nS1_show = 0;\r\n \r\nSRStyle = ParamStyle("S/R Style",styleThick);\r\n \r\nif (ParamToggle("Garis Support&amp;Resistance", "Tidak|Ya", 1 ))\r\n{\r\n\t// RESISTANT\r\n\tLastHighestValue = LastVisibleValue(Ref(C,-1));\r\n\tif (LastVisibleValue(C) == C[LastValue(BarIndex())])\r\n\t\tLastHighestValue = LastVisibleValue(C);\r\n \r\n\ti = 1;\r\n\t\r\n\tif (LastHighestValue &lt; HighestVisibleValue(C))\r\n\t{\r\n\t\t\twhile (LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1),Ref(C, -1), i)) &lt; LastHighestValue)\r\n\t\t\t\ti++;\r\n \r\n\t    \tR1 = LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1),Ref(C, -1), i));\r\n \r\n\t\t\tR1x = LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1),Ref(BarIndex(), -1), i));\r\n\t\t\tPlot(IIf(BarIndex() &gt;= R1x,LastValue(R1),Null),"",WarnaResistant ,SRStyle);\r\n\t\t\tPlotText(" : " + R1, BarCount + 1, LastValue(R1), WarnaResistant);\r\n\t\t\tR1_show = 1;\r\n \r\n\t\t\ti++;\r\n \r\n\t\t\tif (HighestVisibleValue( C ) &gt; R1)\r\n\t\t\t{\r\n\t\t\t\twhile (LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1), Ref(C,-1), i)) &lt;= R1)\r\n\t\t\t\t\ti++;\r\n \r\n\t\t\t\tR2 = LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1), Ref(C,-1), i));\r\n\t\t\t\tR2x = LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1),Ref(BarIndex(), -1), i));\r\n\t\r\n\t\t\t\tPlot(IIf(BarIndex() &gt;= R2x,LastValue(R2),Null),"",WarnaResistant ,SRStyle);\r\n\t\t\t\tPlotText(" : " + R2, BarCount + 11, LastValue(R2), WarnaResistant);\r\n\t\t\t\ti++;\r\n\t\t\t\tif (HighestVisibleValue( C )&gt; R2)\r\n\t\t\t\t{ \t\t\r\n\t\t\t\t\twhile (LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1), Ref(C,-1), i)) &lt;= R2)\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\tR3 = LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1), Ref(C,-1), i));\r\n\t\t\t\t\tR3x = LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1),Ref(BarIndex(), -1), i));\t\r\n \r\n\t\t\t\t\tPlot(IIf(BarIndex() &gt;= R3x,LastValue(R3),Null),"",WarnaResistant ,SRStyle);\r\n\t\t\t\t\tPlotText(" : " + R3, BarCount + 21, LastValue(R3), WarnaResistant);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t}\r\n\telse if (LastHighestValue == HighestVisibleValue(H))\r\n\t{\r\n\t   \tR1 = LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1),Ref(C, -1), i));\r\n\t\tR1x = LastVisibleValue(ValueWhen(C &lt;= Ref(C,-1) AND Ref(C,-2) &lt;= Ref(C, -1),Ref(BarIndex(), -1), i));\r\n\t\tif (R1 == LastHighestValue)\r\n\t\t{\r\n\t\t\tPlot(IIf(BarIndex() &gt;= R1x,LastValue(R1),Null),"",WarnaResistant ,SRStyle);\r\n\t\t\tPlotText(" : " + R1, BarCount + 1, LastValue(R1), WarnaResistant);\r\n\t\t\tR1_show = 1;\r\n\t\t}\r\n\t}\r\n \r\n\t// SUPPORT\r\n\tLastLowestValue = LastVisibleValue(Ref(C,-1));\r\n\tif (LastVisibleValue(C) == C[LastValue(BarIndex())])\r\n\t\tLastLowestValue = LastVisibleValue(C);\r\n \r\n\ti = 1;\r\n \r\n\tif (LastLowestValue &gt; LowestVisibleValue(C))\r\n\t{\t\r\n\t\t\twhile (LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1),Ref(C, -1), i)) &gt; LastLowestValue)\r\n\t\t\t\ti++;\r\n \r\n\t\t\tS1 = LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1),Ref(C, -1), i));\r\n\t\t\tS1x = LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1),Ref(BarIndex(), -1), i));\r\n\t\t\tPlot(IIf(BarIndex() &gt;= S1x,LastValue(S1),Null),"",WarnaSupport ,SRStyle);\r\n\t\t\tPlotText(" : " + S1, BarCount + 1, LastValue(S1), WarnaSupport);\r\n\t\t\tS1_show = 1;\r\n\t\t\ti++;\r\n \r\n\t\t\tif (LowestVisibleValue( C ) &lt; S1)\r\n\t\t\t{\r\n\t\t\t\twhile (LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1), Ref(C,-1), i)) &gt;= S1)\r\n\t\t\t\t\ti++;\r\n \r\n\t\t\t\tS2 = LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1), Ref(C,-1), i));\r\n\t\t\t\tS2x = LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1), Ref(BarIndex(),-1), i));\t\r\n \r\n\t\t\t\tPlot(IIf(BarIndex() &gt;= S2x,LastValue(S2),Null),"",WarnaSupport ,SRStyle);\r\n\t\t\t\tPlotText(" : " + S2, BarCount + 11, LastValue(S2), WarnaSupport);\r\n\t\t\t\ti++;\r\n\t\t\t\tif (LowestVisibleValue( C )&lt; S2)\r\n\t\t\t\t{ \t\t\r\n\t\t\t\t\twhile (LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1), Ref(C,-1), i)) &gt;= S2)\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\tS3 = LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1), Ref(C,-1), i));\r\n\t\t\t\t\tS3x = LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1), Ref(BarIndex(),-1), i));\r\n\t\t\t\t\tPlot(IIf(BarIndex() &gt;= S3x,LastValue(S3),Null),"",WarnaSupport ,SRStyle);\r\n\t\t\t\t\tPlotText(" : " + S3, BarCount + 21, LastValue(S3), WarnaSupport);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t}\r\n\telse if (LastLowestValue == LowestVisibleValue(C))\r\n\t{\r\n\t   \tS1 = LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1),Ref(C, -1), i));\r\n\t\tS1x = LastVisibleValue(ValueWhen(C &gt;= Ref(C,-1) AND Ref(C,-2) &gt;= Ref(C, -1),Ref(BarIndex(), -1), i));\r\n\t\tif (S1 == LastLowestValue)\r\n\t\t{\r\n\t\t\tPlot(IIf(BarIndex() &gt;= S1x,LastValue(S1),Null),"",WarnaSupport ,SRStyle);\r\n\t\t\tPlotText(" : " + S1, BarCount + 1, LastValue(S1), WarnaSupport);\r\n\t\t\tS1_show = 1;\r\n\t\t}\r\n\t}\r\n \r\n\tif (S1_show AND R1_show)\r\n\t{\r\n\t\tSR = Prec((1-(S1/R1))*100,2);\r\n\t}\r\n}\r\n \r\n// END SCRIPT UNTUK SUPPORT / RESISTANT\r\n_SECTION_END();\r\n</FormulaContent>
<ApplyTo>2</ApplyTo>
<RangeType>2</RangeType>
<RangeAmount>1</RangeAmount>
<FromDate>2023-12-26 00:00:00</FromDate>
<ToDate>2023-12-26</ToDate>
<SyncOnSelect>0</SyncOnSelect>
<RunEvery>0</RunEvery>
<RunEveryInterval>5min</RunEveryInterval>
<IncludeFilter>
<ExcludeMode>0</ExcludeMode>
<OrSelection>0</OrSelection>
<Favourite>0</Favourite>
<Index>0</Index>
<Type0>0</Type0>
<Category0>-1</Category0>
<Type1>1</Type1>
<Category1>-1</Category1>
<Type2>2</Type2>
<Category2>-1</Category2>
<Type3>3</Type3>
<Category3>-1</Category3>
<Type4>4</Type4>
<Category4>0</Category4>
<Type5>5</Type5>
<Category5>-1</Category5>
<Type6>6</Type6>
<Category6>-1</Category6>
</IncludeFilter>
<ExcludeFilter>
<ExcludeMode>1</ExcludeMode>
<OrSelection>0</OrSelection>
<Favourite>0</Favourite>
<Index>0</Index>
<Type0>0</Type0>
<Category0>-1</Category0>
<Type1>1</Type1>
<Category1>-1</Category1>
<Type2>2</Type2>
<Category2>-1</Category2>
<Type3>3</Type3>
<Category3>-1</Category3>
<Type4>4</Type4>
<Category4>-1</Category4>
<Type5>5</Type5>
<Category5>-1</Category5>
<Type6>6</Type6>
<Category6>-1</Category6>
</ExcludeFilter>
</General>
<BacktestSettings>
<InitialEquity>10000</InitialEquity>
<TradeFlags>1</TradeFlags>
<MaxLossStopMode>0</MaxLossStopMode>
<MaxLossStopValue>0</MaxLossStopValue>
<MaxLossStopAtStop>0</MaxLossStopAtStop>
<ProfitStopMode>0</ProfitStopMode>
<ProfitStopValue>0</ProfitStopValue>
<ProfitStopAtStop>0</ProfitStopAtStop>
<TrailingStopMode>0</TrailingStopMode>
<TrailingStopPeriods>0</TrailingStopPeriods>
<TrailingStopValue>0</TrailingStopValue>
<TrailingStopAtStop>0</TrailingStopAtStop>
<CommissionMode>0</CommissionMode>
<CommissionValue>0</CommissionValue>
<BuyPriceField>0</BuyPriceField>
<BuyDelay>0</BuyDelay>
<SellPriceField>0</SellPriceField>
<SellDelay>0</SellDelay>
<ShortPriceField>0</ShortPriceField>
<ShortDelay>0</ShortDelay>
<CoverPriceField>0</CoverPriceField>
<CoverDelay>0</CoverDelay>
<ReportSystemFormula>0</ReportSystemFormula>
<ReportSystemSettings>0</ReportSystemSettings>
<ReportOverallSummary>1</ReportOverallSummary>
<ReportSummary>1</ReportSummary>
<ReportTradeList>1</ReportTradeList>
<LoadRemainingQuotes>1</LoadRemainingQuotes>
<Periodicity>0</Periodicity>
<InterestRate>0</InterestRate>
<ReportOutPositions>1</ReportOutPositions>
<UseConstantPriceArrays>0</UseConstantPriceArrays>
<PointsOnlyTest>0</PointsOnlyTest>
<AllowShrinkingPosition>0</AllowShrinkingPosition>
<RangeType>2</RangeType>
<RangeLength>0</RangeLength>
<RangeFromDate>2023-12-26 00:00:00</RangeFromDate>
<RangeToDate>2023-12-26</RangeToDate>
<ApplyTo>2</ApplyTo>
<FilterQty>2</FilterQty>
<IncludeFilter>
<ExcludeMode>0</ExcludeMode>
<OrSelection>0</OrSelection>
<Favourite>0</Favourite>
<Index>0</Index>
<Type0>0</Type0>
<Category0>-1</Category0>
<Type1>1</Type1>
<Category1>-1</Category1>
<Type2>2</Type2>
<Category2>-1</Category2>
<Type3>3</Type3>
<Category3>-1</Category3>
<Type4>4</Type4>
<Category4>0</Category4>
<Type5>5</Type5>
<Category5>-1</Category5>
<Type6>6</Type6>
<Category6>-1</Category6>
</IncludeFilter>
<ExcludeFilter>
<ExcludeMode>1</ExcludeMode>
<OrSelection>0</OrSelection>
<Favourite>0</Favourite>
<Index>0</Index>
<Type0>0</Type0>
<Category0>-1</Category0>
<Type1>1</Type1>
<Category1>-1</Category1>
<Type2>2</Type2>
<Category2>-1</Category2>
<Type3>3</Type3>
<Category3>-1</Category3>
<Type4>4</Type4>
<Category4>-1</Category4>
<Type5>5</Type5>
<Category5>-1</Category5>
<Type6>6</Type6>
<Category6>-1</Category6>
</ExcludeFilter>
<UseOptimizedEvaluation>0</UseOptimizedEvaluation>
<BacktestRangeType>2</BacktestRangeType>
<BacktestRangeLength>0</BacktestRangeLength>
<BacktestRangeFromDate>2023-12-26 00:00:00</BacktestRangeFromDate>
<BacktestRangeToDate>2023-12-26</BacktestRangeToDate>
<MarginRequirement>100</MarginRequirement>
<SameDayStops>0</SameDayStops>
<RoundLotSize>0</RoundLotSize>
<TickSize>0</TickSize>
<DrawdownPriceField>0</DrawdownPriceField>
<ReverseSignalForcesExit>1</ReverseSignalForcesExit>
<NoDefaultColumns>0</NoDefaultColumns>
<AllowSameBarExit>1</AllowSameBarExit>
<ExtensiveOptimizationWarning>1</ExtensiveOptimizationWarning>
<WaitForBackfill>0</WaitForBackfill>
<MaxRanked>4</MaxRanked>
<MaxTraded>4</MaxTraded>
<MaxTracked>100</MaxTracked>
<PortfolioReportMode>0</PortfolioReportMode>
<MinShares>0.1</MinShares>
<SharpeRiskFreeReturn>5</SharpeRiskFreeReturn>
<PortfolioMode>0</PortfolioMode>
<PriceBoundCheck>1</PriceBoundCheck>
<AlignToReferenceSymbol>0</AlignToReferenceSymbol>
<ReferenceSymbol>^DJI</ReferenceSymbol>
<UPIRiskFreeReturn>5.4</UPIRiskFreeReturn>
<NBarStopMode>0</NBarStopMode>
<NBarStopValue>0</NBarStopValue>
<NBarStopReentryDelay>0</NBarStopReentryDelay>
<MaxLossStopReentryDelay>0</MaxLossStopReentryDelay>
<ProfitStopReentryDelay>0</ProfitStopReentryDelay>
<TrailingStopReentryDelay>0</TrailingStopReentryDelay>
<AddFutureBars>0</AddFutureBars>
<DistChartSpacing>5</DistChartSpacing>
<ProfitDistribution>1</ProfitDistribution>
<MAFEDistribution>1</MAFEDistribution>
<IndividualDetailedReports>0</IndividualDetailedReports>
<PortfolioReportTradeList>1</PortfolioReportTradeList>
<LimitTradeSizeAsPctVol>10</LimitTradeSizeAsPctVol>
<DisableSizeLimitWhenVolumeIsZero>1</DisableSizeLimitWhenVolumeIsZero>
<UsePrevBarEquityForPosSizing>0</UsePrevBarEquityForPosSizing>
<NBarStopHasPriority>0</NBarStopHasPriority>
<UseCustomBacktestProc>0</UseCustomBacktestProc>
<CustomBacktestProcFormulaPath/>
<MinPosValue>0</MinPosValue>
<MaxPosValue>0</MaxPosValue>
<ChartInterval>86400</ChartInterval>
<DisableRuinStop>0</DisableRuinStop>
<OptTarget>CAR/MDD</OptTarget>
<WFMode>0</WFMode>
<GenerateReport>1</GenerateReport>
<MaxLongPos>0</MaxLongPos>
<MaxShortPos>0</MaxShortPos>
<SeparateLongShortRank>0</SeparateLongShortRank>
<TotalSymbolQty>194</TotalSymbolQty>
<EnableUserReportCharts>1</EnableUserReportCharts>
<ChartWidth>800</ChartWidth>
<ChartHeight>480</ChartHeight>
<SettlementDelay>0</SettlementDelay>
<PortfolioReportSystemFormula>1</PortfolioReportSystemFormula>
<InterestRateSymbol/>
<MarginRate>0</MarginRate>
<IncludeBHStats>1</IncludeBHStats>
<BHSymbol>^DJI</BHSymbol>
<MCEnable>1</MCEnable>
<MCRuns>1000</MCRuns>
<MCPosSizeMethod>0</MCPosSizeMethod>
<MCPosSizeShares>100</MCPosSizeShares>
<MCPosSizeValue>1000</MCPosSizeValue>
<MCPosSizePctEquity>5</MCPosSizePctEquity>
<MCChartEquityCurves>1</MCChartEquityCurves>
<MCStrawBroomLines>0</MCStrawBroomLines>
<Scenario>0</Scenario>
<MCChartEquityScale>0</MCChartEquityScale>
<MCUseEquityChanges>0</MCUseEquityChanges>
<MCLogScaleFinalEquity>0</MCLogScaleFinalEquity>
<MCLogScaleDrawdown>0</MCLogScaleDrawdown>
<MCNegativeDrawdown>1</MCNegativeDrawdown>
<ISEnabled>1</ISEnabled>
<ISStartDate>2000-01-01</ISStartDate>
<ISEndDate>2004-01-01</ISEndDate>
<ISLastDate>2018-01-01</ISLastDate>
<ISStep>1</ISStep>
<ISStepUnit>3</ISStepUnit>
<ISAnchored>0</ISAnchored>
<ISLastUsesToday>1</ISLastUsesToday>
<OSEnabled>1</OSEnabled>
<OSStartDate>2004-01-01</OSStartDate>
<OSEndDate>2005-01-01</OSEndDate>
<OSLastDate>2019-01-01</OSLastDate>
<OSStep>1</OSStep>
<OSStepUnit>3</OSStepUnit>
<OSAnchored>0</OSAnchored>
<OSLastUsesToday>1</OSLastUsesToday>
</BacktestSettings>
</AmiBroker-Analysis>
