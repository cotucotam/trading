<?xml version="1.0" encoding="ISO-8859-1"?>
<AmiBroker-Analysis CompactMode="0">
<General>
<FormatVersion>1</FormatVersion>
<Symbol>ITA</Symbol>
<FormulaPath>Formulas\\Indicators\\suutam\\Da diem phu thuoc chi so (1).afl</FormulaPath>
<FormulaContent>\r\n_SECTION_BEGIN("Realtime"); //Tach gio phut giay hien tai\r\nRealtimeClock = ValueWhen(LastValue(V)&gt;0 , LastValue( Now(4)));\r\nGioHientai = ValueWhen(LastValue(V)&gt;0 , LastValue( int(RealtimeClock/10000)));\r\nPhutHienTai = ValueWhen(LastValue(V)&gt;0 , LastValue( int((RealtimeClock - GioHientai*10000)/100)));\r\nGiayHienTai = ValueWhen(LastValue(V)&gt;0 , LastValue( RealtimeClock - (GioHientai*10000 + PhutHienTai*100)));\r\nRealtime  = LastValue( GioHientai*60 + PhutHienTai);//So phut da dien ra trong ngay\r\nNgayhientai = ValueWhen(LastValue(V)&gt;0 , LastValue( Now(6)));\r\nThanghientai = ValueWhen(LastValue(V)&gt;0 , LastValue( Now(7)));\r\nNamhientai = ValueWhen(LastValue(V)&gt;0 , LastValue( Now(8)));\r\n_SECTION_END();\r\nSetForeign("VNINDEX");//Ham Lam viec truc tiep voi 1 ma nhat dinh, o day la Vnindex\r\ntestTimeVningay =ValueWhen(LastValue(V)&gt;0 , LastValue(Day()));\r\ntestTimeVnithang =ValueWhen(LastValue(V)&gt;0 , LastValue(Month()));\r\ntestTimeVninam =ValueWhen(LastValue(V)&gt;0 , LastValue(Year()));\r\nTongthoigianGiaodichVni = (testTimeVninam*100 + testTimeVnithang)*100 + testTimeVningay;\r\nDieukienThoiGian = IIf(testTimeVningay == Ngayhientai AND testTimeVnithang == Thanghientai AND testTimeVninam == Namhientai,2,-2);\r\nstartTimeVni1 = 9*60; // Th?i gian b?t d?u giao d?ch (9:00 AM)\r\nendTimeVni1 = 11*60 +30; // Th?i gian k?t thúc giao d?ch (11:30 PM)\r\nstartTimeVni2 = 13*60; // Th?i gian b?t d?u giao d?ch (13:00 PM)\r\nendTimeVni2 = 14*60+45; // Th?i gian k?t thúc giao d?ch (14:45 PM)\r\nPhienSangVni = (endTimeVni1 - startTimeVni1);\r\nPhienChieuVni = (endTimeVni2 - startTimeVni2);\r\nFulltimeVni = (endTimeVni1 - startTimeVni1) + (endTimeVni2 - startTimeVni2);\r\nInTimeVni  = IIf(DieukienThoiGian==2 AND LastValue(V)&gt;0 AND  Realtime&gt;= startTimeVni1 AND Realtime &lt;= endTimeVni1,Realtime -startTimeVni1,\r\n\t\t\t\tIIf(DieukienThoiGian==2 AND LastValue(V)&gt;0 AND Realtime &gt; endTimeVni1 AND Realtime &lt; startTimeVni2,PhienSangVni,\r\n\t\t\t\tIIf(DieukienThoiGian==2 AND LastValue(V)&gt;0 AND Realtime &gt;= startTimeVni2 AND Realtime&lt;= endTimeVni2,PhienSangVni + (Realtime - startTimeVni2),FulltimeVni)));\t\r\nDanhgiaADXVNINDEX = IIf(ADX(14) &gt; Ref(ADX(14),-1),1,IIf(ADX(14) &lt; Ref(ADX(14),-1),-1,0));\r\nDanhgiaHSVNINDEX = IIf((PDI(14) - MDI(14)) &gt; Ref((PDI(14) - MDI(14)),-1),1 ,IIf((PDI(14) - MDI(14)) &lt; Ref((PDI(14) - MDI(14)),-1),-1,0));\r\nDanhgiaEMAHSVNINDEX = IIf(EMA((PDI(14) - MDI(14)),5) &gt; Ref(EMA((PDI(14) - MDI(14)),5),-1),1,IIf(EMA((PDI(14) - MDI(14)),5) &lt; Ref(EMA((PDI(14) - MDI(14)),5),-1),-1,0));\r\nDanhgiaTopVNINDEX = \tIIf(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))) &gt; Ref(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),-1),1,\r\n\t\t\t\tIIf(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))) &lt; Ref(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),-1),-1,0));\r\nDanhgiaEMATopVNINDEX = IIf(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5) &gt; Ref(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5),-1),1,\r\n\t\t\t\tIIf(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5) &lt; Ref(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5),-1),-1,0));\r\nDanhgiaMACDVNINDEX = IIf(MACD(12, 26) &gt; Ref(MACD(12, 26),-1),1,IIf(MACD(12, 26) &lt; Ref(MACD(12, 26),-1),-1,0));\r\nDanhgiaSignalVNINDEX = IIf( Signal(12,26,9) &gt; Ref(Signal(12,26,9),-1),1, IIf(Signal(12,26,9) &lt; Ref(Signal(12,26,9),-1),-1,0));\r\nDanhgiaHitoVNINDEX = IIf((MACD(12, 26) - Signal(12,26,9)) &gt; Ref((MACD(12, 26) - Signal(12,26,9)),-1),1, IIf((MACD(12, 26) - Signal(12,26,9)) &lt; Ref((MACD(12, 26) - Signal(12,26,9)),-1),-1,0));\r\nDanhgiaCCIVNINDEX = IIf(CCI( 14 ) &gt; Ref(CCI( 14 ),-1),1,IIf(CCI( 14 ) &lt; Ref(CCI( 14 ),-1),-1,0));\r\nDanhgiaEMACCIVNINDEX = IIf(EMA(CCI( 14 ),5) &gt; Ref(EMA(CCI( 14 ),5),-1),1,IIf(EMA(CCI( 14 ),5) &lt; Ref(EMA(CCI( 14 ),5),-1),-1,0));\r\nDanhgiaTHVNINDEX = DanhgiaADXVNINDEX + DanhgiaHSVNINDEX + DanhgiaEMAHSVNINDEX + DanhgiaTopVNINDEX + DanhgiaEMATopVNINDEX + DanhgiaMACDVNINDEX + DanhgiaSignalVNINDEX + DanhgiaHitoVNINDEX + DanhgiaCCIVNINDEX + DanhgiaEMACCIVNINDEX;//Gia tri diem\r\nMauDanhgiaVNINDEX = IIf(DanhgiaTHVNINDEX &gt; Ref(DanhgiaTHVNINDEX,-1), colorGreen, IIf(DanhgiaTHVNINDEX &lt; Ref(DanhgiaTHVNINDEX,-1),colorRed, colorDefault));\r\nHSDanhgiaVNINDEX = DanhgiaTHVNINDEX - Ref(DanhgiaTHVNINDEX,-1);// Tang giam diem\r\n\r\nRestorePriceArrays();//tra lai lam viec chung cho toan thi truong \r\nSetForeign("HNXINDEX");\r\ntestTimeHNXngay =ValueWhen(LastValue(V)&gt;0 , LastValue(Day()));\r\ntestTimeHNXthang =ValueWhen(LastValue(V)&gt;0 , LastValue(Month()));\r\ntestTimeHNXnam =ValueWhen(LastValue(V)&gt;0 , LastValue(Year()));\r\nTongthoigianGiaodichHNX = (testTimeHNXnam*100 + testTimeHNXthang)*100 + testTimeHNXngay;\r\nstartTimeHNX1 = 9*60; \r\nendTimeHNX1 = 11*60 +30;\r\nstartTimeHNX2 = 13*60; \r\nendTimeHNX2 = 15*60;\r\nPhienSangHNX = (endTimeHNX1 - startTimeHNX1);\r\nPhienChieuHNX = (endTimeHNX2 - startTimeHNX2);\r\nFulltimeHNX = (endTimeHNX1 - startTimeHNX1) + (endTimeHNX2 - startTimeHNX2);\r\nInTimeHNX  = IIf(DieukienThoiGian==2 AND LastValue(V)&gt;0 AND  Realtime&gt;= startTimeHNX1 AND Realtime &lt;= endTimeHNX1,Realtime -startTimeHNX1,\r\n\t\t\t\tIIf(DieukienThoiGian==2 AND LastValue(V)&gt;0 AND Realtime &gt; endTimeHNX1 AND Realtime &lt; startTimeHNX2,PhienSangHNX,\r\n\t\t\t\tIIf(DieukienThoiGian==2 AND LastValue(V)&gt;0 AND Realtime &gt;= startTimeHNX2 AND Realtime&lt;= endTimeHNX2,PhienSangHNX + (Realtime - startTimeHNX2),FulltimeHNX)));\r\nDanhgiaADXHNXINDEX = IIf(ADX(14) &gt; Ref(ADX(14),-1),1,IIf(ADX(14) &lt; Ref(ADX(14),-1),-1,0));\r\nDanhgiaHSHNXINDEX = IIf((PDI(14) - MDI(14)) &gt; Ref((PDI(14) - MDI(14)),-1),1 ,IIf((PDI(14) - MDI(14)) &lt; Ref((PDI(14) - MDI(14)),-1),-1,0));\r\nDanhgiaEMAHSHNXINDEX = IIf(EMA((PDI(14) - MDI(14)),5) &gt; Ref(EMA((PDI(14) - MDI(14)),5),-1),1,IIf(EMA((PDI(14) - MDI(14)),5) &lt; Ref(EMA((PDI(14) - MDI(14)),5),-1),-1,0));\r\nDanhgiaTopHNXINDEX = \tIIf(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))) &gt; Ref(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),-1),1,\r\n\t\t\t\tIIf(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))) &lt; Ref(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),-1),-1,0));\r\nDanhgiaEMATopHNXINDEX = IIf(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5) &gt; Ref(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5),-1),1,\r\n\t\t\t\tIIf(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5) &lt; Ref(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5),-1),-1,0));\r\nDanhgiaMACDHNXINDEX = IIf(MACD(12, 26) &gt; Ref(MACD(12, 26),-1),1,IIf(MACD(12, 26) &lt; Ref(MACD(12, 26),-1),-1,0));\r\nDanhgiaSignalHNXINDEX = IIf( Signal(12,26,9) &gt; Ref(Signal(12,26,9),-1),1, IIf(Signal(12,26,9) &lt; Ref(Signal(12,26,9),-1),-1,0));\r\nDanhgiaHitoHNXINDEX = IIf((MACD(12, 26) - Signal(12,26,9)) &gt; Ref((MACD(12, 26) - Signal(12,26,9)),-1),1, IIf((MACD(12, 26) - Signal(12,26,9)) &lt; Ref((MACD(12, 26) - Signal(12,26,9)),-1),-1,0));\r\nDanhgiaCCIHNXINDEX = IIf(CCI( 14 ) &gt; Ref(CCI( 14 ),-1),1,IIf(CCI( 14 ) &lt; Ref(CCI( 14 ),-1),-1,0));\r\nDanhgiaEMACCIHNXINDEX = IIf(EMA(CCI( 14 ),5) &gt; Ref(EMA(CCI( 14 ),5),-1),1,IIf(EMA(CCI( 14 ),5) &lt; Ref(EMA(CCI( 14 ),5),-1),-1,0));\r\nDanhgiaTHHNXINDEX = DanhgiaADXHNXINDEX + DanhgiaHSHNXINDEX + DanhgiaEMAHSHNXINDEX + DanhgiaTopHNXINDEX + DanhgiaEMATopHNXINDEX + DanhgiaMACDHNXINDEX + DanhgiaSignalHNXINDEX + DanhgiaHitoHNXINDEX + DanhgiaCCIHNXINDEX + DanhgiaEMACCIHNXINDEX;//Gia tri diem\r\nMauDanhgiaHNXINDEX = IIf(DanhgiaTHHNXINDEX &gt; Ref(DanhgiaTHHNXINDEX,-1), colorGreen, IIf(DanhgiaTHHNXINDEX &lt; Ref(DanhgiaTHHNXINDEX,-1),colorRed, colorDefault));\r\nHSDanhgiaHNXINDEX = DanhgiaTHHNXINDEX - Ref(DanhgiaTHHNXINDEX,-1);// Tang giam diem\r\nRestorePriceArrays();//tra lai lam viec chung cho toan thi truong \r\nSetForeign("UPINDEX");\r\ntestTimeUpcomngay =ValueWhen(LastValue(V)&gt;0 , LastValue(Day()));\r\ntestTimeUpcomthang =ValueWhen(LastValue(V)&gt;0 , LastValue(Month()));\r\ntestTimeUpcomnam =ValueWhen(LastValue(V)&gt;0 , LastValue(Year()));\r\nTongthoigianGiaodichUpcom = (testTimeUpcomnam*100 + testTimeUpcomthang)*100 + testTimeUpcomngay;\r\nstartTimeUpcom1 = 9*60; \r\nendTimeUpcom1 = 11*60 +30;\r\nstartTimeUpcom2 = 13*60; \r\nendTimeUpcom2 = 15*60;\r\nPhienSangUpcom = (endTimeUpcom1 - startTimeUpcom1);\r\nPhienChieuUpcom = (endTimeUpcom2 - startTimeUpcom2);\r\nFulltimeUpcom = (endTimeUpcom1 - startTimeUpcom1) + (endTimeUpcom2 - startTimeUpcom2);\r\nInTimeUpcom  = IIf(DieukienThoiGian==2 AND LastValue(V)&gt;0 AND  Realtime&gt;= startTimeUpcom1 AND Realtime &lt;= endTimeUpcom1,Realtime -startTimeUpcom1,\r\n\t\t\t\tIIf(DieukienThoiGian==2 AND LastValue(V)&gt;0 AND Realtime &gt; endTimeUpcom1 AND Realtime &lt; startTimeUpcom2,PhienSangUpcom,\r\n\t\t\t\tIIf(DieukienThoiGian==2 AND LastValue(V)&gt;0 AND Realtime &gt;= startTimeUpcom2 AND Realtime&lt;= endTimeUpcom2,PhienSangUpcom + (Realtime - startTimeUpcom2),FulltimeUpcom)));\t\r\nDanhgiaADXUPINDEX = IIf(ADX(14) &gt; Ref(ADX(14),-1),1,IIf(ADX(14) &lt; Ref(ADX(14),-1),-1,0));\r\nDanhgiaHSUPINDEX = IIf((PDI(14) - MDI(14)) &gt; Ref((PDI(14) - MDI(14)),-1),1 ,IIf((PDI(14) - MDI(14)) &lt; Ref((PDI(14) - MDI(14)),-1),-1,0));\r\nDanhgiaEMAHSUPINDEX = IIf(EMA((PDI(14) - MDI(14)),5) &gt; Ref(EMA((PDI(14) - MDI(14)),5),-1),1,IIf(EMA((PDI(14) - MDI(14)),5) &lt; Ref(EMA((PDI(14) - MDI(14)),5),-1),-1,0));\r\nDanhgiaTopUPINDEX = \tIIf(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))) &gt; Ref(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),-1),1,\r\n\t\t\t\tIIf(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))) &lt; Ref(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),-1),-1,0));\r\nDanhgiaEMATopUPINDEX = IIf(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5) &gt; Ref(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5),-1),1,\r\n\t\t\t\tIIf(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5) &lt; Ref(EMA(Max(RSIa((PDI(14) - MDI(14)),14),Max(RSIa(OBV(),14),RSIa(C,14))),5),-1),-1,0));\r\nDanhgiaMACDUPINDEX = IIf(MACD(12, 26) &gt; Ref(MACD(12, 26),-1),1,IIf(MACD(12, 26) &lt; Ref(MACD(12, 26),-1),-1,0));\r\nDanhgiaSignalUPINDEX = IIf( Signal(12,26,9) &gt; Ref(Signal(12,26,9),-1),1, IIf(Signal(12,26,9) &lt; Ref(Signal(12,26,9),-1),-1,0));\r\nDanhgiaHitoUPINDEX = IIf((MACD(12, 26) - Signal(12,26,9)) &gt; Ref((MACD(12, 26) - Signal(12,26,9)),-1),1, IIf((MACD(12, 26) - Signal(12,26,9)) &lt; Ref((MACD(12, 26) - Signal(12,26,9)),-1),-1,0));\r\nDanhgiaCCIUPINDEX = IIf(CCI( 14 ) &gt; Ref(CCI( 14 ),-1),1,IIf(CCI( 14 ) &lt; Ref(CCI( 14 ),-1),-1,0));\r\nDanhgiaEMACCIUPINDEX = IIf(EMA(CCI( 14 ),5) &gt; Ref(EMA(CCI( 14 ),5),-1),1,IIf(EMA(CCI( 14 ),5) &lt; Ref(EMA(CCI( 14 ),5),-1),-1,0));\r\nDanhgiaTHUPINDEX = DanhgiaADXUPINDEX + DanhgiaHSUPINDEX + DanhgiaEMAHSUPINDEX + DanhgiaTopUPINDEX + DanhgiaEMATopUPINDEX + DanhgiaMACDUPINDEX + DanhgiaSignalUPINDEX + DanhgiaHitoUPINDEX + DanhgiaCCIUPINDEX + DanhgiaEMACCIUPINDEX;//Gia tri diem\r\nMauDanhgiaUPINDEX = IIf(DanhgiaTHUPINDEX &gt; Ref(DanhgiaTHUPINDEX,-1), colorGreen, IIf(DanhgiaTHUPINDEX &lt; Ref(DanhgiaTHUPINDEX,-1),colorRed, colorDefault));\r\nHSDanhgiaUPINDEX = DanhgiaTHUPINDEX - Ref(DanhgiaTHUPINDEX,-1);// Tang giam diem\r\nRestorePriceArrays();//tra lai lam viec chung cho toan thi truong \r\n////////////Lay time cua ma tren san GD hien tai \r\nLaySGD = MarketID( 1 );\r\nSanHNX = "HNXINDEX";\r\nSanUpcom = "UPINDEX";\r\nSanHSX = "VNINDEX";\r\ntestSan1 = WriteIf(LaySGD == "HSX","VNINDEX","");\r\ntestSan2 = WriteIf(LaySGD == "HNX","HNXINDEX","");\r\ntestSan3 = WriteIf(LaySGD == "UPCOM","UPINDEX","");\r\ntestSan = testSan1 + testSan2 + testSan3;\r\nInTime =  IIf(LaySGD == "HSX",InTimeVni, IIf(LaySGD == "HNX",InTimeHNX,InTimeUpcom));\r\nOutTime = IIf(LaySGD == "HSX",FulltimeVni, IIf(LaySGD == "HNX",FulltimeHNX,FulltimeUpcom));\r\nMorningTime = IIf(LaySGD == "HSX",PhienSangVni, IIf(LaySGD == "HNX",PhienSangHNX,PhienSangUpcom));\r\nTongthoigianGiaodich3San =  IIf(LaySGD == "HSX",TongthoigianGiaodichVni, IIf(LaySGD == "HNX",TongthoigianGiaodichHNX,TongthoigianGiaodichUpcom));\r\nLaydiemSan = IIf(LaySGD == "HSX",DanhgiaTHVNINDEX, IIf(LaySGD == "HNX",DanhgiaTHHNXINDEX,DanhgiaTHUPINDEX));\r\nLaymaudiemSan = IIf(LaySGD == "HSX",MauDanhgiaVNINDEX, IIf(LaySGD == "HNX",MauDanhgiaHNXINDEX,MauDanhgiaUPINDEX));\r\nLaydiemtangiamSan = IIf(LaySGD == "HSX",HSDanhgiaVNINDEX, IIf(LaySGD == "HNX",HSDanhgiaHNXINDEX,HSDanhgiaUPINDEX));\r\n////////////////////////////////////////////////////////////////////////\r\n///////////////////////////DanhGiaVol\r\n_SECTION_BEGIN("Danh Gia Vol");\r\nVolcuaPhut = IIf(InTime &lt; OutTime ,Volume/InTime,Volume/OutTime);\r\n_SECTION_END();\r\nHesoRank = 14;\r\nSetOption( "Nodefaultcolumns", True ); \r\nAddTextColumn( Name(), "Ma CK",1.2,IIf(Close&gt;Ref(Close,-1), colorGreen, IIf(Close&lt;Ref(Close,-1), colorRed, colorDefault))); // Ten\r\nAddTextColumn( FullName(), "Ten Cty"); //Ful ten\r\nAddTextColumn( MarketID( 1 ), "San GD");\r\nAddTextColumn( IndustryID( 1 ), "Nganh nghe" );// Nganh nghe\r\nchuyenngay1 = NumToStr( Datetime(), formatDateTime );// chuyen ngay qua chuoi\r\ncutngay1 = StrTrim( chuyenngay1, " 00:00:00" ); // cut gio phut giay\r\nAddTextColumn(cutngay1 , "Date",  colorDefault, colorDefault);\r\nRankingCl = RSIa(C,HesoRank) ;\r\nWarnaText = colorBlack ;\r\nWarnaBackGround = ColorHSB(RankingCl, 255, 255);\r\nRankingTD = PercentRank (( ( C - Ref ( C ,-1 )) / Ref ( C ,-1 ) ) * 100, HesoRank) ;\r\nAddColumn (Close, "Gia", 1.2, IIf(Close&gt;Ref(Close,-1), colorGreen, IIf(Close&lt;Ref(Close,-1), colorRed, colorDefault)), WarnaBackGround, -1, RankingCL) ;\r\n//AddColumn(Close,"Gia",1.2,IIf(Close&gt;Ref(Close,-1), colorGreen, IIf(Close&lt;Ref(Close,-1), colorRed, colorDefault)));\r\nAddColumn( ( ( C - Ref ( C ,-1 )) / Ref ( C ,-1 ) ) * 100 , " % Change " , 1.2 ,IIf(Close&gt;Ref(Close,-1), colorGreen, IIf(Close&lt;Ref(Close,-1), colorRed, colorDefault)));\r\nRankingVol = RSIa( VolcuaPhut,HesoRank);\r\nWarnaBackGroundVol = ColorHSB(RankingVol , 255, 255);\r\nVolCo = IIf(VolcuaPhut &gt; Ref(VolcuaPhut,-1), colorGreen, IIf(VolcuaPhut &lt; Ref(VolcuaPhut,-1),colorRed,colorDefault));\r\nAddColumn (Volume, "Volume", 1, VolCo, WarnaBackGroundVol, -1, RankingVol) ;\r\nRankingGTGD = RSIa(VolcuaPhut*Avg, HesoRank) ;\r\nWarnaBackGroundGTGD = ColorHSB(RankingGTGD, 255, 255);\r\nGTGDCo = IIf(VolcuaPhut*Avg &gt; Ref(VolcuaPhut*Avg,-1), colorGreen, IIf(VolcuaPhut*Avg &lt; Ref(VolcuaPhut*Avg,-1),colorRed,colorDefault));\r\nAddColumn (Volume*Avg, "GTGD", 1, GTGDCo, WarnaBackGroundGTGD, -1, RankingGTGD) ;\r\nRSICo = IIf(RankingCl &gt; Ref(RankingCl,-1), colorGreen, IIf(RankingCl &lt; Ref(RankingCl,-1),colorRed,colorDefault));\r\nAddColumn (RankingCl, "RSI14", 1.2, RSICo, WarnaBackGround, -1,RankingCl) ;\r\nRSIVolCo = IIf(RankingVol &gt; Ref(RankingVol,-1), colorGreen, IIf(RankingVol &lt; Ref(RankingVol,-1),colorRed,colorDefault));\r\nAddColumn (RankingVol, "RSIVol", 1.2, RSIVolCo, WarnaBackGroundVol, -1,RankingVol) ;\r\nRSIGTGDCo = IIf(RankingGTGD &gt; Ref(RankingGTGD,-1), colorGreen, IIf(RankingGTGD &lt; Ref(RankingGTGD,-1),colorRed,colorDefault));\r\nAddColumn (RankingGTGD, "RSIGTGD", 1.2, RSIGTGDCo, WarnaBackGroundGTGD, -1,RankingGTGD) ;\r\nTonghop =  (RankingCl + RankingVol + RankingGTGD )/3;\r\nWarnaBackGroundTH = ColorHSB(Tonghop , 255, 255);\r\nTangGiam = Tonghop - Ref(Tonghop,-1);\r\nRankingtangiam = PercentRank (TangGiam, HesoRank) ;\r\nWarnaBackGroundTG = ColorHSB(Rankingtangiam * 64/100, 255, 255);\r\nTangGiamRSI = RankingCl - Ref(RankingCl,-1);\r\n//AddColumn(TangGiamRSI,"RSI+/-",1.2,IIf(TangGiamRSI &gt; 0, colorGreen, IIf(TangGiamRSI &lt; 0, colorRed, colorDefault)));\r\nTangGiamVol = RankingVol - Ref(RankingVol,-1);\r\n//AddColumn(TangGiamVol,"Vol+/-",1.2,IIf(TangGiamVol &gt; 0, colorGreen, IIf(TangGiamVol &lt; 0, colorRed, colorDefault)));\r\ntanggiamGTGD = \tRankingGTGD - Ref(\tRankingGTGD,-1);\t\r\n//AddColumn(tanggiamGTGD,"GTGD+/-",1.2,IIf(tanggiamGTGD &gt; 0, colorGreen, IIf(tanggiamGTGD &lt; 0, colorRed, colorDefault)));\r\ndiemTH = \t (TangGiamRSI +  TangGiamVol + tanggiamGTGD)/3;\r\n//AddColumn(diemTH,"TH Tang giam",1.2,IIf(diemTH &gt; 0, colorGreen, IIf(diemTH &lt; 0, colorRed, colorDefault)));\r\nSetSortColumns(-8);\r\n//AddColumn(LaydiemSan,"Chi so",1,LaymaudiemSan);\r\n//AddColumn(LaydiemtangiamSan,"+/-Chi so",1,IIf(LaydiemtangiamSan &gt; 0 ,colorGreen,IIf(LaydiemtangiamSan &lt; 0,colorRed, colorDefault)));\r\nNoidiemSan = "" + LaydiemSan+" | " + LaydiemtangiamSan;\r\nAddTextColumn(NoidiemSan , "Chi so San", 1.2,colorDefault , colorDefault);\r\n\r\n//AddRankColumn(); \r\ndieukienbb = IIf(Ref(MA(V,20),-1)&gt;=200000  ,2,-2);// Dieu kien de loai bien cac ma xau, thanh khoan kem, ma mat thanh khoan, thanh khoan khong on dinh\r\ntestTime2023ngay =ValueWhen(V&gt;0 , LastValue(Day()));\r\ntestTime2023thang =ValueWhen(V&gt;0 , LastValue(Month()));\r\ntestTime2023nam =ValueWhen(V&gt;0 , LastValue(Year()));\r\nTongthoigianHienTai = (Namhientai*100+Thanghientai)*100+Ngayhientai;\r\nTongthoigianGiaodich = (testTime2023nam*100 + testTime2023thang)*100 + testTime2023ngay;\r\nDoiCHieuVni = TongthoigianHienTai - TongthoigianGiaodich3San;\r\nDoichieuTructiep = TongthoigianHienTai - TongthoigianGiaodich;\r\nDieukienthoigianvanhanh = IIf( DoiCHieuVni == DoichieuTructiep AND DoichieuTructiep&lt;= 75,2,-2);\r\n\r\n_SECTION_BEGIN("ADX");\r\nrange = Param("Periods", 14, 2, 200, 1 );\r\n//Plot( ADX(range), _DEFAULT_NAME(), ParamColor( "ADX color", colorBlue ), ParamStyle("ADX style", styleThick ) );\r\n//Plot( PDI(range), "+DI", ParamColor( "+DI color", colorGreen ), ParamStyle("+DI style") );\r\n//Plot( MDI(range), "-DI", ParamColor( "-DI color", colorRed ), ParamStyle("-DI style") );\r\nTB = (PDI(range) + MDI(range))/2;\r\n//Plot( EMA(TB,14), "TB", colorAqua, ParamStyle("-DI style") );\r\nHS = (PDI(range) - MDI(range));\r\n//Plot( EMA(HS,5), "TB", colorCustom10, ParamStyle("-DI style") );\r\n//Plot( HS , "HS", colorCustom6, ParamStyle("-DI style") );\r\n//Plot( EMA(MDI(range),7), "TB", colorRed, ParamStyle("-DI style") );\r\nDanhgiaADX = IIf(ADX(range) &gt; Ref(ADX(range),-1),1,IIf(ADX(range) &lt; Ref(ADX(range),-1),-1,0));\r\nDanhgiaHS = IIf(HS &gt; Ref(HS,-1),1 ,IIf(HS &lt; Ref(HS,-1),-1,0));\r\nDanhgiaEMAHS = IIf(EMA(HS,5) &gt; Ref(EMA(HS,5),-1),1,IIf(EMA(HS,5) &lt; Ref(EMA(HS,5),-1),-1,0));\r\n_SECTION_END();\r\n_SECTION_BEGIN("Max RSI");\r\nTop = Max(RSIa(HS,14),Max(RSIa(OBV(),14),RSIa(C,14)));\r\nDanhgiaTop = IIf(Top &gt; Ref(Top,-1),1,IIf(Top &lt; Ref(Top,-1),-1,0));\r\nDanhgiaEMATop = IIf(EMA(Top,5) &gt; Ref(EMA(Top,5),-1),1,IIf(EMA(Top,5) &lt; Ref(EMA(Top,5),-1),-1,0));\r\n_SECTION_END();\r\n_SECTION_BEGIN("MACD");\r\nr1 = Param( "Fast avg", 12, 2, 200, 1 );\r\nr2 = Param( "Slow avg", 26, 2, 200, 1 );\r\nr3 = Param( "Signal avg", 9, 2, 200, 1 );\r\nml = MACD(r1, r2);\r\nsl = Signal(r1,r2,r3);\r\nHistogram = MACD(r1, r2) - Signal(r1,r2,r3);\r\nDanhgiaMACD = IIf(ml &gt; Ref(ml,-1),1,IIf(ml &lt; Ref(ml,-1),-1,0));\r\nDanhgiaSignal = IIf( sl &gt; Ref(sl,-1),1, IIf(sl &lt; Ref(sl,-1),-1,0));\r\nDanhgiaHito = IIf(Histogram &gt; Ref(Histogram,-1),1, IIf(Histogram &lt; Ref(Histogram,-1),-1,0));\r\n//Plot( ml = MACD(r1, r2), StrFormat(_SECTION_NAME()+"(%g,%g)", r1, r2), ParamColor("MACD color", colorRed ), ParamStyle("MACD style") );\r\n//Plot( sl = Signal(r1,r2,r3), "Signal" + _PARAM_VALUES(), ParamColor("Signal color", colorBlue ), ParamStyle("Signal style") );\r\n//Plot( ml-sl, "MACD Histogram", ParamColor("Histogram color", colorDefault ), styleNoTitle | ParamStyle("Histogram style", styleHistogram | styleNoLabel, maskHistogram ) );\r\n_SECTION_END();\r\n_SECTION_BEGIN("CCI");\r\nperiods = Param( "Periods", 14, 2, 200, 1 );\r\n//Plot( CCI( periods ), _DEFAULT_NAME(), ParamColor( "Color",  colorCycle ), ParamStyle("Style")  );\r\nDanhgiaCCI = IIf(CCI( periods ) &gt; Ref(CCI( periods ),-1),1,IIf(CCI( periods ) &lt; Ref(CCI( periods ),-1),-1,0));\r\nDanhgiaEMACCI = IIf(EMA(CCI( periods ),5) &gt; Ref(EMA(CCI( periods ),5),-1),1,IIf(EMA(CCI( periods ),5) &lt; Ref(EMA(CCI( periods ),5),-1),-1,0));\r\n_SECTION_END();\t\t\t\r\nDanhgiaTH = DanhgiaADX + DanhgiaHS + DanhgiaEMAHS + DanhgiaTop + DanhgiaEMATop + DanhgiaMACD + DanhgiaSignal + DanhgiaHito + DanhgiaCCI + DanhgiaEMACCI;\r\nDanhgiaTHPT = (DanhgiaTH + LaydiemSan)/2;\r\nMauDanhgia = IIf(DanhgiaTHPT &gt; Ref(DanhgiaTHPT,-1), colorGreen, IIf(DanhgiaTHPT &lt; Ref(DanhgiaTHPT,-1),colorRed, colorDefault));\r\nAddColumn(DanhgiaTHPT,"Diem",1,MauDanhgia);\r\nHSDanhgia = DanhgiaTHPT - Ref(DanhgiaTHPT,-1);\r\nAddColumn(HSDanhgia,"+/-Diem",1,IIf(HSDanhgia &gt; 0 ,colorGreen,IIf(HSDanhgia &lt; 0,colorRed, colorDefault)));\r\n\r\nT=2;\r\n////Lop nen\r\nBuy0 = DanhgiaTHPT &gt; 0 AND Ref(DanhgiaTHPT,-1) &lt;=0;\r\nSell0 = DanhgiaTHPT &lt;= 0 AND Ref(DanhgiaTHPT,-1) &gt;0;\r\ndemTUp0 = BarsSince(Buy0);\r\ndemTDow0 = BarsSince(Sell0);\r\n///Lop 1\r\nTrend0 = IIf(demTUp0 &lt; demTDow0 OR (demTDow0 &gt;=0 AND demTDow0 &lt;=0),demTUp0,demTDow0*-1); \r\ndemTmua = IIf(demTUp0 ==0 AND Ref(demTUp0,-1*T)==0,T-demTUp0,demTUp0);\r\nBuy = demTmua==0;\r\ndemTUp1 = BarsSince(Buy);\r\nSell1 = Sell0 AND demTmua&gt;=T ;\r\nSell2 = demTmua==T  AND   demTDow0 &lt; demTUp0;\r\nSellTotal = Sell1 OR Sell2;\r\ntestTimengay =ValueWhen(SellTotal , Day());\r\ntestTimethang =ValueWhen(SellTotal , Month());\r\ntestTimenam =ValueWhen(SellTotal , Year());\r\nALotime = IIf(testTimengay &lt; testTime2023ngay OR testTimethang &lt; testTime2023thang OR testTimenam &lt; testTime2023nam ,2,\r\n\t\t\tIIf( testTimengay == testTime2023ngay AND testTimethang == testTime2023thang AND testTimenam == testTime2023nam AND InTimeVni &gt;= PhienSangVni,2,-2)); // test thoi gian T0.5 (luat chung khoan 0.5 nay rat kem)\r\n//Sell = Sell1 OR Sell2;\r\nSell = SellTotal AND ALotime&gt;=2 ;\r\ndemTDow1 = BarsSince(Sell);\r\nBuyPrice = ValueWhen(Buy , Prec(Avg,2));\r\nSellPrice=ValueWhen(Sell,Prec(Avg,2));\r\nTrend1 = IIf(demTUp1 &lt; demTDow1 OR (demTDow1 &gt;=0 AND demTDow1 &lt;=0),demTUp1,demTDow1*-1); \r\ntanggiam11= Prec( ( ( C - BuyPrice) / BuyPrice ) * 100,2);//lam tron so \r\ntanggiam99= Prec( ( ( SellPrice - BuyPrice) / BuyPrice ) * 100,2);//lam tron so \r\ntanggiam9999 =IIf(demTDow1==0,tanggiam99,tanggiam11);\r\nhienthiban = WriteIf(Sell AND SellPrice&gt;=BuyPrice,"Sell","CutLoss");\r\nSellA = Sell AND SellPrice&gt;=BuyPrice;\r\nSellB = Sell AND SellPrice&lt;BuyPrice;\r\ntextBuy = WriteIf(Buy,"Buy&lt;= "+BuyPrice,"");\r\ntextSell = WriteIf(Sell AND SellPrice&gt;=BuyPrice,"Sell&gt;= "+SellPrice,"");\r\ntextSell1 = WriteIf(Sell AND SellPrice &lt; BuyPrice,"CutLoss&gt;= "+SellPrice,"");\r\ntextBuySell = textBuy + textSell +textSell1 ;\r\ntextBuySellCo = IIf(Buy,colorGreen,IIf(Sell, colorRed , colorDefault));\r\nAddTextColumn(textBuySell , "Tin Hieu", 1.2,textBuySellCo , colorDefault);\r\nBuyDate = ValueWhen(Buy , DateTime(), 1);\r\nchuyenngay = NumToStr( BuyDate, formatDateTime );\r\ncutngay = StrTrim( chuyenngay, " 00:00:00" );\r\ncutngay2 = WriteIf(Trend1&gt;=0,cutngay,"");\r\nBuyDay = ValueWhen(Buy , Day(), 1);\r\nBuymount = ValueWhen(Buy , Month(), 1);\r\nBuyyear = ValueWhen(Buy , Year(), 1);\r\nngaymuachuan = ""+BuyDay+"/"+Buymount+"/"+Buyyear;\r\nSellDay = ValueWhen(Sell , Day(), 1);\r\nSellmount = ValueWhen(Sell , Month(), 1);\r\nSellyear = ValueWhen(Sell , Year(), 1);\r\nngaybanchuan = ""+SellDay+"/"+Sellmount+"/"+Sellyear;\r\nAddTextColumn(cutngay2 , "Ngay mua", 1.2, colorDefault , colorDefault);\r\nAddColumn(Trend1,"T+/-",1,IIf(Trend1&gt;=0,colorGreen,colorRed) );\r\ntextgiamua = WriteIf(Trend1&gt;=0,""+BuyPrice,"");\r\nAddTextColumn(textgiamua , "Gia Mua", 1.2, colorDefault , colorDefault);\r\nlaytexthienthi =WriteIf(LastValue(Trend1)&gt;=0,"T"+LastValue(Trend1)+" // " +LastValue(tanggiam9999)+"%","");\r\nloinhuan = WriteIf(Trend1 &gt;=0, ""+tanggiam9999+"%","");\r\n//AddTextColumn(loinhuan, "Loi nhuan %", 1.2, IIf( tanggiam9999&gt;0 ,colorGreen,IIf( tanggiam9999&lt;0, colorRed,colorDefault)));\r\nAddColumn(tanggiam9999,"Loi nhuan %",1.2,IIf( tanggiam9999&gt;0 ,colorGreen,IIf( tanggiam9999&lt;0, colorRed,colorDefault)));\r\nFilter = MA(C,20) &gt;=5  AND dieukienbb&gt;=2  AND Dieukienthoigianvanhanh&gt;=2 AND Trend1 &gt;=0;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</FormulaContent>
<ApplyTo>2</ApplyTo>
<RangeType>2</RangeType>
<RangeAmount>1</RangeAmount>
<FromDate>2023-12-28 00:00:00</FromDate>
<ToDate>2023-12-26</ToDate>
<SyncOnSelect>0</SyncOnSelect>
<RunEvery>0</RunEvery>
<RunEveryInterval>5min</RunEveryInterval>
<IncludeFilter>
<ExcludeMode>0</ExcludeMode>
<OrSelection>0</OrSelection>
<Favourite>0</Favourite>
<Index>0</Index>
<Type0>0</Type0>
<Category0>-1</Category0>
<Type1>1</Type1>
<Category1>-1</Category1>
<Type2>2</Type2>
<Category2>-1</Category2>
<Type3>3</Type3>
<Category3>-1</Category3>
<Type4>4</Type4>
<Category4>0</Category4>
<Type5>5</Type5>
<Category5>-1</Category5>
<Type6>6</Type6>
<Category6>-1</Category6>
</IncludeFilter>
<ExcludeFilter>
<ExcludeMode>1</ExcludeMode>
<OrSelection>0</OrSelection>
<Favourite>0</Favourite>
<Index>0</Index>
<Type0>0</Type0>
<Category0>-1</Category0>
<Type1>1</Type1>
<Category1>-1</Category1>
<Type2>2</Type2>
<Category2>-1</Category2>
<Type3>3</Type3>
<Category3>-1</Category3>
<Type4>4</Type4>
<Category4>-1</Category4>
<Type5>5</Type5>
<Category5>-1</Category5>
<Type6>6</Type6>
<Category6>-1</Category6>
</ExcludeFilter>
</General>
<BacktestSettings>
<InitialEquity>10000</InitialEquity>
<TradeFlags>1</TradeFlags>
<MaxLossStopMode>0</MaxLossStopMode>
<MaxLossStopValue>0</MaxLossStopValue>
<MaxLossStopAtStop>0</MaxLossStopAtStop>
<ProfitStopMode>0</ProfitStopMode>
<ProfitStopValue>0</ProfitStopValue>
<ProfitStopAtStop>0</ProfitStopAtStop>
<TrailingStopMode>0</TrailingStopMode>
<TrailingStopPeriods>0</TrailingStopPeriods>
<TrailingStopValue>0</TrailingStopValue>
<TrailingStopAtStop>0</TrailingStopAtStop>
<CommissionMode>0</CommissionMode>
<CommissionValue>0</CommissionValue>
<BuyPriceField>0</BuyPriceField>
<BuyDelay>0</BuyDelay>
<SellPriceField>0</SellPriceField>
<SellDelay>0</SellDelay>
<ShortPriceField>0</ShortPriceField>
<ShortDelay>0</ShortDelay>
<CoverPriceField>0</CoverPriceField>
<CoverDelay>0</CoverDelay>
<ReportSystemFormula>0</ReportSystemFormula>
<ReportSystemSettings>0</ReportSystemSettings>
<ReportOverallSummary>1</ReportOverallSummary>
<ReportSummary>1</ReportSummary>
<ReportTradeList>1</ReportTradeList>
<LoadRemainingQuotes>1</LoadRemainingQuotes>
<Periodicity>0</Periodicity>
<InterestRate>0</InterestRate>
<ReportOutPositions>1</ReportOutPositions>
<UseConstantPriceArrays>0</UseConstantPriceArrays>
<PointsOnlyTest>0</PointsOnlyTest>
<AllowShrinkingPosition>0</AllowShrinkingPosition>
<RangeType>2</RangeType>
<RangeLength>0</RangeLength>
<RangeFromDate>2023-12-28 00:00:00</RangeFromDate>
<RangeToDate>2023-12-26</RangeToDate>
<ApplyTo>2</ApplyTo>
<FilterQty>2</FilterQty>
<IncludeFilter>
<ExcludeMode>0</ExcludeMode>
<OrSelection>0</OrSelection>
<Favourite>0</Favourite>
<Index>0</Index>
<Type0>0</Type0>
<Category0>-1</Category0>
<Type1>1</Type1>
<Category1>-1</Category1>
<Type2>2</Type2>
<Category2>-1</Category2>
<Type3>3</Type3>
<Category3>-1</Category3>
<Type4>4</Type4>
<Category4>0</Category4>
<Type5>5</Type5>
<Category5>-1</Category5>
<Type6>6</Type6>
<Category6>-1</Category6>
</IncludeFilter>
<ExcludeFilter>
<ExcludeMode>1</ExcludeMode>
<OrSelection>0</OrSelection>
<Favourite>0</Favourite>
<Index>0</Index>
<Type0>0</Type0>
<Category0>-1</Category0>
<Type1>1</Type1>
<Category1>-1</Category1>
<Type2>2</Type2>
<Category2>-1</Category2>
<Type3>3</Type3>
<Category3>-1</Category3>
<Type4>4</Type4>
<Category4>-1</Category4>
<Type5>5</Type5>
<Category5>-1</Category5>
<Type6>6</Type6>
<Category6>-1</Category6>
</ExcludeFilter>
<UseOptimizedEvaluation>0</UseOptimizedEvaluation>
<BacktestRangeType>2</BacktestRangeType>
<BacktestRangeLength>0</BacktestRangeLength>
<BacktestRangeFromDate>2023-01-26 00:00:00</BacktestRangeFromDate>
<BacktestRangeToDate>2023-12-26</BacktestRangeToDate>
<MarginRequirement>100</MarginRequirement>
<SameDayStops>0</SameDayStops>
<RoundLotSize>0</RoundLotSize>
<TickSize>0</TickSize>
<DrawdownPriceField>0</DrawdownPriceField>
<ReverseSignalForcesExit>1</ReverseSignalForcesExit>
<NoDefaultColumns>0</NoDefaultColumns>
<AllowSameBarExit>1</AllowSameBarExit>
<ExtensiveOptimizationWarning>1</ExtensiveOptimizationWarning>
<WaitForBackfill>0</WaitForBackfill>
<MaxRanked>4</MaxRanked>
<MaxTraded>4</MaxTraded>
<MaxTracked>100</MaxTracked>
<PortfolioReportMode>0</PortfolioReportMode>
<MinShares>0.1</MinShares>
<SharpeRiskFreeReturn>5</SharpeRiskFreeReturn>
<PortfolioMode>0</PortfolioMode>
<PriceBoundCheck>1</PriceBoundCheck>
<AlignToReferenceSymbol>0</AlignToReferenceSymbol>
<ReferenceSymbol>^DJI</ReferenceSymbol>
<UPIRiskFreeReturn>5.4</UPIRiskFreeReturn>
<NBarStopMode>0</NBarStopMode>
<NBarStopValue>0</NBarStopValue>
<NBarStopReentryDelay>0</NBarStopReentryDelay>
<MaxLossStopReentryDelay>0</MaxLossStopReentryDelay>
<ProfitStopReentryDelay>0</ProfitStopReentryDelay>
<TrailingStopReentryDelay>0</TrailingStopReentryDelay>
<AddFutureBars>0</AddFutureBars>
<DistChartSpacing>5</DistChartSpacing>
<ProfitDistribution>1</ProfitDistribution>
<MAFEDistribution>1</MAFEDistribution>
<IndividualDetailedReports>0</IndividualDetailedReports>
<PortfolioReportTradeList>1</PortfolioReportTradeList>
<LimitTradeSizeAsPctVol>10</LimitTradeSizeAsPctVol>
<DisableSizeLimitWhenVolumeIsZero>1</DisableSizeLimitWhenVolumeIsZero>
<UsePrevBarEquityForPosSizing>0</UsePrevBarEquityForPosSizing>
<NBarStopHasPriority>0</NBarStopHasPriority>
<UseCustomBacktestProc>0</UseCustomBacktestProc>
<CustomBacktestProcFormulaPath/>
<MinPosValue>0</MinPosValue>
<MaxPosValue>0</MaxPosValue>
<ChartInterval>86400</ChartInterval>
<DisableRuinStop>0</DisableRuinStop>
<OptTarget>CAR/MDD</OptTarget>
<WFMode>0</WFMode>
<GenerateReport>1</GenerateReport>
<MaxLongPos>0</MaxLongPos>
<MaxShortPos>0</MaxShortPos>
<SeparateLongShortRank>0</SeparateLongShortRank>
<TotalSymbolQty>194</TotalSymbolQty>
<EnableUserReportCharts>1</EnableUserReportCharts>
<ChartWidth>800</ChartWidth>
<ChartHeight>480</ChartHeight>
<SettlementDelay>0</SettlementDelay>
<PortfolioReportSystemFormula>1</PortfolioReportSystemFormula>
<InterestRateSymbol/>
<MarginRate>0</MarginRate>
<IncludeBHStats>1</IncludeBHStats>
<BHSymbol>^DJI</BHSymbol>
<MCEnable>1</MCEnable>
<MCRuns>1000</MCRuns>
<MCPosSizeMethod>0</MCPosSizeMethod>
<MCPosSizeShares>100</MCPosSizeShares>
<MCPosSizeValue>1000</MCPosSizeValue>
<MCPosSizePctEquity>5</MCPosSizePctEquity>
<MCChartEquityCurves>1</MCChartEquityCurves>
<MCStrawBroomLines>0</MCStrawBroomLines>
<Scenario>0</Scenario>
<MCChartEquityScale>0</MCChartEquityScale>
<MCUseEquityChanges>0</MCUseEquityChanges>
<MCLogScaleFinalEquity>0</MCLogScaleFinalEquity>
<MCLogScaleDrawdown>0</MCLogScaleDrawdown>
<MCNegativeDrawdown>1</MCNegativeDrawdown>
<ISEnabled>1</ISEnabled>
<ISStartDate>2000-01-01</ISStartDate>
<ISEndDate>2004-01-01</ISEndDate>
<ISLastDate>2018-01-01</ISLastDate>
<ISStep>1</ISStep>
<ISStepUnit>3</ISStepUnit>
<ISAnchored>0</ISAnchored>
<ISLastUsesToday>1</ISLastUsesToday>
<OSEnabled>1</OSEnabled>
<OSStartDate>2004-01-01</OSStartDate>
<OSEndDate>2005-01-01</OSEndDate>
<OSLastDate>2019-01-01</OSLastDate>
<OSStep>1</OSStep>
<OSStepUnit>3</OSStepUnit>
<OSAnchored>0</OSAnchored>
<OSLastUsesToday>1</OSLastUsesToday>
</BacktestSettings>
</AmiBroker-Analysis>
