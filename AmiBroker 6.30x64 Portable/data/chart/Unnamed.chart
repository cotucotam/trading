<?xml version="1.0" encoding="UTF-8"?>
<Window>
	<Sheet>
		<Name>RSI-STOCH</Name>
		<Pane>
			<ChartID>1081</ChartID>
			<PercentHeight>100</PercentHeight>
			<Formula>//------------------------------------------------------------------------------\r\n\r\n//  Formula Name  : RSI HEATMAP\r\n\r\n//  Edit by       : HuyTuan \r\n\r\n//  Phone         : 0937798534\r\n\r\n//  Last Update   : 27 Sep 2023\r\n\r\n//  Version       : 1.0\r\n\r\n// Amibroker Group: https://t.me/amibrokercodevn\r\n\r\n// About me\t\t  : https://t.me/huytuanvt\r\n\r\n// Moi ung ho xin gui vao stk: 0081001154112 - Le Xuan Tuan - Ngan Hang VCB Vung Tau\r\n\r\n//-----------------------------------------------------------------------------\r\n\r\npxwidth = Status( "pxwidth" );\r\npxheight = Status( "pxheight" );\r\npxl = Status( "pxchartleft" );\r\npxr = Status( "pxchartright" );\r\npxt = Status( "pxcharttop" );\r\npxb = Status( "pxchartbottom" );\r\nfixx=1/1880*pxwidth;\r\nfixy=1/870*pxheight;\r\nprocedure SetOrigin(x0, y0) {\r\n\tglobal _x0, _y0;\r\n\t_x0 = x0; _y0 = y0;\r\n}\r\n_cursorMouseButtons = GetCursorMouseButtons();\r\nDT_CENTER = 1; DT_VCENTER = 4 | 32; \r\nfunction GfxGetState(id) {\r\n\treturn Nz(StaticVarGet("GfxState"+id+GetChartID()), 0);\r\n}\r\nfunction PointInside(x0, y0, x, y, width, height) {\r\n    global _x0, _y0;\r\n\tx = x+_x0; y = y+_y0;\r\n    x0 = x0+_x0; y0 = y0+_y0;\r\n\treturn ((x0 &gt;= x) &amp;&amp; (y0 &gt;= y) &amp;&amp; (x0 &lt;= (x+width)) &amp;&amp; (y0 &lt;= (y+height)));\r\n}\r\nfunction LeftClickInside(x, y, width, height) {\r\n\tglobal _cursorMouseButtons, _x0, _y0;\r\n\tlocal px, py, res;\r\n\t\t//x = x+_x0; y = y+_y0;\r\n\tres = False;\r\n\tif (_cursorMouseButtons &amp; 8) { // click\r\n\t\tpx = GetCursorXPosition(1); \r\n\t\tpy = GetCursorYPosition(1); \r\n\t\tres = PointInside(px, py, x, y, width, height);\r\n\t}\r\n\treturn res;\r\n}\r\nprocedure GfxSetState(id, val) {\r\n\tStaticVarSet("GfxState"+id+GetChartID(), val);\r\n}\r\n///MENU DOC\r\nfunction GfxHTabs1(id, headers, headheight, x, y, width, height, colorfg, colorbg) {\r\n\tglobal _x0, _y0;\r\n\tlocal py,choice,na,i,n,header,w, wi, prevwi;\r\n\t\r\n\tx = x+_x0; y = y+_y0; choice = GfxGetState(id);\r\n\tfor(n = 0; (header = StrExtract(headers,n)) != ""; ++n) {};\r\n\tw = width/n; wi = y; prevwi = y;\r\n\tif (LeftClickInside(x,y,width,height)) {\r\n\t\tpy = GetCursorYPosition( 1 );\r\n\t\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\t\twi =wi+headheight;\t\t\t\r\n\t\t\tif ((py &gt; prevwi) &amp;&amp; (py &lt; wi))  { choice = i; break; }\r\n\t\t}\r\n\t\tGfxSetState(id, choice); // StaticVarSet(na, choice);\r\n\t}\r\n\tGfxSetBkMode(1);\r\n\t// Draw Zone &amp; Tabs\r\n\twi = y; prevwi = y;\r\n\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\twi = wi + headheight;\t\r\n\t\t GfxSelectSolidBrush(ColorBlend( colorBrightGreen, colorWhite, 0.7 )); \r\n\t\t GfxSelectPen( colorLightGrey, 0 ); // data tooltip round border color\r\n\t\tGfxRoundRect(x,prevwi-1,x+width,wi,5,5); \r\n\t\tGfxSelectSolidBrush( colorbg );\r\n\t\tif (i != choice) {\r\n\t\t\tGfxSelectHatchBrush(colorbg,7); \r\n\t\t\tGfxRoundRect(x,prevwi-1,x+width,wi,5,5);\r\n\t\t\tGfxSelectSolidBrush( colorbg );\r\n\t\t} else {\r\n\t\t\twic = wi; prevwic = prevwi;\r\n\t\t}\r\n\t\tGfxSetTextColor( colorDarkGrey );\r\n\t\t\r\n\t\tGfxSelectFont("Verdana",8, 500);//Tahoma\r\n\t\tGfxDrawText(header, x-50, prevwi, x+160, wi, 1|4|32);\r\n\tprevwi = wi;\r\n\t}\r\n\treturn choice;\r\n}\r\n\r\nfunction GfxHTabs(id, headers, headheight, x, y, width, height, colorfg, colorbg,Font,Colortb) {\r\n\tglobal _x0, _y0;\r\n\tlocal px,choice,na,i,n,header,w, wi, prevwi;\r\n\t\r\n\tx = x+_x0; y = y+_y0; choice = GfxGetState(id);\r\n\tfor(n = 0; (header = StrExtract(headers,n)) != ""; ++n) {};\r\n\tw = width/n; wi = x; prevwi = x;\r\n\tif (LeftClickInside(x,y,width,headheight)) {\r\n\t\tpx = GetCursorXPosition( 1 );\r\n\t\t//choice = floor((px - x)/w);\r\n\t\t// wi = x; prevwi = x;\r\n\t\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\t\twi = wi + 1.32*GfxGetTextWidth(header);\r\n\t\t\tif ((px &gt; prevwi) &amp;&amp; (px &lt; wi))  { choice = i; break; }\r\n\t\t}\r\n\t\tGfxSetState(id, choice); // StaticVarSet(na, choice);\r\n\t}\r\n\tGfxSetBkMode(1);\r\n\t// Draw Zone &amp; Tabs\r\n\twi = x; prevwi = x;\r\n\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\twi = wi + 1.32*GfxGetTextWidth(header);\r\n\r\n\t\t GfxSelectSolidBrush(ColorBlend( colorLime, colorWhite, 0.7 )); \r\n\t\t GfxSelectPen( Colortb, 0 ); // data tooltip round border color\r\n\t\tGfxRoundRect(prevwi,y,wi,y+headheight+5,5,5); \r\n\t\tGfxSelectSolidBrush( colorbg );\r\n\t\tif (i != choice) {\r\n\t\t\tGfxSelectHatchBrush(colorbg,7); \r\n\t\t\tGfxRoundRect(prevwi,y,wi,y+headheight+5,5,5); \r\n\t\t\tGfxSelectSolidBrush( colorbg );\r\n\t\t} else {\r\n\t\t\twic = wi; prevwic = prevwi;\r\n\t\t}\r\n\t\tGfxSetTextColor( Colortb );\r\n\t\tGfxSelectFont("Tahoma",Font, 500);\r\n\t\tGfxDrawText(header, prevwi, y, wi, y+headheight+5, 1|4|32);\r\n\tprevwi = wi;\r\n\t}\r\n\treturn choice;\r\n}\r\n\r\nprocedure GfxTSI1(x,y,col1,col2,ti) {\r\n\tSetOrigin(x,y);\r\nindica = ParamList("Chon indica", "RSI|STOCH",0);\r\nn = GfxHTabs("HTab", " RSI ,STOCH", 20, 0, -25, 1000, 500, colorBlack, ColorBlend( colorLime, colorWhite, 0.9 ),8,ColorBlend( colorBlack, colorWhite, 0.2 )); \r\n\tswitch(n) {\r\n\r\n\t\tcase 0: \r\nindica = ParamList("Chon indica", "RSI",0);\r\n\t\tbreak;\r\n\r\n\t\tcase 1:   \r\nindica = ParamList("Chon indica", "STOCH",0);\r\n\t\t break;\r\n}\r\nswitch (indica)\r\n{\r\ncase "RSI":\r\n/////RSI HEATMAP\r\npxw = ( pxr - pxl ) / 9;\r\npxh = ( pxb - pxt ) / 6;\r\nGfxFillSolidRect(pxl+102,pxt-5, pxr+70, pxt+pxh, ColorBlend( colorRose, GetChartBkColor(), 0.3 ) );//80\r\nGfxFillSolidRect(pxl,pxt+pxh*2, pxr+70, pxt+pxh, ColorBlend( colorRose, GetChartBkColor(), 0.6 ) );//70\r\nGfxFillSolidRect(pxl,pxb, pxr+70, pxt+pxh*2, ColorBlend( colorWhite, GetChartBkColor(), 0.9 ) ); //60\r\nGfxFillSolidRect(pxr+70,pxb, pxl, pxb-pxh*2, ColorBlend( colorBrightGreen, colorWhite, 0.9 ) );//40 \r\nGfxFillSolidRect(pxr+70,pxb+5, pxl, pxb-pxh, ColorBlend( colorBrightGreen, colorWhite, 0.8 ) );//30\r\n////////////////\r\nfor ( i = 0; i &lt; 24; i++ )\r\n    {\r\nGfxSelectPen( ColorBlend( colorLightGrey, colorWhite, 0.6 ),1); \r\nGfxMoveTo( pxl, pxt+pxh*(i+1)/4 ); \r\nGfxLineTo( pxr+70, pxt+pxh*(i+1)/4 );\r\n}\r\nGfxSelectPen( colorLightGrey,1); \r\nGfxMoveTo( pxl, pxt+pxh ); \r\nGfxLineTo( pxr+70, pxt+pxh );\r\nGfxMoveTo( pxl, pxt+pxh*2 ); \r\nGfxLineTo( pxr+70, pxt+pxh*2 );\r\nGfxMoveTo( pxl, pxb-pxh*2 ); \r\nGfxLineTo( pxr+70, pxb-pxh*2 );\r\nGfxMoveTo( pxl, pxb-pxh ); \r\nGfxLineTo( pxr+70, pxb-pxh );\r\nfor ( i = 1; i &lt; 36; i++ )\r\n    {\r\nGfxSelectPen(ColorBlend( colorLightGrey, colorWhite, 0.5 ) );\r\nGfxMoveTo( pxl + pxw*(i+1)/4, pxt );\r\nGfxLineTo( pxl + pxw*(i+1)/4, pxb );\r\n}\r\nGfxMoveTo( pxl + pxw*(1)/4, pxt+50 );\r\nGfxLineTo( pxl + pxw*(1)/4, pxb );\r\nGfxSetOverlayMode(0);\r\nGfxSelectFont("Arial",10, 500);\r\nGfxSetBkMode(0); // transparent\r\nGfxSetTextColor( colorLightGrey );\r\nGfxTextOut("80", pxr+10, pxt+5);\r\nGfxTextOut("70", pxr+10, pxt+pxh-20);\r\nGfxTextOut("60", pxr+10, pxt+pxh*2-20);\r\nGfxTextOut("50", pxr+10, pxb-pxh*3-20);\r\nGfxTextOut("40", pxr+10, pxb-pxh*2-20);\r\nGfxTextOut("30", pxr+10, pxb-pxh-20);\r\nGfxTextOut("20", pxr+10, pxb-20);\r\n//////////\r\nGfxSetTextColor( ColorBlend( colorBrightGreen, colorLightGrey, 0.9 ) );\r\nGfxTextOut("OVERBOUGHT", pxr-150*fixx, pxt+pxh/2);\r\nGfxTextOut("STRONG", pxr-150*fixx, pxt+pxh*1.5);\r\nGfxTextOut("NEUTRAL", pxr-150*fixx, pxb-pxh*3);\r\nGfxTextOut("WEAK", pxr-150*fixx, pxb-pxh*1.5);\r\nGfxTextOut("OVERSOLD", pxr-150*fixx, pxb-pxh/2);\r\n/////////\r\nbreak;\r\ncase "STOCH":\r\n/////RSI HEATMAP\r\npxw = ( pxr - pxl ) / 10;\r\npxh = ( pxb - pxt ) / 10;\r\nGfxFillSolidRect(pxl+102,pxt-5, pxr+70, pxt+pxh, ColorBlend( colorRose, GetChartBkColor(), 0.3 ) );//80\r\nGfxFillSolidRect(pxl,pxt+pxh*2, pxr+70, pxt+pxh, ColorBlend( colorRose, GetChartBkColor(), 0.3 ) );//70\r\nGfxFillSolidRect(pxl,pxb, pxr+70, pxt+pxh*2, ColorBlend( colorWhite, GetChartBkColor(), 0.9 ) ); //60\r\nGfxFillSolidRect(pxr+70,pxb, pxl, pxb-pxh*2, ColorBlend( colorBrightGreen, colorWhite, 0.8 ) );//40 \r\n////////////////\r\nfor ( i = 0; i &lt; 24; i++ )\r\n    {\r\nGfxSelectPen( ColorBlend( colorLightGrey, colorWhite, 0.6 ),1); \r\nGfxMoveTo( pxl, pxt+pxh*(i+1)/2 ); \r\nGfxLineTo( pxr+70, pxt+pxh*(i+1)/2 );\r\n}\r\nGfxSelectPen( colorLightGrey,1); \r\nGfxMoveTo( pxl, pxt+pxh*2 ); \r\nGfxLineTo( pxr+70, pxt+pxh*2 );\r\nGfxMoveTo( pxl, pxb-pxh*2 ); \r\nGfxLineTo( pxr+70, pxb-pxh*2 );\r\nfor ( i = 1; i &lt; 40; i++ )\r\n    {\r\nGfxSelectPen(ColorBlend( colorLightGrey, colorWhite, 0.5 ) );\r\nGfxMoveTo( pxl + pxw*(i+1)/4, pxt );\r\nGfxLineTo( pxl + pxw*(i+1)/4, pxb );\r\n}\r\nGfxMoveTo( pxl + pxw*(1)/4, pxt+50 );\r\nGfxLineTo( pxl + pxw*(1)/4, pxb );\r\nGfxSelectFont("Arial",10, 500);\r\nGfxSetTextColor( colorLightGrey );\r\nGfxTextOut("80", pxr+10, pxt+pxh*2-30);\r\nGfxTextOut("20", pxr+10, pxb-pxh*2-30);\r\nGfxTextOut("0", pxr+10, pxb-20);\r\n//////////\r\nGfxSetTextColor( ColorBlend( colorBrightGreen, colorLightGrey, 0.9 ) );\r\nGfxTextOut("OVERBOUGHT", pxr-200, pxt+pxh);\r\n//GfxTextOut("STRONG", pxr-200, pxt+pxh*1.5);\r\nGfxTextOut("NEUTRAL", pxr-200, pxb-pxh*5);\r\n//GfxTextOut("WEAK", pxr-200, pxb-pxh*1.5);\r\nGfxTextOut("OVERSOLD", pxr-200, pxb-pxh);\r\nbreak;\r\n}\r\nGfxSetTextColor( colorGold );\r\nGfxTextOut("0%", pxl + pxw*4.5+5, pxb-25);\r\nGfxSetTextColor( ColorBlend( colorGreen, colorWhite, 0.4 )  );\r\nGfxTextOut("2%", pxl + pxw*5+5, pxb-25);\r\nGfxTextOut("4%", pxl + pxw*5.5+5, pxb-25);\r\nGfxTextOut("6%", pxl + pxw*6+5, pxb-25);\r\nGfxTextOut("8%", pxl + pxw*6.5+5, pxb-25);\r\nGfxTextOut("10%", pxl + pxw*7+5, pxb-25);\r\nGfxTextOut("12%", pxl + pxw*7.5+5, pxb-25);\r\nGfxTextOut("14%", pxl + pxw*8+5, pxb-25);\r\nGfxTextOut("16%", pxl + pxw*8.5+5, pxb-25);\r\nGfxSetTextColor(ColorBlend( colorRed, colorWhite, 0.7 )   );\r\nGfxTextOut("-2%", pxl + pxw*4+5, pxb-25);\r\nGfxTextOut("-4%", pxl + pxw*3.5+5, pxb-25);\r\nGfxTextOut("-6%", pxl + pxw*3+5, pxb-25);\r\nGfxTextOut("-8%", pxl + pxw*2.5+5, pxb-25);\r\nGfxTextOut("-10%", pxl + pxw*2+5, pxb-25);\r\nGfxTextOut("-12%", pxl + pxw*1.5+5, pxb-25);\r\nGfxTextOut("-14%", pxl + pxw*1+5, pxb-25);\r\nGfxTextOut("-16%", pxl + pxw*0.5+5, pxb-25);\r\n\r\nNGANHANG=ParamStr("NGAN HANG","ABB,ACB,BID,BVB,CTG,HDB,LPB,MBB,MSB,NAB,OCB,SHB,STB,TCB,TPB,VCB,VIB,VPB,VAB");\r\nCHUNGKHOAN=ParamStr("CHUNG KHOAN","AAS,AGR,APG,BSI,BVS,CTS,EVF,EVS,FTS,HCM,MBS,SBS,SHS,SSI,VCI,VDS,VIX,VND,APS,HBS,IVS,ORS,TVB,TVS,VIG,BMS,TCI,VFS");\r\nTHEP=ParamStr("THEP","HPG,HSG,NKG,SMC,TLH,TVN,VGS,NSH");\r\nDAUKHI=ParamStr("DAU KHI","BSR,CNG,GAS,OIL,PET,PLX,POW,PSH,PVB,PVC,PVD,PVS,PVT,PXS,PLC");\r\nBAOHIEM=ParamStr("BAO HIEM","BVH,BMI,MIG");\r\nBATDONGSAN=ParamStr("BAT DONG SAN","CCL,CEO,DIG,DLG,DPG,DRH,DTD,DXG,HAR,HBC,HDC,HDG,HLD,HQC,HUT,IJC,KDH,NBB,NDN,NTL,NVL,PDR,SCR,TCH,TDH,VHM,VIC,VPH,VRE,HTN,CRE,HAG,IDJ,ITC,NHA,OGC,SGR,AAV,API,DXS,HPX,KHG,NRC,TEG");\r\nBDSKCN=ParamStr("BDS-KCN","D2D,GVR,IDC,ITA,KBC,LDG,LHG,NLG,PHR,QCG,REE,SIP,SZC,TDC,TIG,TIP");\r\nXD_VLXD=ParamStr("XD_VLXD","VCG,VC7,HU4,MST,VC3,ACC,QNC,SCL,VGC,BCE,CSC,TTB,C69,CRC,HID,HVH,LIG,PAS,S99,SCG,SCI,TLD,EVG,CTD,PHC,CKG");\r\nDAUTUCONG=ParamStr("DAU TU CONG","BCC,BTS,C47,C4G,CII,CTI,DHA,FCN,G36,HOM,HT1,KSB,LCG,SD5,SD6,TCD,THG,TV2");\r\nCAOSU=ParamStr("CAO SU","DPR,DRC,DRI,GVR,PHR,VHG,HNG");\r\nDETMAY=ParamStr("DET MAY","ADS,EVE,FTM,GIL,KMR,MSH,STK,TCM,TNG,VGT");\r\nTHANKHOANGSAN=ParamStr("THAN - KHOANG SAN","CLX,KSB,MDC,NBC,NNC,TDN,THT,TVD,VEF,CST,BMC,DHM,KHB,KSQ,MSR,TC6,TNT");\r\nTHUYSAN=ParamStr("THUYSAN","ACL,ANV,ASM,CMX,FMC,IDI,MPC,VHC");\r\nTHUCPHAMXK=ParamStr("THUC PHAM-XK","DBC,DHC,LTG,MHC,MSN,NAF,PTB,TNA,VCS,VLC,VNM,VOC,BNA,TAR,VHE");\r\nHOACHATPHANBON=ParamStr("HOA CHAT - PHAN BON","BFC,CSV,DCM,DDV,DGC,DPM,LAS,QBS,TSC,SBV,HCD,ABS");\r\nBLECONGNGHE=ParamStr("CONG NGHE - BAN LE","DGW,ELC,FPT,FRT,ITD,MWG,PET,PNJ,SAM,SRA,TTN,CTR,VGI");\r\nCANGVANTAI=ParamStr("CANG - VAN TAI","DXP,GMD,HAH,PVP,PVT,SGP,SKG,TCL,VIP,VOS,VSC,VTO,GSP,HHG,TCO,TMS");\r\nDICHVU=ParamStr("DICH VU","HAX,PAN,TCT,VNG,VTP");\r\nDIEN_NANGLUONG=ParamStr("DIEN_NANGLUONG","KHP,PPC,PVG,QTP,VSH,TTA,GEG,SJD,NT2,REE,PC1,GEX,VNE");\r\nDTPT=ParamStr("DTPT","FID,FIT,HHS,SJF");\r\nDUONGGO=ParamStr("DUONG - GO","GDT,LSS,QNS,SBT,TTF");\r\nHANGKHONGDULICH=ParamStr("HANG KHONG-DU LICH","HVN,VJC,VTD,DAH,RIC");\r\nNUOCNHUA=ParamStr("NUOC NHUA","AAA,APH,BMP,BWE,DAG,NTP,TDM,HII,NHH,PLP");\r\nSXKD=ParamStr("SXKD","DQC,HAP,NAG,RAL,SAV,TLG");\r\nYTEDUOC=ParamStr("YTEDUOC","AMV,DCL,DHG,DMC,JVC,TNH");\r\nTHEODOI=ParamStr("THEODOI","AMV,JVC,LAS,VC7,KDH");\r\nVN30=ParamStr("VN30","ACB,BID,BVH,CTG,FPT,GAS,GVR,HDB,HPG,KDH,MBB,MSN,MWG,NVL,PDR,PLX,PNJ,POW,SAB,SSI,STB,TCB,TPB,VCB,VHM,VIC,VJC,VNM,VPB,VRE");\r\n//////\r\nm = GfxHTabs1("HTab2", "VN30,NG\\u00C2N H\\u00C0NG,CH\\u1EE8NG KHO\\u00C1N,TH\\u00C9P,D\\u1EA6U KH\\u00CD,B\\u1EA2O HI\\u1EC2M,B\\u1EA4T \\u0110\\u1ED8NG S\\u1EA2N,BDS - KCN,XD - VLXD,\\u0110\\u1EA6U T\\u01AF C\\u00D4NG,CAO SU, D\\u1EC6T MAY,THAN-KS,TH\\u1EE6Y S\\u1EA2N,TH\\u1EF0C PH\\u1EA8M-XK,H/CH\\u1EA4T-P/B\\u00D3N,B/L\\u1EBA-C/NGH\\u1EC6,C\\u1EA2NG-V\\u1EACN T\\u1EA2I,D\\u1ECACH V\\u1EE4,\\u0110I\\u1EC6N-N/L\\u01AF\\u1EE2NG,DTPT,\\u0110\\u01AF\\u1EDCNG G\\u1ED6,H/KH\\u00D4NG - DL,N\\u01AF\\u1EDA\\u0043 NH\\u1EF0A,SXKD,YT\\u1EBE-D\\u01AF\\u1EE2\\u0043,THEO D\\u00D5I TU\\u1EA6N,THEO D\\u00D5I NG\\u00C0Y,CP THEO DOI", 22.3, 0, 00, 110, 1200, colorBlack, ColorBlend( colorLime, colorWhite, 0.9 ));\r\nswitch(m) {\r\ncase 0: \r\ntickerlist =VN30;\r\n\r\nbreak;\r\ncase 1: \r\ntickerlist =NGANHANG;\r\nbreak;\r\ncase 2: \r\ntickerlist =CHUNGKHOAN;\r\nbreak;\r\ncase 3: \r\ntickerlist =THEP;\r\nbreak;\r\ncase 4: \r\ntickerlist =DAUKHI;\r\nbreak;\r\ncase 5: \r\ntickerlist =BAOHIEM;\r\nbreak;\r\ncase 6: \r\ntickerlist =BATDONGSAN;\r\nbreak;\r\ncase 7: \r\ntickerlist =BDSKCN;\r\nbreak;\r\ncase 8: \r\ntickerlist =XD_VLXD;\r\nbreak;\r\ncase 9: \r\ntickerlist =DAUTUCONG;\r\nbreak;\r\ncase 10: \r\ntickerlist =CAOSU;\r\nbreak;\r\ncase 11: \r\ntickerlist =DETMAY;\r\nbreak;\r\ncase 12: \r\ntickerlist =THANKHOANGSAN;\r\nbreak;\r\ncase 13: \r\ntickerlist =THUYSAN;\r\nbreak;\r\ncase 14: \r\ntickerlist =THUCPHAMXK;\r\nbreak;\r\ncase 15: \r\ntickerlist =HOACHATPHANBON;\r\nbreak;\r\ncase 16: \r\ntickerlist =BLECONGNGHE;\r\nbreak;\r\ncase 17: \r\ntickerlist =CANGVANTAI;\r\nbreak;\r\ncase 18: \r\ntickerlist =DICHVU;\r\nbreak;\r\ncase 19: \r\ntickerlist =DIEN_NANGLUONG;\r\nbreak;\r\ncase 20: \r\ntickerlist =DTPT;\r\nbreak;\r\ncase 21: \r\ntickerlist =DUONGGO;\r\nbreak;\r\ncase 22: \r\ntickerlist =HANGKHONGDULICH;\r\nbreak;\r\ncase 23: \r\ntickerlist =NUOCNHUA;\r\nbreak;\r\ncase 24: \r\ntickerlist =SXKD;\r\nbreak;\r\ncase 25: \r\ntickerlist =YTEDUOC;\r\nbreak;\r\ncase 26: \r\nWatchlistName1 = ParamStr("WL1", "Theo Doi");\r\nwlnumber = CategoryFind(WatchlistName1, cat = categoryWatchlist); \r\ntickerlist =CategoryGetSymbols(cat, wlnumber);\r\nbreak;\r\ncase 27: \r\nWatchlistName = ParamStr("WL2", "TD New");\r\nwlnumber = CategoryFind(WatchlistName, cat = categoryWatchlist); \r\ntickerlist =CategoryGetSymbols(cat, wlnumber);\r\nbreak;\r\ncase 28: \r\nWatchlistName = ParamStr("WL3", "CP THEO DOI");\r\nwlnumber = CategoryFind(WatchlistName, cat = categoryWatchlist); \r\ntickerlist =CategoryGetSymbols(cat, wlnumber);\r\nbreak;\r\n}\r\n\r\n\r\nHor=Param("Horizontal Position",220,1,1200,1);\r\nVer=Param("Vertical Position",50,30,1000,1); \r\nGfxSelectFont("Tahoma",50, 900);\r\nGfxSetTextColor( col1 );\r\nGfxTextOut( ti, Hor, Ver+5);\r\nGfxSetTextColor( col2);\r\nGfxSelectFont("Tahoma",8, 600);\r\nGfxTextOut( "H U Y T U A N", Hor+10, Ver+90);\r\nGfxSelectFont("Tahoma",8, 500);\r\nGfxSetTextColor( colorGrey40 );\r\nGfxTextOut( "0937798534", Hor+20, Ver+105);\r\nGfxSetTextColor( colorGrey40 ); //GfxSetTextAlign( 6 );\r\nGfxSelectFont( "Tahoma", 7.5, 600, 0, 0, 900 );\r\nGfxTextOut( "RSI HEATMAP", Hor-12, Ver+120);\r\nGfxSelectPen( col1, 0 ); \r\nGfxSelectSolidBrush( col1);\r\nGfxRoundRect( Hor+5, Ver , Hor+21 , Ver+50 , 0, 0 ); \r\nGfxPolygon(Hor+13, Ver-10, Hor+36, Ver+20, Hor-10, Ver+20);\r\nGfxSelectPen( col2,0 );\r\nGfxSelectSolidBrush( col2);\r\nGfxRoundRect( Hor+50, Ver+7 , Hor+65 , Ver+25 , 0, 0 ); \r\nGfxRoundRect( Hor+75, Ver , Hor+90 , Ver+25 , 0, 0 );\r\nGfxRoundRect( Hor+100, Ver-10 , Hor+115 , Ver+25 , 0, 0 );\r\n///////////////\r\nlast_bar = BarCount-1;\r\nfor ( i = 0; ( sym = StrExtract( tickerlist, i ) ) != ""; i++ )\r\n{\r\n    SetForeign( sym );\r\n    fc = Foreign( sym, "C" );\r\n    chg=LastValue(ROC(fc,1));\r\n    switch (indica)\r\n{\r\ncase "RSI":\r\nrsi14=LastValue(RSIa(fc,14)&gt;Ref(RSIa(fc,14),-1));\r\n    y=pxb+(LastValue(RSIa(fc,14))-20)/60*(pxt-pxb);\r\n\tx=pxl + pxw*4.5+pxw*0.25*chg;\r\n\tGfxSelectSolidBrush(IIf(rsi14,ColorBlend( colorBrightGreen, colorWhite, 0.7 ),ColorBlend( colorRed, colorWhite, 0.5 )));\r\nbreak;\r\ncase "STOCH":\r\n  K=StochK( 15 , 3);\r\n    D=StochD( 15 , 3, 3 );\r\n    KCD=LastValue(Cross(K,D));\r\n    KlD=LastValue(K&gt;D);\r\n    fc = Foreign( sym, "C" );\r\n    chg=LastValue(ROC(fc,1));\r\n    y=pxb+LastValue(K)/100*(pxt-pxb);\r\n    x=pxl + pxw*4.5+pxw*0.25*chg;\r\n\tGfxSelectSolidBrush(IIf(KCD,ColorBlend( colorBrightGreen, colorWhite, 0.5 ),IIf(KlD,ColorBlend( colorBlue, colorWhite, 0.3 ),ColorBlend( colorRed, colorWhite, 0.5 ))));  \r\nbreak;\r\n    }\r\n    for ( ii = BarCount - 1; ii &lt; BarCount; ii++ )\r\n    {\r\n     GfxSelectFont("Verdana",10, 500);//Tahoma\r\n    GfxSelectPen( colorGrey40,1); \r\n    GfxCircle( x[ii], y[ii], 5 );\r\n    GfxTextOut( sym, x[ii] + 6 , y[ii] - 3 );\r\n    }\r\n    RestorePriceArrays( True );\r\n}\r\n}\r\nx = Param("x_origin1", 0, 0, 1980, 20);\r\ny = Param("y_origin1", 25, 0, 1980, 20);\r\nGfxTSI1(x,y,ColorRGB(48,199,48),ColorRGB(128,128,255),"UP");\r\n\r\n</Formula>
			<FilePath>Formulas\\Indicators\\suutam\\RSI-STOCH HEATMAP.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>0</Min>
			<Max>0</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>TongQuan</Name>
		<Pane>
			<ChartID>1001</ChartID>
			<PercentHeight>100</PercentHeight>
			<Formula>_SECTION_BEGIN("Tong Hop Nganh");\r\n//This code edited by HuyTuan: 0937798534\r\n//amibrokercodevn: https://t.me/amibrokercodevn\r\n//https://t.me/huytuanvt\r\n//Moi ung ho xin gui vao stk: 0081001154112 - Le Xuan Tuan - Ngan Hang VCB Vung Tau\r\npxwidth = Status( "pxwidth" );\r\npxheight = Status( "pxheight" );\r\nContrast1 = Param( "Contrast 1", 0.5, 0.01, 1, 0.01 );\r\nContrast2 = Param( "Contrast 2", 0.8, 0.01, 1, 0.01 );\r\nGfxSetOverlayMode( 2 );\r\nGfxSetBkMode( 0 ); // transparent\r\nGfxSelectSolidBrush( colorWhite );\r\nGfxSelectPen( colorWhite, 1 );\r\nGfxGradientRect( 0, 0, pxwidth, pxheight, colorBlack, colorBlack );\r\n////////////////\r\ncellheight = 23/870*pxheight;\r\ngrid1_col1_cellwidth = 130/1880*pxwidth;\r\ngrid1_col2_cellwidth = 170/1880*pxwidth;\r\ngrid1_col3_cellwidth = 190/1880*pxwidth;\r\n\r\n//etc..\r\nno_of_cols = 3;\r\nno_of_rows = 13;\r\npxr = Status( "pxchartright" );\r\npxb = Status( "pxchartbottom" );\r\nstart_x = pxr-445/1880*pxwidth;\r\nstart_y = pxb-300/870*pxheight;\r\n\r\nGfxSelectPen( colorGrey50 );\r\nfor (i=1; i&lt;=no_of_rows; i++) {\r\n\tx1 = start_x;\r\n\tfor (j=1; j&lt;=no_of_cols; j++)\r\n\t\tx1 += Nz(VarGet("grid1_col"+j+"_cellwidth"));\t\t \r\n\t//\r\n\ty = start_y + i * cellheight;\t\r\n\tGfxMoveTo( start_x, y ); \r\n\tGfxLineTo( x1, y );\r\n}\r\n\r\ncellwidth = 0;\r\nfor (j=0; j&lt;=no_of_cols; j++) {\r\n\tcellwidth += Nz(VarGet("grid1_col"+j+"_cellwidth"));\r\n\tx2 = start_x+cellwidth;\r\n\tGfxMoveTo( x2, start_y+cellheight ); \r\n\tGfxLineTo( x2, start_y+cellheight*no_of_rows);\t\r\n}\r\n//STT\r\nGfxSelectFont("Verdana",9/870*pxheight, 500);\r\nGfxSetBkColor(colorWhite);\r\nGfxSetTextColor( colorWhite);\r\nGfxTextOut("VN30", start_x+10/1880*pxwidth, start_y+3/870*pxheight+cellheight*2);\r\nGfxTextOut("BDS", start_x+10/1880*pxwidth, start_y+3/870*pxheight+cellheight*3);\r\nGfxTextOut("XD-VLXD", start_x+10/1880*pxwidth, start_y+3/870*pxheight+cellheight*4);\r\nGfxTextOut("CHUNG KHOAN", start_x+10/1880*pxwidth, start_y+3/870*pxheight+cellheight*5);\r\nGfxTextOut("NGAN HANG", start_x+10/1880*pxwidth, start_y+3/870*pxheight+cellheight*6);\r\nGfxTextOut("THEP", start_x+10/1880*pxwidth, start_y+3/870*pxheight+cellheight*7);\r\nGfxTextOut("DAU KHI", start_x+10/1880*pxwidth, start_y+3/870*pxheight+cellheight*8);\r\n///////\r\nGfxTextOut("CANG-VAN TAI", start_x+10/1880*pxwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*2);\r\nGfxTextOut("TP-XUAT KHAU", start_x+10/1880*pxwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*3);\r\nGfxTextOut("DAU TU CONG", start_x+10/1880*pxwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*4);\r\nGfxTextOut("BDS KCN", start_x+10/1880*pxwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*5);\r\nGfxTextOut("B/LE-CONG NGHE", start_x+10/1880*pxwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*6);\r\nGfxTextOut("THAN-KHOANG SAN", start_x+10/1880*pxwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*7);\r\nGfxTextOut("DIEN-NANG LUONG", start_x+10/1880*pxwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*8);\r\n///////\r\nGfxTextOut("BAO HIEM", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*2);\r\nGfxTextOut("NUOC-NHUA", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*3);\r\nGfxTextOut("DET MAY", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*4);\r\nGfxTextOut("HANG KHONG-DU LICH", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*5);\r\nGfxTextOut("YTE-DUOC", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*6);\r\nGfxTextOut("THUY SAN", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*7);\r\nGfxTextOut("P/BON-HOA CHAT", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*8);\r\nGfxTextOut("CAO SU", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*9);\r\nGfxTextOut("SXKD - DTPT", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*10);\r\nGfxTextOut("DICH VU", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*11);\r\nGfxTextOut("DUONG-GO", start_x+10/1880*pxwidth+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+3/870*pxheight+cellheight*12);\r\n/////////////\r\nGfxSelectFont( "Arial", 11/870*pxheight, 500 );\r\nGfxSetTextColor( colorBlue );\r\nGfxSelectSolidBrush(ColorBlend( colorLightGrey, colorWhite, Contrast2 ));\r\nGfxRoundRect( start_x, start_y+cellheight*9, start_x+grid1_col2_cellwidth+grid1_col1_cellwidth, start_y+cellheight*13,10,10 );\r\nGfxTextOut( "TSI - T\\u1ED4NG H\\u1EE2P NG\\u00C0NH",start_x+30/1880*pxwidth, start_y+cellheight*9+4);\r\nGfxSelectFont( "Arial", 10/870*pxheight, 500 );\r\nGfxSetTextColor( colorDarkTeal );\r\nGfxTextOut( "EDIT BY : aaaaaa",start_x+30/1880*pxwidth, start_y+cellheight*10+2);\r\nGfxTextOut( "Tong Quan Thi Truong",start_x+30/1880*pxwidth, start_y+cellheight*11+2);\r\nGfxSelectFont( "Arial", 9.0/870*pxheight, 500 );\r\nGfxSetTextColor( colorRed );\r\nGfxTextOut( "Ch\\u1ECDn Trang \\u0110\\u1EC3 Xem Ng\\u00E0nh T\\u01B0\\u01A1ng \\u1EE8ng",start_x+15/1880*pxwidth, start_y+cellheight*12);\r\n////////////////////\r\n\r\nTrang = ParamList("Chon Trang", "Trang1|Trang2|Trang3",0);\r\nprocedure SetOrigin(x0, y0) {\r\n\tglobal _x0, _y0;\r\n\t_x0 = x0; _y0 = y0;\r\n}\r\n_cursorMouseButtons = GetCursorMouseButtons();\r\nDT_CENTER = 1; DT_VCENTER = 4 | 32; \r\nfunction GfxGetState(id) {\r\n\treturn Nz(StaticVarGet("GfxState"+id+GetChartID()), 0);\r\n}\r\nfunction PointInside(x0, y0, x, y, width, height) {\r\n    global _x0, _y0;\r\n\tx = x+_x0; y = y+_y0;\r\n    x0 = x0+_x0; y0 = y0+_y0;\r\n\treturn ((x0 &gt;= x) &amp;&amp; (y0 &gt;= y) &amp;&amp; (x0 &lt;= (x+width)) &amp;&amp; (y0 &lt;= (y+height)));\r\n}\r\nfunction LeftClickInside(x, y, width, height) {\r\n\tglobal _cursorMouseButtons, _x0, _y0;\r\n\tlocal px, py, res;\r\n\t\t//x = x+_x0; y = y+_y0;\r\n\tres = False;\r\n\tif (_cursorMouseButtons &amp; 8) { // click\r\n\t\tpx = GetCursorXPosition(1); \r\n\t\tpy = GetCursorYPosition(1); \r\n\t\tres = PointInside(px, py, x, y, width, height);\r\n\t}\r\n\treturn res;\r\n}\r\nprocedure GfxSetState(id, val) {\r\n\tStaticVarSet("GfxState"+id+GetChartID(), val);\r\n}\r\nGfxSelectFont("Tahoma",10, 500);\r\nfunction GfxHTabs(id, headers, headheight, x, y, width, height, colorfg, colorbg) {\r\n\tglobal _x0, _y0;\r\n\tlocal px,choice,na,i,n,header,w, wi, prevwi;\r\n\t\r\n\tx = x+_x0; y = y+_y0; choice = GfxGetState(id);\r\n\tfor(n = 0; (header = StrExtract(headers,n)) != ""; ++n) {};\r\n\tw = width/n; wi = x; prevwi = x;\r\n\tif (LeftClickInside(x,y,width,headheight)) {\r\n\t\tpx = GetCursorXPosition( 1 );\r\n\t\t//choice = floor((px - x)/w);\r\n\t\t// wi = x; prevwi = x;\r\n\t\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\t\twi = wi + 2.93*GfxGetTextWidth(header);\r\n\t\t\tif ((px &gt; prevwi) &amp;&amp; (px &lt; wi))  { choice = i; break; }\r\n\t\t}\r\n\t\tGfxSetState(id, choice); // StaticVarSet(na, choice);\r\n\t}\r\n\tGfxSetBkMode(1);\r\n\t// Draw Zone &amp; Tabs\r\n\twi = x; prevwi = x;\r\n\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\twi = wi + 2.93*GfxGetTextWidth(header);\r\n\r\n\t\t GfxSelectSolidBrush(colorPaleGreen); \r\n\t\tGfxRoundRect(prevwi,y,wi,y+headheight+5,5,5); \r\n\t\tGfxSelectSolidBrush( colorbg );\r\n\t\tif (i != choice) {\r\n\t\t\tGfxSelectHatchBrush(colorbg,7); \r\n\t\t\tGfxRoundRect(prevwi,y,wi,y+headheight+5,5,5); \r\n\t\t\tGfxSelectSolidBrush( colorbg );\r\n\t\t} else {\r\n\t\t\twic = wi; prevwic = prevwi;\r\n\t\t}\r\n\t\tGfxDrawText(header, prevwi, y, wi, y+headheight+5, 1|4|32);\r\n\tprevwi = wi;\r\n\t}\r\n\treturn choice;\r\n}\r\n\r\nprocedure GfxTSI(x,y) {\r\n\tSetOrigin(x,y);\r\n\t//n = GfxHTabs("HTab1", "Trang 1,Trang 2,Trang 3", 20, 900, 100, 400, 500, colorBlack, colorLavender); \t\r\n\tn = GfxHTabs("HTab1", "Trang 1,Trang 2,Trang 3", 20, 0, 100, 400, 500, colorBlack, colorLavender); \t\r\n\tswitch(n) {\r\n\t\tcase 0: \r\nTrang = ParamList("Chon Trang", "Trang1",0);\r\n\t\tbreak;\r\n\t\tcase 1:   \r\nTrang = ParamList("Chon Trang", "Trang2",0);\r\n        break;\r\n\t\tcase 2: \r\nTrang = ParamList("Chon Trang", "Trang3",0);\r\n        break;\r\n\t}\r\n\t\r\n\t\r\n}\r\nxx1 = Param("x_origin", 300, 0, 1980, 20);\r\nyy1 =Param("y_origin", 488, 0, 1980, 20);\r\n//pxb = Status( "pxchartbottom" )-378;\r\n//x = xx1/1880*pxwidth;\r\nx = start_x+30/1880*pxwidth+(xx1-300)/1880*pxwidth;\r\ny = yy1/870*pxheight;\r\n\r\nGfxTSI(x,y);\r\n\r\n\r\nswitch (Trang)\r\n{\r\ncase "Trang1":\r\nListnganh = "VN30,BDS,XD-VLXD,CHUNG KHOAN,NGAN HANG,THEP,DAU KHI";\r\nbreak;\r\ncase "Trang2":\r\nListnganh = "CANG BIEN-VAN TAI,THUC PHAM-XUAT KHAU,DAU TU CONG,BDS KCN,BAN LE-CONG NGHE,THAN-KHOANG SAN,DIEN-NANG LUONG";\r\nbreak;\r\ncase "Trang3":\r\nListnganh = "BAO HIEM,NUOC-NHUA,DET MAY,HANG KHONG-DU LICH,YTE-DUOC,THUY SAN,PHAN BON-HOA CHAT,CAO SU,SXKD,DTPT,DICH VU,DUONG-GO";\r\nbreak;\r\n}\r\nGfxSelectPen( colorWhite, 1 );\r\nxht1=Param("VTRI-XHT",8,0,2000,1);\r\nyht1=Param("VTRI-YHT",37,0,1200,1);\r\nxht=xht1/1880*pxwidth;\r\nyht=yht1/870*pxheight;\r\nbtnWidth_ht = Param( "Cell Width CPTUAN", 260, 5, 1000, 1 );\r\nbtnHeight_ht = Param( "Cell Height CPTUAN ", 32, 5, 200, 1 );\r\nbtnWidth=btnWidth_ht/1880*pxwidth;\r\nbtnHeight=btnHeight_ht/870*pxheight;\r\n/////\r\nNGANHANG1=ParamStr("NGAN HANG","ABB,ACB,BAB,BID,BVB,CTG,EIB,HDB,KLB,LPB,MBB,MSB,NAB,NVB,OCB,PGB,SGB,SHB,STB,TCB,TPB,VBB,VCB,VIB,VPB,SSB,VAB,EVF");\r\nCHUNGKHOAN1=ParamStr("CHUNG KHOAN","AAS,AGR,APG,BSI,BVS,CTS,EVS,FTS,HCM,MBS,SBS,SHS,SSI,VCI,VDS,VIX,VND,APS,HBS,IVS,ORS,TVB,TVS,VIG,WSS,BMS,TCI,VFS,PSI,TVC");\r\nTHEP1=ParamStr("THEP","BVG,HMC,HPG,HSG,NKG,POM,SHA,SHI,SMC,TLH,TVN,VGS,TNS,VCA,KVC,NSH,ITQ");\r\nDAUKHI1=ParamStr("DAU KHI","BSR,CNG,GAS,OIL,PLX,PSH,PVB,PVC,PVD,PVS,PVT,PVX,PXS,PGC,PLC");\r\nBAOHIEM1=ParamStr("BAO HIEM","BVH,BMI,MIG,PVI,BIC,ABI,VNR");\r\nBATDONGSAN1=ParamStr("BAT DONG SAN","AGG,L14,BII,TDC,LDG,CCL,QCG,CEO,DIG,NLG,DLG,DPG,DRH,DTD,DXG,HAR,HDC,HDG,HLD,HQC,IJC,KDH,LGL,NBB,NDN,NTL,NVL,PDR,SCR,TCH,TDH,VHM,VIC,VPH,VRE,HTN,VHG,CRE,DTA,IDJ,IDV,ITC,NHA,OGC,SGR,AAV,API,DXS,FIR,HPX,KHG,NRC,PWA,TEG,VPI,VRC,PTL");\r\nBDSKCN1=ParamStr("BDS-KCN","D2D,GVR,IDC,ITA,KBC,LHG,NTC,PHR,SIP,SJS,SZC,SZL,TIG,TIP,VGC");\r\nXD_VLXD1=ParamStr("XD_VLXD","VCG,PTC,VC7,HU4,MST,VC3,ACC,QNC,SCL,BCE,CSC,HTI,TTB,APC,C69,CDO,CRC,HID,HVH,LIG,PAS,S99,SCG,SCI,SDP,MCG,TLD,UDJ,EVG,CTD,PHC,CKG,HBC,L18,HUT");\r\nDAUTUCONG1=ParamStr("DAU TU CONG","BCC,TCD,BTS,C32,C47,C4G,CII,CTI,DHA,FCN,G36,HOM,HT1,KSB,LCG,SD5,SD6,SD9,THG,TV2,HHV");\r\nCAOSU1=ParamStr("CAO SU","DPR,DRC,DRI,GVR,PHR");\r\nDETMAY1=ParamStr("DET MAY","ADS,EVE,FTM,GIL,KMR,MSH,STK,TCM,TNG,VGT");\r\nTHANKHOANGSAN1=ParamStr("THAN - KHOANG SAN","CLX,MDC,NBC,NNC,TDN,THT,TVD,VEF,CST,BMC,DHM,KHB,KSQ,MSR,TC6,TNT");\r\nTHUYSAN1=ParamStr("THUYSAN","ACL,ANV,ASM,CMX,FMC,IDI,MPC,VHC");\r\nTHUCPHAMXK1=ParamStr("THUC PHAM-XK","AFX,DBC,DHC,KDC,MHC,MSN,NAF,TNA,VCS,VLC,VNM,VOC,APF,BNA,KDF,MCM,MLS,TAR,VHE,HAG,PAN,HNG");\r\nHOACHATPHANBON1=ParamStr("HOA CHAT - PHAN BON","BFC,CSV,DCM,DDV,DGC,DPM,LAS,LIX,QBS,TSC,PMB,SBV,HCD,ABS,LTG");\r\nBLECONGNGHE1=ParamStr("CONG NGHE - BAN LE","CMG,DGW,ELC,FOX,FPT,FRT,ITD,MWG,PET,PNJ,SAB,SGT,SAM,SRA,TTN,CTR,VGI,VNZ,YEG,HAX");\r\nCANGVANTAI1=ParamStr("CANG - VAN TAI","DVP,DXP,GMD,HAH,PHP,PVP,PVT,SGP,SKG,SWC,TCL,TCW,VIP,VOS,VSC,VTO,STG,GSP,HHG,TCO,TMS,VNA,ILB,PVP");\r\nDICHVU1=ParamStr("DICH VU","VTP");\r\nDIEN_NANGLUONG1=ParamStr("DIEN_NANGLUONG","KHP,PPC,PVG,QTP,VSH,TTA,GEG,SJD,NT2,REE,PC1,HND,GEX,VNE,POW");\r\nDTPT1=ParamStr("DTPT","EID,FID,FIT,HHS,SJF,VCR,BCG");\r\nDUONGGO1=ParamStr("DUONG - GO","GDT,LSS,QNS,SBT,TTF,PTB");\r\nHANGKHONGDULICH1=ParamStr("HANG KHONG-DU LICH","ACV,AST,HVN,SAS,VJC,VTD,NCT,DAH,RIC,TCT,VNG");\r\nNUOCNHUA1=ParamStr("NUOC NHUA","AAA,APH,BMP,BWE,DAG,NTP,TDM,VNP,HII,NHH,PGN,PLP");\r\nSXKD1=ParamStr("SXKD","DQC,HAP,NAG,PAC,RAL,SAV,TLG,MBG");\r\nYTEDUOC1=ParamStr("YTEDUOC","AMV,DBD,DCL,DHG,DMC,DVN,JVC,TNH");\r\nVN301=ParamStr("VN30","ACB,BID,BVH,CTG,FPT,GAS,GVR,HDB,HPG,KDH,MBB,MSN,MWG,NVL,PDR,PLX,PNJ,POW,SAB,SSI,STB,TCB,TPB,VCB,VHM,VIC,VJC,VNM,VPB,VRE");\r\n///////////\r\nfor ( e = 0; e &lt;= 11; e++ ) \r\n{\r\nWatchlistName=StrExtract(Listnganh, e );\r\nxtru=IIf(WatchlistName=="CAO SU" ,(xht+btnWidth)*e,IIf(WatchlistName=="SXKD" ,(xht+btnWidth)*(e-1),IIf(WatchlistName=="DTPT" ,(xht+btnWidth)*(e-2),IIf(WatchlistName=="DICH VU" ,(xht+btnWidth)*(e-3),IIf(WatchlistName=="DUONG-GO",(xht+btnWidth)*(e-4),0)))));\r\nytru=IIf(WatchlistName=="CAO SU" OR WatchlistName=="SXKD" OR WatchlistName=="DTPT" OR WatchlistName=="DICH VU" OR WatchlistName=="DUONG-GO",btnHeight*16,0);\r\nx=xht+(xht+btnWidth)*e-xtru;\r\ny=yht+ytru;\r\nadd=IIf(WatchlistName=="XD-VLXD",0.5,IIf(WatchlistName=="CHUNG KHOAN",1.3,IIf(WatchlistName=="NGAN HANG",1.3,\r\nIIf(WatchlistName=="THEP",0.1,IIf(WatchlistName=="DAU KHI",0.2,IIf(WatchlistName=="CANG BIEN-VAN TAI",4.5,\r\nIIf(WatchlistName=="THUC PHAM-XUAT KHAU",12,IIf(WatchlistName=="DAU TU CONG",1.5,IIf(WatchlistName=="BDS KCN",0.5,\r\nIIf(WatchlistName=="BAN LE-CONG NGHE",4,\r\nIIf(WatchlistName=="THAN-KHOANG SAN",5,\r\nIIf(WatchlistName=="PHAN BON-HOA CHAT",5,\r\nIIf(WatchlistName=="DIEN-NANG LUONG",4,IIf(WatchlistName=="NUOC-NHUA",1,IIf(WatchlistName=="DET MAY",0.5,\r\nIIf(WatchlistName=="HANG KHONG-DU LICH",8,IIf(WatchlistName=="YTE-DUOC",1,IIf(WatchlistName=="THUY SAN",0.7,IIf(WatchlistName=="BAO HIEM",0.5,\r\nIIf(WatchlistName=="CAO SU",0.2,IIf(WatchlistName=="DICH VU",0.5,IIf(WatchlistName=="DUONG-GO",1,0))))))))))))))))))))));\r\n\t\t\tGfxSelectFont( "Arial", 12/870*pxheight, 500 );\r\n\t\t\tGfxSetTextColor( colorWhite );\r\n\t\t\tGfxSelectSolidBrush(colorBlack);\r\n\t\t\tGfxRoundRect( x,y-2, x+btnWidth, y-btnHeight-2, 15, 15 );\r\n\t\t\tGfxTextOut( WatchlistName,x+btnWidth/(2.5+add), y-btnHeight/1.2 );\r\nListnganh1 = WriteIf(WatchlistName=="NGAN HANG",NGANHANG1,WriteIf(WatchlistName=="CHUNG KHOAN",CHUNGKHOAN1,WriteIf(WatchlistName=="THEP",THEP1,\r\n\t\t\tWriteIf(WatchlistName=="BDS KCN",BDSKCN1,WriteIf(WatchlistName=="DAU KHI",DAUKHI1,WriteIf(WatchlistName=="BAO HIEM",BAOHIEM1,\r\n\t\t\tWriteIf(WatchlistName=="BDS",BATDONGSAN1,WriteIf(WatchlistName=="DAU TU CONG",DAUTUCONG1,WriteIf(WatchlistName=="XD-VLXD",XD_VLXD1,\r\n\t\t\tWriteIf(WatchlistName=="CAO SU",CAOSU1,WriteIf(WatchlistName=="DET MAY",DETMAY1,\r\n\t\t\tWriteIf(WatchlistName=="BAN LE-CONG NGHE",BLECONGNGHE1,\t\t\t\r\n\t\t\tWriteIf(WatchlistName=="THUY SAN",THUYSAN1,WriteIf(WatchlistName=="THUC PHAM-XUAT KHAU",THUCPHAMXK1,WriteIf(WatchlistName=="PHAN BON-HOA CHAT",HOACHATPHANBON1,\r\n\t\t\tWriteIf(WatchlistName=="THAN-KHOANG SAN",THANKHOANGSAN1,\r\n\t\t\tWriteIf(WatchlistName=="CANG BIEN-VAN TAI",CANGVANTAI1,WriteIf(WatchlistName=="DICH VU",DICHVU1,\r\n\t\t\tWriteIf(WatchlistName=="DIEN-NANG LUONG",DIEN_NANGLUONG1,WriteIf(WatchlistName=="DTPT",DTPT1,WriteIf(WatchlistName=="DUONG-GO",DUONGGO1,\r\n\t\t\tWriteIf(WatchlistName=="HANG KHONG-DU LICH",HANGKHONGDULICH1,WriteIf(WatchlistName=="NUOC-NHUA",NUOCNHUA1,WriteIf(WatchlistName=="SXKD",SXKD1,\r\n\t\t\tWriteIf(WatchlistName=="YTE-DUOC",YTEDUOC1,VN301)))))))))))))))))))))))));\r\ntickerlist =Listnganh1;\r\nbi = BarIndex();\r\nfbr = Status("firstbarinrange");\r\nexplore = Status("action") == actionExplore;\r\nfvb = IIf(explore, LastValue(ValueWhen(fbr,bi)), Status("firstvisiblebar"));\r\nsym_num = StrCount(tickerlist, ",")+1;\r\nmat = Matrix(sym_num, 2);\r\nrownum = MxGetSize(mat, 0);\r\nlast_bar = BarCount-1;\r\n\tfor ( i = 0; ( symbol = StrExtract(TickerList, i ) ) != ""; i++ ) {\r\n\t\tfc = Foreign( symbol, "C" ); \r\n\t\tidx = Max(Min(NullCount(fc),last_bar), fvb);\r\n\t\tif (! IsNull(fc[ idx ])) {\r\n\t\t\trelP = ROC(fc,1); \t\t\r\n\t\t\tmat[i][0] = LastValue( relP ); \r\n\t\t\tmat[i][1] = i; \t\t\r\n\t\t}\r\n\t}\r\n\tmat = MxSortRows(mat, False, 0);\r\n\tfor ( i = 0; i &lt; rownum; i++ ) {\r\n\t\tval = mat[i][0];\tn = mat[i][1];\r\n\t\tif (! IsNull(val)) {\t\r\n\t\t\tsymbol = StrExtract(tickerlist, n);\r\n\t\t\tfcC = Foreign( symbol, "C" );\r\n\t\t\tfc1 = LastValue(Foreign( symbol, "C" ));\r\n\t\t\tfv1 = LastValue(Foreign( symbol, "V" )/MA(Foreign( symbol, "V" ),20));\r\n\t\t\tKL1 = LastValue(Foreign( symbol, "V" ));\r\n\t\t\tRSI1 = RSIa(fcC,14);\r\n\t\t\ttextht=symbol+"   "+WriteIf(fc1&lt;10,"0"+WriteVal(fc1,1.1),WriteVal(fc1,1.1))+StrFormat( "%s  %.1f%%", "  ",val)+"  RSI:"+\r\n\t\t\tWriteVal(RSI1,1.0)+ "  KL:"+WriteVal(KL1/1000000,1.1)+"T";\t\r\n\t\t\tColor = IIf(val &gt;= 6.5, ColorRGB(204,51,255),IIf(val &gt;= 3 AND val &lt; 6.5, ColorRGB(0,153,0),IIf(val &gt;= 1 AND val &lt; 3, ColorRGB(0,103,50),IIf(val &gt;=-1 AND val &lt; 1, ColorRGB(75,75,75),\r\n\t\t\tIIf(val &lt; -1 AND val&gt;=-3, ColorRGB(190,62,62),IIf(val &lt; -3 AND val&gt;=-6.5, ColorRGB(255,72,72), ColorRGB(0,153,153)))))));\r\n\t\t\tGfxSelectFont( "Arial", 9/870*pxheight, 500 );\r\n\t\t\tGfxSelectSolidBrush(Color);\r\n\t\t\tGfxFillSolidRect( x,(i * btnHeight)+y, x+btnWidth, btnHeight * (i+1)+y-1, Color );\r\n\t\t\tGfxDrawText(textht, x , btnHeight/4+(i * btnHeight)+y, x+btnWidth, btnHeight * (i+1)+y, 1);\r\n\t\t}\r\n\t}\t\t\r\n}\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Tong Hop Nganh 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>0</Min>
			<Max>0</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>tang giam</Name>
		<Pane>
			<ChartID>1080</ChartID>
			<PercentHeight>100</PercentHeight>
			<Formula>_SECTION_BEGIN("tang giam nganh dang cot");\r\npxwidth = Status( "pxwidth" );\r\npxheight = Status( "pxheight" );\r\npxb = Status( "pxchartbottom" );\r\npxr = Status( "pxchartright" );\r\nfixx=1/1880*pxwidth;\r\nfixy=1/870*pxheight;\r\nmaunenboad=ParamColor("colorkhung", ColorBlend( colorLavender, colorWhite,0.8 ));\r\nGfxGradientRect( 1, 1, pxwidth, pxheight, maunenboad, maunenboad );\r\n///\r\nGfxSetOverlayMode(0);\r\nGfxSelectFont("Verdana",10*fixx*fixy, 600);\r\nGfxSetBkMode(0); // transparent\r\n\r\nprocedure SetOrigin(x0, y0) {\r\n\tglobal _x0, _y0;\r\n\t_x0 = x0; _y0 = y0;\r\n}\r\n_cursorMouseButtons = GetCursorMouseButtons();\r\nDT_CENTER = 1; DT_VCENTER = 4 | 32; \r\nfunction GfxGetState(id) {\r\n\treturn Nz(StaticVarGet("GfxState"+id+GetChartID()), 0);\r\n}\r\nfunction PointInside(x0, y0, x, y, width, height) {\r\n    global _x0, _y0;\r\n\tx = x+_x0; y = y+_y0;\r\n    x0 = x0+_x0; y0 = y0+_y0;\r\n\treturn ((x0 &gt;= x) &amp;&amp; (y0 &gt;= y) &amp;&amp; (x0 &lt;= (x+width)) &amp;&amp; (y0 &lt;= (y+height)));\r\n}\r\nfunction LeftClickInside(x, y, width, height) {\r\n\tglobal _cursorMouseButtons, _x0, _y0;\r\n\tlocal px, py, res;\r\n\t\t//x = x+_x0; y = y+_y0;\r\n\tres = False;\r\n\tif (_cursorMouseButtons &amp; 8) { // click\r\n\t\tpx = GetCursorXPosition(1); \r\n\t\tpy = GetCursorYPosition(1); \r\n\t\tres = PointInside(px, py, x, y, width, height);\r\n\t}\r\n\treturn res;\r\n}\r\nprocedure GfxSetState(id, val) {\r\n\tStaticVarSet("GfxState"+id+GetChartID(), val);\r\n}\r\n\r\nfunction GfxHTabs1(id, headers, headheight, x, y, width, height, colorfg, colorbg) {\r\n\tglobal _x0, _y0;\r\n\tlocal py,choice,na,i,n,header,w, wi, prevwi;\t\r\n\tx = x+_x0; y = y+_y0; choice = GfxGetState(id);\r\n\tfor(n = 0; (header = StrExtract(headers,n)) != ""; ++n) {};\r\n\tw = width/n; wi = y; prevwi = y;\r\n\tif (LeftClickInside(x,y,width,height)) {\r\n\t\tpy = GetCursorYPosition( 1 );\r\n\t\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\t\twi =wi+headheight;\t\t\t\r\n\t\t\tif ((py &gt; prevwi) &amp;&amp; (py &lt; wi))  { choice = i; break; }\r\n\t\t}\r\n\t\tGfxSetState(id, choice); // StaticVarSet(na, choice);\r\n\t}\r\n\tGfxSetBkMode(1);\r\n\t// Draw Zone &amp; Tabs\r\n\twi = y; prevwi = y;\r\n\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\twi = wi + headheight;\t\t\r\n\t\t GfxSelectSolidBrush(ColorBlend( colorBrightGreen, colorWhite, 0.7 )); \r\n\t\t GfxSelectPen( colorLightGrey, 0 ); // data tooltip round border color\r\n\t\tGfxRoundRect(x,prevwi-1,x+width,wi,5,5); \r\n\t\tGfxSelectSolidBrush( colorbg );\r\n\t\tif (i != choice) {\r\n\t\t\tGfxSelectHatchBrush(colorbg,7); \r\n\t\t\tGfxRoundRect(x,prevwi-1,x+width,wi,5,5);\r\n\t\t\tGfxSelectSolidBrush( colorbg );\r\n\t\t} else {\r\n\t\t\twic = wi; prevwic = prevwi;\r\n\t\t}\t\t\r\n\t\tGfxSetTextColor( colorDarkGrey );\r\n\t\tGfxSelectFont("Verdana",8*fixy*fixx, 500);//Tahoma\r\n\t\tGfxDrawText(header, x-50*fixx, prevwi, x+160*fixx, wi, 1|4|32);\r\n\tprevwi = wi;\r\n\t}\r\n\treturn choice;\r\n}\r\n/////////PopupWindow\r\nglobal SVKey;\r\nSVKey = NumToStr(GetChartID(),1.0,False);\r\nprocedure xStaticVarSet( SName, SValue )\r\n{\r\n global SVKey;\r\n InIndicator = Status("Action") == 1;\r\n if( InIndicator ) StaticVarSet(Sname+SVKey, Svalue);\r\n}\r\nfunction xStaticVarGet( SName )\r\n{\r\n global SVKey;\r\n if( IsNull( Var = StaticVarGet(Sname+SVKey) ) ) Var = 0;;\r\n return Var;\r\n}\r\nif( Status("Action") == 1 )\r\n{\r\nif(xStaticVarGet("DoRefresh"))\r\n{\r\nif(200 &lt; BarCount)\r\n{\r\n xStaticVarSet("DoRefresh", False);\r\n}\r\nelse\r\n    PopupWindow( "Edited by Huy Tuan-0937798534    (https://t.me/amibrokercodevn)", "DWC Chart with multi time frame and button trading!", 5, -1, -1 );\r\n}\r\n     xStaticVarSet("Trigger", True);\r\nif(xStaticVarGet("Trigger"))\r\n{\r\nxStaticVarSet("DoRefresh",True); // this queues the refresh operation for the next pass through the code\r\n}\r\n}\r\n/////////////////\r\nprocedure GfxTSI1(x,y) {\r\n\tSetOrigin(x,y);\r\nNGANHANG=ParamStr("NGAN HANG","ABB,ACB,BID,BVB,CTG,HDB,LPB,MBB,MSB,NAB,OCB,SHB,STB,TCB,TPB,VCB,VIB,VPB,VAB");\r\nCHUNGKHOAN=ParamStr("CHUNG KHOAN","AAS,AGR,APG,BSI,BVS,CTS,EVF,EVS,FTS,HCM,MBS,SBS,SHS,SSI,VCI,VDS,VIX,VND,APS,HBS,IVS,ORS,TVB,TVS,VIG,BMS,TCI,VFS");\r\nTHEP=ParamStr("THEP","HPG,HSG,NKG,SMC,TLH,TVN,VGS,NSH");\r\nDAUKHI=ParamStr("DAU KHI","BSR,CNG,GAS,OIL,PET,PLX,POW,PSH,PVB,PVC,PVD,PVS,PVT,PXS,PLC");\r\nBAOHIEM=ParamStr("BAO HIEM","BVH,BMI,MIG");\r\nBATDONGSAN=ParamStr("BAT DONG SAN","CCL,CEO,DIG,DLG,DPG,DRH,DTD,DXG,HAR,HBC,HDC,HDG,HLD,HQC,HUT,IJC,KDH,NBB,NDN,NTL,NVL,PDR,SCR,TCH,TDH,VHM,VIC,VPH,VRE,HTN,CRE,HAG,IDJ,ITC,NHA,OGC,SGR,AAV,API,DXS,HPX,KHG,NRC,TEG");\r\nBDSKCN=ParamStr("BDS-KCN","D2D,GVR,IDC,ITA,KBC,LDG,LHG,NLG,PHR,QCG,REE,SIP,SZC,TDC,TIG,TIP");\r\nXD_VLXD=ParamStr("XD_VLXD","VCG,VC7,HU4,MST,VC3,ACC,QNC,SCL,VGC,BCE,CSC,TTB,C69,CRC,HID,HVH,LIG,PAS,S99,SCG,SCI,TLD,EVG,CTD,PHC,CKG");\r\nDAUTUCONG=ParamStr("DAU TU CONG","BCC,BTS,C47,C4G,CII,CTI,DHA,FCN,G36,HOM,HT1,KSB,LCG,SD5,SD6,TCD,THG,TV2");\r\nCAOSU=ParamStr("CAO SU","DPR,DRC,DRI,GVR,PHR,VHG,HNG");\r\nDETMAY=ParamStr("DET MAY","ADS,EVE,FTM,GIL,KMR,MSH,STK,TCM,TNG,VGT");\r\nTHANKHOANGSAN=ParamStr("THAN - KHOANG SAN","CLX,KSB,MDC,NBC,NNC,TDN,THT,TVD,VEF,CST,BMC,DHM,KHB,KSQ,MSR,TC6,TNT");\r\nTHUYSAN=ParamStr("THUYSAN","ACL,ANV,ASM,CMX,FMC,IDI,MPC,VHC");\r\nTHUCPHAMXK=ParamStr("THUC PHAM-XK","DBC,DHC,LTG,MHC,MSN,NAF,PTB,TNA,VCS,VLC,VNM,VOC,BNA,TAR,VHE");\r\nHOACHATPHANBON=ParamStr("HOA CHAT - PHAN BON","BFC,CSV,DCM,DDV,DGC,DPM,LAS,QBS,TSC,SBV,HCD,ABS");\r\nBLECONGNGHE=ParamStr("CONG NGHE - BAN LE","DGW,ELC,FPT,FRT,ITD,MWG,PET,PNJ,SAM,SRA,TTN,CTR,VGI");\r\nCANGVANTAI=ParamStr("CANG - VAN TAI","DXP,GMD,HAH,PVP,PVT,SGP,SKG,TCL,VIP,VOS,VSC,VTO,GSP,HHG,TCO,TMS");\r\nDICHVU=ParamStr("DICH VU","HAX,PAN,TCT,VNG,VTP");\r\nDIEN_NANGLUONG=ParamStr("DIEN_NANGLUONG","KHP,PPC,PVG,QTP,VSH,TTA,GEG,SJD,NT2,REE,PC1,GEX,VNE");\r\nDTPT=ParamStr("DTPT","FID,FIT,HHS,SJF");\r\nDUONGGO=ParamStr("DUONG - GO","GDT,LSS,QNS,SBT,TTF");\r\nHANGKHONGDULICH=ParamStr("HANG KHONG-DU LICH","HVN,VJC,VTD,DAH,RIC");\r\nNUOCNHUA=ParamStr("NUOC NHUA","AAA,APH,BMP,BWE,DAG,NTP,TDM,HII,NHH,PLP");\r\nSXKD=ParamStr("SXKD","DQC,HAP,NAG,RAL,SAV,TLG");\r\nYTEDUOC=ParamStr("YTEDUOC","AMV,DCL,DHG,DMC,JVC,TNH");\r\nTHEODOI=ParamStr("THEODOI","AMV,JVC,LAS,VC7,KDH");\r\nVN30=ParamStr("VN30","BVH,VPB,CTD,ADS,DHC,BAF,DVM,TMT,BCC,HT1,HTG,PAT,TNH,HHV,C4G,SIP,TLH,ELC,NTL,IDC,APG,HDB,BMI");\r\n//////\r\nm = GfxHTabs1("HTab2", "NG\\u00C2N H\\u00C0NG,CH\\u1EE8NG KHO\\u00C1N,TH\\u00C9P,D\\u1EA6U KH\\u00CD,B\\u1EA2O HI\\u1EC2M,B\\u1EA4T \\u0110\\u1ED8NG S\\u1EA2N,BDS - KCN,XD - VLXD,\\u0110\\u1EA6U T\\u01AF C\\u00D4NG,CAO SU, D\\u1EC6T MAY,THAN-KS,TH\\u1EE6Y S\\u1EA2N,TH\\u1EF0C PH\\u1EA8M-XK,H/CH\\u1EA4T-P/B\\u00D3N,B/L\\u1EBA-C/NGH\\u1EC6,C\\u1EA2NG-V\\u1EACN T\\u1EA2I,D\\u1ECACH V\\u1EE4,\\u0110I\\u1EC6N-N/L\\u01AF\\u1EE2NG,DTPT,\\u0110\\u01AF\\u1EDCNG G\\u1ED6,H/KH\\u00D4NG - DL,N\\u01AF\\u1EDA\\u0043 NH\\u1EF0A,SXKD,YT\\u1EBE-D\\u01AF\\u1EE2\\u0043,THEO D\\u00D5I TU\\u1EA6N,THEO D\\u00D5I NG\\u00C0Y", 22.3*fixy, 0, 00, 110*fixx, 1200, colorBlack, ColorBlend( colorLavender, colorWhite, 0.9 )); \r\nswitch(m) {\r\ncase 0: \r\ntickerlist =NGANHANG;\r\nbreak;\r\ncase 1: \r\ntickerlist =CHUNGKHOAN;\r\nbreak;\r\ncase 2: \r\ntickerlist =THEP;\r\nbreak;\r\ncase 3: \r\ntickerlist =DAUKHI;\r\nbreak;\r\ncase 4: \r\ntickerlist =BAOHIEM;\r\nbreak;\r\ncase 5: \r\ntickerlist =BATDONGSAN;\r\nbreak;\r\ncase 6: \r\ntickerlist =BDSKCN;\r\nbreak;\r\ncase 7: \r\ntickerlist =XD_VLXD;\r\nbreak;\r\ncase 8: \r\ntickerlist =DAUTUCONG;\r\nbreak;\r\ncase 9: \r\ntickerlist =CAOSU;\r\nbreak;\r\ncase 10: \r\ntickerlist =DETMAY;\r\nbreak;\r\ncase 11: \r\ntickerlist =THANKHOANGSAN;\r\nbreak;\r\ncase 12: \r\ntickerlist =THUYSAN;\r\nbreak;\r\ncase 13: \r\ntickerlist =THUCPHAMXK;\r\nbreak;\r\ncase 14: \r\ntickerlist =HOACHATPHANBON;\r\nbreak;\r\ncase 15: \r\ntickerlist =BLECONGNGHE;\r\nbreak;\r\ncase 16: \r\ntickerlist =CANGVANTAI;\r\nbreak;\r\ncase 17: \r\ntickerlist =DICHVU;\r\nbreak;\r\ncase 18: \r\ntickerlist =DIEN_NANGLUONG;\r\nbreak;\r\ncase 19: \r\ntickerlist =DTPT;\r\nbreak;\r\ncase 20: \r\ntickerlist =DUONGGO;\r\nbreak;\r\ncase 21: \r\ntickerlist =HANGKHONGDULICH;\r\nbreak;\r\ncase 22: \r\ntickerlist =NUOCNHUA;\r\nbreak;\r\ncase 23: \r\ntickerlist =SXKD;\r\nbreak;\r\ncase 24: \r\ntickerlist =YTEDUOC;\r\nbreak;\r\ncase 25: \r\ntickerlist =VN30="ACB,BID,BVH,CTG,FPT,GAS,GVR,HDB,HPG,KDH,MBB,MSN,MWG,NVL,PDR,PLX,PNJ,POW,SAB,SSI,STB,TCB,TPB,VCB,VHM,VIC,VJC,VNM,VPB,VRE"; //ok\r\nbreak;\r\ncase 26: \r\nWatchlistName = ParamStr("WL2", "TD New");\r\nwlnumber = CategoryFind(WatchlistName, cat = categoryWatchlist); \r\ntickerlist =CategoryGetSymbols(cat, wlnumber);\r\nbreak;\r\n}\r\nGfxSelectPen( ColorBlend( colorDarkGrey, colorWhite, 0.9 ), 0 ); // data tooltip round border color\r\nGfxSelectSolidBrush( ColorBlend( colorPaleBlue, colorWhite, 0.1 ) );\r\n//GfxRoundRect(0*fixx,840*fixy, 1051*fixx, 870*fixy, 10, 10 );\r\nbtnHeight=15*fixy;\r\nbtnWidth=35*fixx;\r\nX=120*fixx;\r\nY=500*fixy;\r\nbi = BarIndex();\r\nfbr = Status("firstbarinrange");\r\nexplore = Status("action") == actionExplore;\r\nfvb = IIf(explore, LastValue(ValueWhen(fbr,bi)), Status("firstvisiblebar"));\r\nsym_num = StrCount(tickerlist, ",")+1;\r\nmat = Matrix(sym_num, 2);\r\nrownum = MxGetSize(mat, 0);\r\nlast_bar = BarCount-1;\r\n\tfor ( i = 0; ( symbol = StrExtract(tickerlist, i ) ) != ""; i++ ) {\r\n\t\tfc = Foreign( symbol, "C" ); \r\n\t\tfv = Foreign( symbol, "V" );\r\n\t\tidx = Max(Min(NullCount(fc),last_bar), fvb);\r\n\t\tif (! IsNull(fc[ idx ]) OR ! IsNull(fc[ idx ])) {\r\n\t\t\trelP = ROC(fc,1);\t\t\r\n\t\t\tmat[i][0] = LastValue( relP ); \r\n\t\t\tmat[i][1] = i; \t\t\r\n\t\t}}\r\n\tmat = MxSortRows(mat, False, 0);\r\n\tfor ( i = 0; i &lt; rownum; i++ ) {\r\n\t\t\tval = mat[i][0];\tn = mat[i][1];\r\n\t\tif (! IsNull(val)) {\t\r\n\t\t\tsymbol = StrExtract(tickerlist, n);\r\n\t\t\tfc1 = LastValue(Foreign( symbol, "C" ));\r\n\t\t\tfv1 = LastValue(Foreign( symbol, "V" )/MA(Foreign( symbol, "V" ),20));\r\n\t\t\tfv = LastValue(Foreign( symbol, "V" ));\r\n\t\t\tchg=LastValue(ROC(Foreign( symbol, "C" ),1));\r\n\t\t\ttextname=symbol;\r\n\t\t\tGTGD=LastValue(Foreign( symbol, "C" )*Foreign( symbol, "V" ))/1000000;\r\n\t\t\tGfxSetOverlayMode(0);\r\n\t\t\tGfxSetBkMode(0);\r\n\t\t\tGfxSelectFont( "Arial", 7*fixy*fixx, 700 );\r\n\t\t\t/////////\r\n\t\t\tgiatrichg=IIf(chg&gt;0,chg,-chg);\r\n\t\t\tGfxSelectPen( ColorBlend( colorDarkGrey, colorWhite, 0.7 ), 0 ); // data tooltip round border color\r\n\t\t\tGfxSelectSolidBrush( ColorBlend( IIf(chg&gt;0,colorLime,IIf(chg&lt;0,colorRed,colorYellow)), colorWhite, 0.3 ) );\r\n\t\t\tGfxRoundRect(x+i*btnWidth+btnWidth/4,y+5,x+btnWidth*(i+1)+1-btnWidth/4,y-500/15*giatrichg*fixy, 5, 5 );\r\n\t\t\t///////////\r\n\t\t\tGfxSelectPen( ColorBlend( colorDarkGrey, colorWhite, 0.5 ), 0 ); // data tooltip round border color\r\n\t\t\tGfxSelectSolidBrush( ColorBlend( colorDarkGrey, colorWhite, 0.4 ) );\r\n\t\t\tGfxRoundRect(x+i*btnWidth,y,x+btnWidth*(i+1)+1,y+btnHeight, 5, 5 );\t\r\n\t\t\tGfxSetTextColor( colorWhite );\r\n\t\t\tGfxDrawText(textname,x+i*btnWidth,y, x+btnWidth*(i+1),y+btnHeight, 1);\r\n\t\t\tGfxSelectFont( "Arial", 7*fixy*fixx, 500 );\r\n\t\t\tGfxSetTextColor( colorGrey40 );\r\n\t\t\tGfxDrawText(WriteVal(chg,1.2),x+i*btnWidth,y-500/15*giatrichg*fixy-15*fixy, x+btnWidth*(i+1),y-500/15*giatrichg*fixy, 1);\r\n}}\r\n}\r\nx = Param("x_origin1", 0, 0, 1980, 20);\r\ny = Param("y_origin1", 25, 0, 1980, 20);\r\nGfxSelectPen( colorLightGrey, 0 );\r\nGfxTSI1(x*fixx,y*fixy);\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\tang giam nganh dang cot 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>0</Min>
			<Max>0</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>SectorNganh</Name>
		<Pane>
			<ChartID>1012</ChartID>
			<PercentHeight>100</PercentHeight>
			<Formula>\r\nVnindex=ParamStr("VnIndex","VNINDEX");\r\nTHUCPHAM=ParamStr("THUC PHAM","MSN,TNA,VNM,LSS,QNS,SBT,MCH,VOC,NAF,SCD,SAB,SMB,KDC");\r\nBAOHIEM=ParamStr("BAO HIEM","VNR,ABI,BIC,BMI,MIG,PGI,PVI,BVH");\r\nNGANHANG=ParamStr("NGAN HANG","ACB,BID,CTG,HDB,MBB,SSB,SHB,STB,TCB,TPB,VCB,VIB,VPB,ABB,EIB,BVB,KLB,LPB,MSB,NAB,BAB,NVB,OCB,PGB,SGB,VAB,VBB");\r\nCHUNGKHOAN=ParamStr("CHUNG KHOAN","AGR,ART,BSI,BVS,CTS,FTS,HCM,MBS,SBS,SHS,SSI,TVB,TVS,VCI,VDS,VIX,VND");\r\nBATDONGSAN=ParamStr("BAT DONG SAN","IJC,LDG,NVT,AMD,C21,CEO,D2D,DIG,DRH,DXG,FLC,HAR,HDC,HDG,HLD,HQC,ITC,KDH,NBB,NDN,NLG,NTL,NVL,PDR,QCG,SCR,SJS,TDH,TIG,VIC,VPH,IDV,ITA,KBC,LHG,VC3,LGL");\r\nDAUKHI=ParamStr("DAU KHI","PVB,PVC,PVD,PVS,ASP,CNG,GAS,PGC,PGS,PLX,PVG,PVO");\r\nCANG=ParamStr("CANG","HAH,STG,GMD,PDN,PHP,SGP,VSC");\r\nXAYDUNG=ParamStr("XAY DUNG","C32,C47,CII,CTD,CTI,FCN,HBC,HC3,HTI,HUT,L14,MCG,LCG,PC1,DPG,PHC,PVX,PXS,SD5,SD6,SD9,TCD,UIC,VCG,VMC,VNE,THG,VPD,TV2");\r\nTHEP=ParamStr("THEP","HPG,HSG,NKG,POM,SHA,TIS,TVN,VGS,HMC,SHI,SMC,TLH");\r\nNHUA=ParamStr("NHUA","AAA,BMP,DAG,DNP,NTP,RDP");\r\nTHUYSAN=ParamStr("THUYSAN","ANV,ASM,FMC,HVG,IDI,SSN,VHC");\r\nCAOSU=ParamStr("CAO SU","DPR,DRI,HRC,PHR,TRC,GVR");\r\nCONGNGHE=ParamStr("CONG NGHE","CMG,SGT,ITD,VEC,FPT,ELC,ABC");\r\nDUOCPHAM=ParamStr("DUOC PHAM","DCL,DHG,DHT,IMP,TRA,DVN,DBD,JVC");\r\nHANGKHONG=ParamStr("HANG KHONG","NCT,ACV,HVN,SCS,VJC");\r\nHOACHAT=ParamStr("HOA CHAT","HAI,LTG,TSC,VFG,BFC,DCM,DDV,DPM,LAS,QBS,SFG,CSM,DRC,SRC,CSV,DGC,PLC,LIX,NET");\r\nMAYMAC=ParamStr("MAY MAC","ADS,EVE,FTM,GMC,HTG,KMR,STK,TCM,TNG,TVT,VGG,VGT,MSH");\r\nDIENNUOC=ParamStr("DIEN NUOC","BWE,VCW,DQC,GDT,RAL,CHP,NT2,REE,PPC,SBA,SJD,VSH");\r\nVANTAI=ParamStr("VAN TAI","PVT,GSP,SWC,VIP,VOS,VTO,SKG,SRT,VNS,SAS");\r\nBDSKCN=ParamStr("BDS KCN","SZC,SAL,IDC,TIP,NTC,LHG,D2D,KBC,ITA,BCM");\r\nBANLE=ParamStr("BAN LE","MWG,FPT,FRT,PET,DGW,PIV");\r\nPHANBON=ParamStr("PHAN BON","DPM,DCM,LAS,BFC,DDV");\r\nTHAN=ParamStr("THAN","TDN,TC6,TVD,THT,NBC");\r\nVLXD=ParamStr("VLXD","ACC,BCC,BTS,CTI,DC4,DHA,GMX,HOM,HT1,MVC,NNC,QNS,SCJ,VCS,VGC,KSB");\r\nDAUTUCONG=ParamStr("DAU TU CONG","FCN,KSB,PLC,BCC,HT1,DHA,LCG,C4G,C32");\r\n\r\n\r\n//===================== * SECTOR VN- Vnindex * ===============================\r\n\r\n_SECTION_BEGIN("VN- Vnindex ");\r\n\r\nNo=0;\r\niclose1=0;\r\nichange1=0;\r\nfor( i = 0; ( sym1 = StrExtract(Vnindex,i ) ) != ""; i++ )\r\n{\r\niclose1+=Foreign(sym1,"Close");\r\nnum1=1+StrCount(Vnindex,",");\r\ntb1=iclose1/num1;\r\nichange1+=ROC(Foreign(sym1,"Close"),1)/num1;\r\nNo++;\r\n};\r\n\r\n\r\n\r\n_SECTION_END();\r\n\r\n//===================== * SECTOR VN- THUCPHAM * ==============================\r\n\r\n_SECTION_BEGIN("THUCPHAM ");\r\nNo=0;\r\niclose2=0;\r\nichange2=0;\r\nfor( i = 0; ( sym2 = StrExtract(THUCPHAM,i ) ) != ""; i++ )\r\n{\r\niclose2+=Foreign(sym2,"Close");\r\nnum2=1+StrCount(THUCPHAM,",");\r\ntb2=iclose2/num2;\r\nichange2+=ROC(Foreign(sym2,"Close"),1)/num2;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR VN- BAO.HIEM * ==============================\r\n\r\n_SECTION_BEGIN("VN- BAOHIEM ");\r\nNo=0;\r\niclose3=0;\r\nichange3=0;\r\nfor( i = 0; ( sym3 = StrExtract(BAOHIEM,i ) ) != ""; i++ )\r\n{\r\niclose3+=Foreign(sym3,"Close");\r\nnum3=1+StrCount(BAOHIEM,",");\r\ntb3=iclose3/num3;\r\nichange3+=ROC(Foreign(sym3,"Close"),1)/num3;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n//===================== * SECTOR NGANHANG * ==============================\r\n\r\n_SECTION_BEGIN("NGANHANG");\r\nNo=0;\r\niclose4=0;\r\nichange4=0;\r\nfor( i = 0; ( sym4 = StrExtract( NGANHANG, i ) ) != ""; i++ )\r\n{\r\niclose4+=Foreign(sym4,"Close");\r\nnum4=1+StrCount(NGANHANG,",");\r\ntb4=iclose4/num4;\r\nichange4+=ROC(Foreign(sym4,"Close"),1)/num4;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n//===================== * SECTOR VN- CHUNGKHOAN * ==============================\r\n\r\n_SECTION_BEGIN("CHUNGKHOAN ");\r\nNo=0;\r\niclose5=0;\r\nichange5=0;\r\nfor( i = 0; ( sym5 = StrExtract(CHUNGKHOAN, i ) ) != ""; i++ )\r\n{\r\niclose5+=Foreign(sym5,"Close");\r\nnum5=1+StrCount(CHUNGKHOAN,",");\r\ntb5=iclose5/num5;\r\nichange5+=ROC(Foreign(sym5,"Close"),1)/num5;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n\r\n//===================== * SECTOR VN-BATDONGSAN* ==============================\r\n_SECTION_BEGIN("VN-BATDONGSAN");\r\nNo=0;\r\niclose6=0;\r\nichange6=0;\r\nfor( i = 0; ( sym6 = StrExtract(BATDONGSAN, i ) ) != ""; i++ )\r\n{\r\niclose6+=Foreign(sym6,"Close");\r\nnum6=1+StrCount(BATDONGSAN,",");\r\ntb6=iclose6/num6;\r\nichange6+=ROC(Foreign(sym6,"Close"),1)/num6;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n\r\n//===================== * SECTOR VN- DAUKHI * ==============================\r\n\r\n_SECTION_BEGIN("DAUKHI ");\r\nNo=0;\r\niclose7=0;\r\nichange7=0;\r\nfor( i = 0; ( sym7 = StrExtract(DAUKHI, i ) ) != ""; i++ )\r\n{\r\niclose7+=Foreign(sym7,"Close");\r\nnum7=1+StrCount(DAUKHI,",");\r\ntb7=iclose7/num7;\r\nichange7+=ROC(Foreign(sym7,"Close"),1)/num7;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n//===================== * SECTOR VN- CANG * ==============================\r\n\r\n_SECTION_BEGIN("VN- CANG ");\r\nNo=0;\r\niclose8=0;\r\nichange8=0;\r\nfor( i = 0; ( sym8 = StrExtract(CANG, i ) ) != ""; i++ )\r\n{\r\niclose8+=Foreign(sym8,"Close");\r\nnum8=1+StrCount(CANG,",");\r\ntb8=iclose8/num8;\r\nichange8+=ROC(Foreign(sym8,"Close"),1)/num8;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR VN- XAY DUNG * ==============================\r\n\r\n_SECTION_BEGIN("VN- XAYDUNG ");\r\nNo=0;\r\niclose9=0;\r\nichange9=0;\r\nfor( i = 0; ( sym9 = StrExtract(XAYDUNG, i ) ) != ""; i++ )\r\n{\r\niclose9+=Foreign(sym9,"Close");\r\nnum9=1+StrCount(XAYDUNG,",");\r\ntb9=iclose9/num9;\r\nichange9+=ROC(Foreign(sym9,"Close"),1)/num9;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n//===================== * SECTOR VN- THEP * ==============================\r\n\r\n_SECTION_BEGIN("VN-THEP");\r\nNo=0;\r\niclose10=0;\r\nichange10=0;\r\nfor( i = 0; ( sym10 = StrExtract(THEP, i ) ) != ""; i++ )\r\n{\r\niclose10+=Foreign(sym10,"Close");\r\nnum10=1+StrCount(THEP,",");\r\ntb10=iclose10/num10;\r\nichange10+=ROC(Foreign(sym10,"Close"),1)/num10;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n//===================== * SECTOR VN- NHUA * ==============================\r\n\r\n_SECTION_BEGIN("VN-NHUA");\r\nNo=0;\r\niclose11=0;\r\nichange11=0;\r\nfor( i = 0; ( sym11 = StrExtract(NHUA, i ) ) != ""; i++ )\r\n{\r\niclose11+=Foreign(sym11,"Close");\r\nnum11=1+StrCount(NHUA,",");\r\ntb11=iclose11/num11;\r\nichange11+=ROC(Foreign(sym11,"Close"),1)/num11;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n\r\n//===================== * SECTOR VN-VATLIEUXAYDUNG * ==============================\r\n\r\n_SECTION_BEGIN("VN- THUYSAN ");\r\nNo=0;\r\niclose12=0;\r\nichange12=0;\r\nfor( i = 0; ( sym12 = StrExtract(THUYSAN, i ) ) != ""; i++ )\r\n{\r\niclose12+=Foreign(sym12,"Close");\r\nnum12=1+StrCount(THUYSAN,",");\r\ntb12=iclose12/num12;\r\nichange12+=ROC(Foreign(sym12,"Close"),1)/num12;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n//===================== * SECTOR VN-CAOSU * ==============================\r\n\r\n_SECTION_BEGIN("VN-CAOSU");\r\nNo=0;\r\niclose13=0;\r\nichange13=0;\r\nfor( i = 0; ( sym13 = StrExtract( CAOSU, i ) ) != ""; i++ )\r\n{\r\niclose13+=Foreign(sym13,"Close");\r\nnum13=1+StrCount(CAOSU,",");\r\ntb13=iclose13/num13;\r\nichange13+=ROC(Foreign(sym13,"Close"),1)/num13;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR VN-CONGNGHE * ==============================\r\n\r\n_SECTION_BEGIN("VN-CONGNGHE");\r\nNo=0;\r\niclose14=0;\r\nichange14=0;\r\nfor( i = 0; ( sym14 = StrExtract( CONGNGHE, i ) ) != ""; i++ )\r\n{\r\niclose14+=Foreign(sym14,"Close");\r\nnum14=1+StrCount(CONGNGHE,",");\r\ntb14=iclose14/num14;\r\nichange14+=ROC(Foreign(sym14,"Close"),1)/num14;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR VN-DUOCPHAM * ==============================\r\n\r\n_SECTION_BEGIN("VN-DUOCPHAM");\r\nNo=0;\r\niclose15=0;\r\nichange15=0;\r\nfor( i = 0; ( sym15 = StrExtract( DUOCPHAM, i ) ) != ""; i++ )\r\n{\r\niclose15+=Foreign(sym15,"Close");\r\nnum15=1+StrCount(DUOCPHAM,",");\r\ntb15=iclose15/num15;\r\nichange15+=ROC(Foreign(sym15,"Close"),1)/num15;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR VN-HANGKHONG * ==============================\r\n\r\n_SECTION_BEGIN("VN-HANGKHONG");\r\nNo=0;\r\niclose16=0;\r\nichange16=0;\r\nfor( i = 0; ( sym16 = StrExtract( HANGKHONG, i ) ) != ""; i++ )\r\n{\r\niclose16+=Foreign(sym16,"Close");\r\nnum16=1+StrCount(HANGKHONG,",");\r\ntb16=iclose16/num16;\r\nichange16+=ROC(Foreign(sym16,"Close"),1)/num16;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR VN-HOACHAT* ==============================\r\n\r\n_SECTION_BEGIN("VN-HOACHAT");\r\nNo=0;\r\niclose17=0;\r\nichange17=0;\r\nfor( i = 0; ( sym17 = StrExtract( HOACHAT, i ) ) != ""; i++ )\r\n{\r\niclose17+=Foreign(sym17,"Close");\r\nnum17=1+StrCount(HOACHAT,",");\r\ntb17=iclose17/num17;\r\nichange17+=ROC(Foreign(sym17,"Close"),1)/num17;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n//===================== * SECTOR VN-MAYMAC * ==============================\r\n\r\n_SECTION_BEGIN("VN-MAYMAC");\r\nNo=0;\r\niclose18=0;\r\nichange18=0;\r\nfor( i = 0; ( sym18 = StrExtract( MAYMAC, i ) ) != ""; i++ )\r\n{\r\niclose18+=Foreign(sym18,"Close");\r\nnum18=1+StrCount(MAYMAC,",");\r\ntb18=iclose18/num18;\r\nichange18+=ROC(Foreign(sym18,"Close"),1)/num18;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR VN-DIENNUOC * ==============================\r\n\r\n_SECTION_BEGIN("VN-DIENNUOC");\r\nNo=0;\r\niclose19=0;\r\nichange19=0;\r\nfor( i = 0; ( sym19 = StrExtract( DIENNUOC, i ) ) != ""; i++ )\r\n{\r\niclose19+=Foreign(sym19,"Close");\r\nnum19=1+StrCount(DIENNUOC,",");\r\ntb19=iclose19/num19;\r\nichange19+=ROC(Foreign(sym19,"Close"),1)/num19;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n//===================== * SECTOR VN-VANTAI * ==============================\r\n\r\n_SECTION_BEGIN("VN-VANTAI");\r\nNo=0;\r\niclose20=0;\r\nichange20=0;\r\nfor( i = 0; ( sym20 = StrExtract( VANTAI, i ) ) != ""; i++ )\r\n{\r\niclose20+=Foreign(sym20,"Close");\r\nnum20=1+StrCount(VANTAI,",");\r\ntb20=iclose20/num20;\r\nichange20+=ROC(Foreign(sym20,"Close"),1)/num20;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n//===================== * SECTOR BDS KCN * ==============================\r\n\r\n_SECTION_BEGIN("BDS KCN");\r\nNo=0;\r\niclose21=0;\r\nichange21=0;\r\nfor( i = 0; ( sym21 = StrExtract( BDSKCN, i ) ) != ""; i++ )\r\n{\r\niclose21+=Foreign(sym21,"Close");\r\nnum21=1+StrCount(BDSKCN,",");\r\ntb21=iclose21/num21;\r\nichange21+=ROC(Foreign(sym21,"Close"),1)/num21;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR BAN LE * ==============================\r\n\r\n_SECTION_BEGIN("BAN LE");\r\nNo=0;\r\niclose22=0;\r\nichange22=0;\r\nfor( i = 0; ( sym22 = StrExtract( BANLE, i ) ) != ""; i++ )\r\n{\r\niclose22+=Foreign(sym22,"Close");\r\nnum22=1+StrCount(BANLE,",");\r\ntb22=iclose22/num22;\r\nichange22+=ROC(Foreign(sym22,"Close"),1)/num22;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR PHAN BON * ==============================\r\n\r\n_SECTION_BEGIN("PHAN BON");\r\nNo=0;\r\niclose23=0;\r\nichange23=0;\r\nfor( i = 0; ( sym23 = StrExtract( PHANBON, i ) ) != ""; i++ )\r\n{\r\niclose23+=Foreign(sym23,"Close");\r\nnum23=1+StrCount(PHANBON,",");\r\ntb23=iclose23/num23;\r\nichange23+=ROC(Foreign(sym23,"Close"),1)/num23;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR THAN * ==============================\r\n\r\n_SECTION_BEGIN("THAN");\r\nNo=0;\r\niclose24=0;\r\nichange24=0;\r\nfor( i = 0; ( sym24 = StrExtract( THAN, i ) ) != ""; i++ )\r\n{\r\niclose24+=Foreign(sym24,"Close");\r\nnum24=1+StrCount(THAN,",");\r\ntb24=iclose24/num24;\r\nichange24+=ROC(Foreign(sym24,"Close"),1)/num23;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR VLXD * ==============================\r\n\r\n_SECTION_BEGIN("VLXD");\r\nNo=0;\r\niclose25=0;\r\nichange25=0;\r\nfor( i = 0; ( sym25 = StrExtract( VLXD, i ) ) != ""; i++ )\r\n{\r\niclose25+=Foreign(sym25,"Close");\r\nnum25=1+StrCount(VLXD,",");\r\ntb25=iclose25/num25;\r\nichange25+=ROC(Foreign(sym25,"Close"),1)/num24;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n//===================== * SECTOR DAU TU CONG * ==============================\r\n\r\n_SECTION_BEGIN("DAUTUCONG");\r\nNo=0;\r\niclose26=0;\r\nichange26=0;\r\nfor( i = 0; ( sym26 = StrExtract( DAUTUCONG, i ) ) != ""; i++ )\r\n{\r\niclose26+=Foreign(sym26,"Close");\r\nnum26=1+StrCount(DAUTUCONG,",");\r\ntb26=iclose26/num26;\r\nichange26+=ROC(Foreign(sym26,"Close"),1)/num24;\r\nNo++;\r\n}\r\n_SECTION_END();\r\n\r\n\r\n\r\n_SECTION_END();\r\n\r\nColor1=Param("colortext1:",colorDarkBlue);\r\nColor2=Param("colortext2:",colorDarkGreen);\r\nColor3 = ParamColor("Color3", colorBrown );\r\nColor4 = ParamColor("Color4", colorPink );\r\nColor5 = ParamColor("Color5", colorCustom1 );\r\nColor6 = ParamColor("Color6", colorCustom9 );\r\nColor7 = ParamColor("Color7", colorOrange );\r\nColor8 = ParamColor("Color8", colorGold );\r\nColor9 = ParamColor("Color9", colorTan );\r\nColor10 = ParamColor("Color10", colorCustom11 );\r\nColor11 = ParamColor("Color11", colorTeal );\r\nColor12 = ParamColor("Color12", colorCustom5 );\r\nColor13 = ParamColor("Color13", colorCustom13 );\r\nColor14 = ParamColor("Color14", colorPaleGreen );\r\nColor15 = ParamColor("Color15", colorCustom4 );\r\nColor16 = ParamColor("Color16", colorCustom12 );\r\nColor17 = ParamColor("Color17", colorBlue );\r\nColor18 = ParamColor("Color18", colorDarkRed );\r\nColor19 = ParamColor("Color19", colorIndigo );\r\nColor20 = ParamColor("Color20", colorViolet );\r\nColor21 = ParamColor("Color21", colorDarkGrey );\r\nColor22 = ParamColor("Color22", colorLightOrange );\r\nColor23 = ParamColor("Color23", colorWhite );\r\nColor24 = ParamColor("Color24", colorSkyblue );\r\nColor25 = ParamColor("Color25", colorAqua );\r\nColor26 = ParamColor("Color26", colorTurquoise );\r\nColor27 = ParamColor("Color27", colorLime );\r\nColor28 = ParamColor("Color28", colorRose );\r\n\r\n\r\n\r\n    //Set Variables\r\n    barvisible = Status("barvisible");\r\n    FVB = barvisible AND NOT Ref( barvisible, -1 );\r\n    CVB = ValueWhen( FVB,C) ;\r\n    Leftbar=ValueWhen(Ref(barvisible,-1)==0 AND barvisible,DateTime() );\r\n    Rightbar=LastValue(DateTime() );\r\n    DateSpan = EndValue(BarIndex()) - BeginValue(BarIndex());\r\n    Range = DateSpan ;\r\n    StartDate = BeginValue(BarIndex());\r\n    EndDate = EndValue(BarIndex());\r\n\r\nt1=100*(tb1-ValueWhen(fvb,tb1))/ValueWhen(fvb,tb1);\r\nt2=100*(tb2-ValueWhen(fvb,tb2))/ValueWhen(fvb,tb2);\r\nt3=100*(tb3-ValueWhen(fvb,tb3))/ValueWhen(fvb,tb3);\r\nt4=100*(tb4-ValueWhen(fvb,tb4))/ValueWhen(fvb,tb4);\r\nt5=100*(tb5-ValueWhen(fvb,tb5))/ValueWhen(fvb,tb5);\r\nt6=100*(tb6-ValueWhen(fvb,tb6))/ValueWhen(fvb,tb6);\r\nt7=100*(tb7-ValueWhen(fvb,tb7))/ValueWhen(fvb,tb7);\r\nt8=100*(tb8-ValueWhen(fvb,tb8))/ValueWhen(fvb,tb8);\r\nt9=100*(tb9-ValueWhen(fvb,tb9))/ValueWhen(fvb,tb9);\r\nt10=100*(tb10-ValueWhen(fvb,tb10))/ValueWhen(fvb,tb10);\r\nt11=100*(tb11-ValueWhen(fvb,tb11))/ValueWhen(fvb,tb11);\r\nt12=100*(tb12-ValueWhen(fvb,tb12))/ValueWhen(fvb,tb12);\r\nt13=100*(tb13-ValueWhen(fvb,tb13))/ValueWhen(fvb,tb13);\r\nt14=100*(tb14-ValueWhen(fvb,tb14))/ValueWhen(fvb,tb14);\r\nt15=100*(tb15-ValueWhen(fvb,tb15))/ValueWhen(fvb,tb15);\r\nt16=100*(tb16-ValueWhen(fvb,tb16))/ValueWhen(fvb,tb16);\r\nt17=100*(tb17-ValueWhen(fvb,tb17))/ValueWhen(fvb,tb17);\r\nt18=100*(tb18-ValueWhen(fvb,tb18))/ValueWhen(fvb,tb18);\r\nt19=100*(tb19-ValueWhen(fvb,tb19))/ValueWhen(fvb,tb19);\r\nt20=100*(tb20-ValueWhen(fvb,tb20))/ValueWhen(fvb,tb20);\r\nt21=100*(tb21-ValueWhen(fvb,tb21))/ValueWhen(fvb,tb21);\r\nt22=100*(tb22-ValueWhen(fvb,tb22))/ValueWhen(fvb,tb22);\r\nt23=100*(tb23-ValueWhen(fvb,tb23))/ValueWhen(fvb,tb23);\r\nt24=100*(tb24-ValueWhen(fvb,tb24))/ValueWhen(fvb,tb24);\r\nt25=100*(tb25-ValueWhen(fvb,tb25))/ValueWhen(fvb,tb25);\r\nt26=100*(tb26-ValueWhen(fvb,tb26))/ValueWhen(fvb,tb26);\r\n\r\n\r\n\r\n\r\n//----------Ve chart------------------//\r\n//Plot(t1,"VnIndex",color3,ParamStyle("Style3",styleLine));\r\n_SECTION_BEGIN("Hien thi Index");\r\n\r\nif (ParamToggle( "VNIndex",  "OFF|ON", 1 ))\r\n{\r\nPlot(t1,"VnIndex",color3,ParamStyle("Style3",styleLine|styleThick));\r\ny = LastValue( t1 );\r\nPlotText( "VNIndex", BarCount+ 1 , y,color3);\r\n}\r\nif (ParamToggle( "Thuc Pham",  "OFF|ON", 0 ))\r\n{\r\nPlot(t2,"THUC PHAM",color4,ParamStyle("Style4",styleLine|styleThick));\r\ny = LastValue( t2 );\r\nPlotText( "thuc pham", BarCount+ 1 , y,color4);\r\n}\r\nif (ParamToggle( "Bao Hiem",  "OFF|ON", 1 ))\r\n{\r\nPlot(t3,"BAO HIEM",color5,ParamStyle("Style5",styleLine|styleThick));\r\ny = LastValue( t3 );\r\nPlotText( "bao hiem", BarCount+ 1 , y,color5);\r\n}\r\nif (ParamToggle( "Ngan Hang",  "OFF|ON", 1 ))\r\n{\r\nPlot(t4,"NGAN HANG",color6,ParamStyle("Style6",styleLine|styleThick));\r\ny = LastValue( t4 );\r\nPlotText( "ngan hang", BarCount+ 1 , y,color6);\r\n}\r\nif (ParamToggle( "Chung Khoan",  "OFF|ON", 1 ))\r\n{\r\nPlot(t5,"CHUNG KHOAN",color7,ParamStyle("Style7",styleLine|styleThick));\r\ny = LastValue( t5 );\r\nPlotText( "chung khoan", BarCount+ 1 , y,color7);\r\n}\r\nif (ParamToggle( "BDS",  "OFF|ON", 1 ))\r\n{\r\nPlot(t6,"BAT DONG SAN",color8,ParamStyle("Style8",styleLine|styleThick));\r\ny = LastValue( t6 );\r\nPlotText( "bat dong san", BarCount+ 1 , y,color8);\r\n}\r\nif (ParamToggle( "Dau Khi",  "OFF|ON", 1 ))\r\n{\r\nPlot(t7,"DAU KHI",color9,ParamStyle("Style9",styleLine|styleThick));\r\ny = LastValue( t7 );\r\nPlotText( "dau khi", BarCount+ 1 , y,color9);\r\n}\r\nif (ParamToggle( "Cang",  "OFF|ON", 0 ))\r\n{\r\nPlot(t8,"CANG",color10,ParamStyle("Style10",styleLine|styleThick));\r\ny = LastValue( t8 );\r\nPlotText( "cang", BarCount+ 1 , y,color10);\r\n}\r\nif (ParamToggle( "Xay Dung",  "OFF|ON", 0 ))\r\n{\r\nPlot(t9,"XAY DUNG",color11,ParamStyle("Style11",styleLine|styleThick));\r\ny = LastValue( t9 );\r\nPlotText( "xay dung", BarCount+ 1 , y,color11);\r\n}\r\nif (ParamToggle( "Thep",  "OFF|ON", 1 ))\r\n{\r\nPlot(t10,"THEP",color12,ParamStyle("Style12",styleLine|styleThick));\r\ny = LastValue( t10 );\r\nPlotText( "thep", BarCount+ 1 , y,color12);\r\n}\r\nif (ParamToggle( "Nhua",  "OFF|ON", 0 ))\r\n{\r\nPlot(t11,"NHUA",color13,ParamStyle("Style13",styleLine|styleThick));\r\ny = LastValue( t11 );\r\nPlotText( "nhua", BarCount+ 1 , y,color13);\r\n}\r\nif (ParamToggle( "Thuy San",  "OFF|ON", 0 ))\r\n{\r\nPlot(t12,"THUY SAN",color14,ParamStyle("Style14",styleLine|styleThick));\r\ny = LastValue( t12 );\r\nPlotText( "thuy san", BarCount+ 1 , y,color14);\r\n}\r\nif (ParamToggle( "Cao Su",  "OFF|ON", 0 ))\r\n{\r\nPlot(t13,"CAO SU",color15,ParamStyle("Style15",styleLine|styleThick));\r\ny = LastValue( t13 );\r\nPlotText( "cao su", BarCount+ 1 , y,color15);\r\n}\r\nif (ParamToggle( "Cong Nghe",  "OFF|ON", 0 ))\r\n{\r\nPlot(t14,"CONG NGHE",color16,ParamStyle("Style16",styleLine|styleThick));\r\ny = LastValue( t14 );\r\nPlotText( "cong nghe", BarCount+ 1 , y,color16);\r\n}\r\nif (ParamToggle( "Duoc Pham",  "OFF|ON", 0 ))\r\n{\r\nPlot(t15,"DUOC PHAM",color17,ParamStyle("Style17",styleLine|styleThick));\r\ny = LastValue( t15 );\r\nPlotText( "duoc pham", BarCount+ 1 , y,color17);\r\n}\r\nif (ParamToggle( "Hang Khong",  "OFF|ON", 0 ))\r\n{\r\nPlot(t16,"HANG KHONG",color18,ParamStyle("Style18",styleLine|styleThick));\r\ny = LastValue( t16 );\r\nPlotText( "hang khong", BarCount+ 1 , y,color18);\r\n}\r\nif (ParamToggle( "Hoa Chat",  "OFF|ON", 1 ))\r\n{\r\nPlot(t17,"HOA CHAT",color19,ParamStyle("Style19",styleLine|styleThick));\r\ny = LastValue( t17 );\r\nPlotText( "hoa chat", BarCount+ 1 , y,color19);\r\n}\r\nif (ParamToggle( "May Mac",  "OFF|ON", 0 ))\r\n{\r\nPlot(t18,"MAY MAC",color20,ParamStyle("Style20",styleLine|styleThick));\r\ny = LastValue( t18 );\r\nPlotText( "may mac", BarCount+ 1 , y,color20);\r\n}\r\nif (ParamToggle( "Dien Nuoc",  "OFF|ON", 1 ))\r\n{\r\nPlot(t19,"DIEN NUOC",color21,ParamStyle("Style21",styleLine|styleThick));\r\ny = LastValue( t19 );\r\nPlotText( "dien nuoc", BarCount+ 1 , y,color21);\r\n}\r\nif (ParamToggle( "Van Tai",  "OFF|ON", 0 ))\r\n{\r\nPlot(t20,"VAN TAI",color22,ParamStyle("Style22",styleLine|styleThick));\r\ny = LastValue( t20 );\r\nPlotText( "van tai", BarCount+ 1 , y,color22);\r\n}\r\nif (ParamToggle( "BDS KCN",  "OFF|ON", 0 ))\r\n{\r\nPlot(t21,"BDS KCN",color23,ParamStyle("Style23",styleLine|styleThick));\r\ny = LastValue( t21 );\r\nPlotText( "bds kcn", BarCount+ 1 , y,color23);\r\n}\r\nif (ParamToggle( "Ban Le",  "OFF|ON", 1 ))\r\n{\r\nPlot(t22,"BAN LE",color24,ParamStyle("Style24",styleLine|styleThick));\r\ny = LastValue( t22 );\r\nPlotText( "ban le", BarCount+ 1 , y,color24);\r\n}\r\nif (ParamToggle( "Phan Bon",  "OFF|ON", 1 ))\r\n{\r\nPlot(t23,"PHAN BON",color25,ParamStyle("Style25",styleLine|styleThick));\r\ny = LastValue( t23 );\r\nPlotText( "phan bon", BarCount+ 1 , y,color25);\r\n}\r\nif (ParamToggle( "Than",  "OFF|ON", 0 ))\r\n{\r\nPlot(t24,"THAN",color26,ParamStyle("Style26",styleLine|styleThick));\r\ny = LastValue( t24 );\r\nPlotText( "than", BarCount+ 1 , y,color26);\r\n}\r\nif (ParamToggle( "VLXD",  "OFF|ON", 0 ))\r\n{\r\nPlot(t25,"VLXD",color27,ParamStyle("Style27",styleLine|styleThick));\r\ny = LastValue( t25 );\r\nPlotText( "vlxd", BarCount+ 1 , y,color27);\r\n}\r\nif (ParamToggle( "Dau Tu Cong",  "OFF|ON", 0 ))\r\n{\r\nPlot(t26,"DAU TU CONG",color28,ParamStyle("Style28",styleLine|styleThick));\r\ny = LastValue( t26 );\r\nPlotText( "dau tu cong", BarCount+ 1 , y,color28);\r\n}\r\n_SECTION_END();\r\n\r\n\r\nTitle="     VNINDEX:                  " +WriteIf(t1&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t1,1.1)+"%]   "+" "+WriteIf(ichange1&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange1,1.1)+"%"+ \r\n"\\n"+ EncodeColor(color4)+"  [1] THUC PHAM :          " +WriteIf(t2&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t2,1.1)+"%]   "+" "+WriteIf(ichange2&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange2,1.1)+"%"+\r\n"\\n"+ EncodeColor(color5)+"  [2] BAO HIEM :              " +WriteIf(t3&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t3,1.1)+"%]   "+" "+WriteIf(ichange3&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange3,1.1)+"%"+\r\n"\\n"+ EncodeColor(color6)+"  [3] NGAN HANG :          "+WriteIf(t4&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t4,1.1)+"%]   "+" "+WriteIf(ichange6&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange4,1.1)+"%"+\r\n"\\n"+ EncodeColor(color7)+"  [4] CHUNG KHOAN :    "+WriteIf(t5&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t5,1.1)+"%]   "+" "+WriteIf(ichange5&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange5,1.1)+"%"+\r\n"\\n"+ EncodeColor(color8)+"  [5] BAT DONG SAN :   "+WriteIf(t6&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t6,1.1)+"%]   "+" "+WriteIf(ichange6&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange6,1.1)+"%"+\r\n"\\n"+ EncodeColor(color9)+"  [6] DAU KHI :                "+WriteIf(t7&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t7,1.1)+"%]   "+" "+WriteIf(ichange7&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange7,1.1)+"%"+\r\n"\\n"+EncodeColor(color10)+"  [7] CANG :                    "+WriteIf(t8&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t8,1.1)+"%]   "+" "+WriteIf(ichange8&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange8,1.1)+"%"+\r\n"\\n"+EncodeColor(color11)+"  [8] XAYDUNG :             "+WriteIf(t9&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t9,1.1)+"%]   "+" "+WriteIf(ichange9&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange9,1.1)+"%"+\r\n"\\n"+EncodeColor(color12)+"  [9] THEP :                    "+WriteIf(t1&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t10,1.1)+"%]   "+" "+WriteIf(ichange10&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange10,1.1)+"%"+\r\n"\\n"+EncodeColor(color13)+"[10] NHUA :                    "+WriteIf(t11&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t11,1.1)+"%]   "+" "+WriteIf(ichange11&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange11,1.1)+"%"+\r\n"\\n"+EncodeColor(color14)+"[11] THUY SAN :            "+WriteIf(t12&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t12,1.1)+"%]   "+" "+WriteIf(ichange12&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange12,1.1)+"%"+\r\n"\\n"+EncodeColor(color15)+"[12] CAO SU :               "+WriteIf(t13&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t13,1.1)+"%]   "+" "+WriteIf(ichange13&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange13,1.1)+"%"+\r\n"\\n"+EncodeColor(color16)+"[13] CONG NGHE :       "+WriteIf(t14&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t14,1.1)+"%]   "+" "+WriteIf(ichange14&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange14,1.1)+"%"+\r\n"\\n"+EncodeColor(color17)+"[14] DUOC PHAM :       "+WriteIf(t15&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t15,1.1)+"%]   "+" "+WriteIf(ichange15&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange15,1.1)+"%"+\r\n"\\n"+EncodeColor(color18)+"[15] HANG KHONG :   "+WriteIf(t16&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t16,1.1)+"%]   "+" "+WriteIf(ichange16&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange16,1.1)+"%"+\r\n"\\n"+EncodeColor(color19)+"[16] HOA CHAT :          "+WriteIf(t17&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t17,1.1)+"%]   "+" "+WriteIf(ichange17&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange17,1.1)+"%"+\r\n"\\n"+EncodeColor(color20)+"[17] MAY MAC :            "+WriteIf(t18&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t18,1.1)+"%]   "+" "+WriteIf(ichange18&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange18,1.1)+"%"+\r\n"\\n"+EncodeColor(color21)+"[18] DIEN NUOC :        "+WriteIf(t19&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t19,1.1)+"%]   "+" "+WriteIf(ichange19&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange19,1.1)+"%"+\r\n"\\n"+EncodeColor(color22)+"[19] VAN TAI  :              "+WriteIf(t20&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t20,1.1)+"%]   "+" "+WriteIf(ichange20&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange20,1.1)+"%"+\r\n"\\n"+EncodeColor(color23)+"[20] BDS KCN  :              "+WriteIf(t21&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t21,1.1)+"%]   "+" "+WriteIf(ichange21&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange21,1.1)+"%"+\r\n"\\n"+EncodeColor(color24)+"[21] BAN LE  :              "+WriteIf(t22&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t22,1.1)+"%]   "+" "+WriteIf(ichange22&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange22,1.1)+"%"+\r\n"\\n"+EncodeColor(color25)+"[22] PHAN BON  :              "+WriteIf(t23&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t23,1.1)+"%]   "+" "+WriteIf(ichange23&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange23,1.1)+"%"+\r\n"\\n"+EncodeColor(color26)+"[23] THAN  :              "+WriteIf(t24&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t24,1.1)+"%]   "+" "+WriteIf(ichange24&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange24,1.1)+"%"+\r\n"\\n"+EncodeColor(color27)+"[24] VLXD  :              "+WriteIf(t25&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t25,1.1)+"%]   "+" "+WriteIf(ichange25&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange25,1.1)+"%"+\r\n"\\n"+EncodeColor(color28)+"[25] DAU TU CONG  :              "+WriteIf(t26&lt;0,EncodeColor(colorRed)+" [",EncodeColor(colorGreen)+" [+")+WriteVal(t26,1.1)+"%]   "+" "+WriteIf(ichange26&lt;0,EncodeColor(colorRed),EncodeColor(colorGreen)+"+")+WriteVal(ichange26,1.1)+"%";\r\n\r\n\r\n\r\n_SECTION_BEGIN("Graphics");\r\nGrpPrm=Param("Graphic Space",5,-20,20);\r\nGraphXSpace=GrpPrm;\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Sector performance 2.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-18.2793</Min>
			<Max>13.4609</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>Sector</Name>
		<Pane>
			<ChartID>1023</ChartID>
			<PercentHeight>100</PercentHeight>
			<Formula>// Downloaded From https://kakata.vn\r\n_SECTION_BEGIN("Sector Comparing - Kakata.vn");\r\nTitle = GetFnData( "Alias" ) + " - " + StrFormat("KAKATA.VN - Youtube.com/c/KakataChungKhoan, {{FULLNAME}} - {{INTERVAL}}: {{DATE}}, Open %g, Hi %g, Lo %g, Close %g (%.1f%%), Vol(mil) %.2f (%.0f%%) {{VALUES}}", O, H, L, C, SelectedValue( ROC( C, 1 ) ),  V / 1000000, SelectedValue( ROC( V, 1 ) ) ); \r\nGfxSetOverlayMode(1);\r\nGfxSelectFont("Tahoma", Status("pxheight")/32 );\r\nGfxSetTextAlign(6 );// center alignment\r\nGfxSetTextColor( ParamColor( "Warna", colorLightGrey ) );\r\nGfxSetBkMode(0); // transparent\r\nGfxTextOut( "Youtube: Kakata Chung Khoan", Status("pxwidth")/2, Status("pxheight")/20 );\r\n\r\nCl0=colorLightOrange;\r\nCl1=colorPink;\r\nCl2=colorOrange;\r\nCl3=colorGreen ;\r\nCl4=colorTurquoise;\r\nCl5=colorLime;\r\nCl6=colorBlueGrey;\r\nCl7=colorYellow;\r\nCl8=colorBrightGreen;\r\nCl9=colorRed;\r\nC20=colorDarkBlue;\r\nC21=colorTan;\r\nC22=colorDarkYellow;\r\nC23=colorViolet ;\r\nC24=colorBlack;\r\nC25=colorAqua;\r\nC26=colorBrown;\r\nC27=colorDarkTeal;\r\nC28=colorGold;\r\nC29=colorSkyblue;\r\n\r\n\r\n//Set Variables\r\nbarvisible = Status("barvisible");\r\nFVB = barvisible AND NOT Ref( barvisible, -1 );\r\nCVB = ValueWhen(  FVB,C) ;\r\nLeftbar=ValueWhen(Ref(barvisible,-1)==0 AND barvisible,DateTime() );\r\nRightbar=LastValue(DateTime() );\r\nDateSpan = EndValue(BarIndex()) - BeginValue(BarIndex());\r\nRange = DateSpan ;\r\nStartDate = BeginValue(BarIndex());\r\nEndDate = EndValue(BarIndex());\r\n\r\n//Select Tickers\r\nFn0=ParamStr( "Fund0", "HPG");\r\nFn1=ParamStr( "Fund1", "HSG");\r\nFn2=ParamStr( "Fund2", "NKG");\r\nFn3=ParamStr( "Fund3", "SMC");\r\nFn4=ParamStr( "Fund4", "TLH");\r\nFn5=ParamStr( "Fund5", "POM");\r\nFn6=ParamStr( "Fund6", "TVN");\r\nFn7=ParamStr( "Fund7", "");\r\nFn8=ParamStr( "Fund8", "");\r\nFn9=ParamStr( "Fund9", "");\r\nFn10=ParamStr( "Fund10", "");\r\nFn11=ParamStr( "Fund11", "");\r\nFn12=ParamStr( "Fund12", "");\r\nFn13=ParamStr( "Fund13", "");\r\nFn14=ParamStr( "Fund14", "");\r\nFn15=ParamStr( "Fund15", "");\r\nFn16=ParamStr( "Fund16", "");\r\nFn17=ParamStr( "Fund17", "");\r\nFn18=ParamStr( "Fund18", "");\r\nFn19=ParamStr( "Fund19", "");\r\n\r\n\r\n//Normalized to left edge\r\nFa0=Prec(100*(Foreign(Fn0,"C")/ValueWhen(FVB,Foreign(Fn0,"C"))-1),2.2);\r\nFa1=Prec(100*(Foreign(Fn1,"C")/ValueWhen(FVB,Foreign(Fn1,"C"))-1),2.2);\r\nFa2=Prec(100*(Foreign(Fn2,"C")/ValueWhen(FVB,Foreign(Fn2,"C"))-1),2.2);\r\nFa3=Prec(100*(Foreign(Fn3,"C")/ValueWhen(FVB,Foreign(Fn3,"C"))-1),2.2);\r\nFa4=Prec(100*(Foreign(Fn4,"C")/ValueWhen(FVB,Foreign(Fn4,"C"))-1),2.2);\r\nFa5=Prec(100*(Foreign(Fn5,"C")/ValueWhen(FVB,Foreign(Fn5,"C"))-1),2.2);\r\nFa6=Prec(100*(Foreign(Fn6,"C")/ValueWhen(FVB,Foreign(Fn6,"C"))-1),2.2);\r\nFa7=Prec(100*(Foreign(Fn7,"C")/ValueWhen(FVB,Foreign(Fn7,"C"))-1),2.2);\r\nFa8=Prec(100*(Foreign(Fn8,"C")/ValueWhen(FVB,Foreign(Fn8,"C"))-1),2.2);\r\nFa9=Prec(100*(Foreign(Fn9,"C")/ValueWhen(FVB,Foreign(Fn9,"C"))-1),2.2);\r\nFa10=Prec(100*(Foreign(Fn10,"C")/ValueWhen(FVB,Foreign(Fn10,"C"))-1),2.2);\r\nFa11=Prec(100*(Foreign(Fn11,"C")/ValueWhen(FVB,Foreign(Fn11,"C"))-1),2.2);\r\nFa12=Prec(100*(Foreign(Fn12,"C")/ValueWhen(FVB,Foreign(Fn12,"C"))-1),2.2);\r\nFa13=Prec(100*(Foreign(Fn13,"C")/ValueWhen(FVB,Foreign(Fn13,"C"))-1),2.2);\r\nFa14=Prec(100*(Foreign(Fn14,"C")/ValueWhen(FVB,Foreign(Fn14,"C"))-1),2.2);\r\nFa15=Prec(100*(Foreign(Fn15,"C")/ValueWhen(FVB,Foreign(Fn15,"C"))-1),2.2);\r\nFa16=Prec(100*(Foreign(Fn16,"C")/ValueWhen(FVB,Foreign(Fn16,"C"))-1),2.2);\r\nFa17=Prec(100*(Foreign(Fn17,"C")/ValueWhen(FVB,Foreign(Fn17,"C"))-1),2.2);\r\nFa18=Prec(100*(Foreign(Fn18,"C")/ValueWhen(FVB,Foreign(Fn18,"C"))-1),2.2);\r\nFa19=Prec(100*(Foreign(Fn19,"C")/ValueWhen(FVB,Foreign(Fn19,"C"))-1),2.2);\r\n\r\n\r\n//Plot Normalized Graphs\r\nPlot(Fa0,Fn0,Cl0,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa0 );PlotText(Fn0, x, y,colorLightOrange);\r\nPlot(Fa1,Fn1,Cl1,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa1 );PlotText(Fn1, x, y,colorPink);\r\nPlot(Fa2,Fn2,Cl2,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa2 );PlotText(Fn2, x, y,colorOrange);\r\nPlot(Fa3,Fn3,Cl3,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa3 );PlotText(Fn3, x, y,colorGreen);\r\nPlot(Fa4,Fn4,Cl4,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa4 );PlotText(Fn4, x, y,colorTurquoise);\r\nPlot(Fa5,Fn5,Cl5,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa5 );PlotText(Fn5, x, y,colorLime);\r\nPlot(Fa6,Fn6,Cl6,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa6 );PlotText(Fn6, x, y,colorBlueGrey);\r\nPlot(Fa7,Fn7,Cl7,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa7 );PlotText(Fn7, x, y,colorYellow);\r\nPlot(Fa8,Fn8,Cl8,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa8 );PlotText(Fn8, x, y,colorBrightGreen );\r\nPlot(Fa9,Fn9,Cl9,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa9 );PlotText(Fn9, x, y,colorRed );\r\nPlot(Fa10,Fn10,C20,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa10 );PlotText(Fn10, x, y,colorDarkBlue );\r\nPlot(Fa11,Fn11,C21,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa11 );PlotText(Fn11, x, y,colorTan);\r\nPlot(Fa12,Fn12,C22,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa12 );PlotText(Fn12, x, y,colorDarkYellow );\r\nPlot(Fa13,Fn13,C23,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa13 );PlotText(Fn13, x, y,colorViolet );\r\nPlot(Fa14,Fn14,C24,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa14 );PlotText(Fn14, x, y,colorBlack );\r\nPlot(Fa15,Fn15,C25,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa15 );PlotText(Fn15, x, y,colorAqua );\r\nPlot(Fa16,Fn16,C26,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa16 );PlotText(Fn16, x, y,colorBrown );\r\nPlot(Fa17,Fn17,C27,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa17 );PlotText(Fn17, x, y,colorDarkTeal );\r\nPlot(Fa18,Fn18,C28,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa18 );PlotText(Fn18, x, y,colorGold );\r\nPlot(Fa19,Fn19,C29,4); x = LastValue( BarIndex() ) + 1; y = LastValue( Fa19 );PlotText(Fn19, x, y,colorSkyblue );\r\n\r\nPlot(0,"",colorDarkBlue,styleNoLine+styleDots);\r\n\r\n//Calculate % Change between markers\r\nFv0=IIf(startdate==0,Fa0,100*(EndValue(Foreign(Fn0,"C")-BeginValue(Foreign(Fn0,"C"))))/BeginValue(Foreign(Fn0,"C")));\r\nFv9=IIf(startdate==0,Fa9,100*(EndValue(Foreign(Fn9,"C")-BeginValue(Foreign(Fn9,"C"))))/BeginValue(Foreign(Fn9,"C")));\r\nFv8=IIf(startdate==0,Fa8,100*(EndValue(Foreign(Fn8,"C")-BeginValue(Foreign(Fn8,"C"))))/BeginValue(Foreign(Fn8,"C")));\r\nFv7=IIf(startdate==0,Fa7,100*(EndValue(Foreign(Fn7,"C")-BeginValue(Foreign(Fn7,"C"))))/BeginValue(Foreign(Fn7,"C")));\r\nFv6=IIf(startdate==0,Fa6,100*(EndValue(Foreign(Fn6,"C")-BeginValue(Foreign(Fn6,"C"))))/BeginValue(Foreign(Fn6,"C")));\r\nFv5=IIf(startdate==0,Fa5,100*(EndValue(Foreign(Fn5,"C")-BeginValue(Foreign(Fn5,"C"))))/BeginValue(Foreign(Fn5,"C")));\r\nFv4=IIf(startdate==0,Fa4,100*(EndValue(Foreign(Fn4,"C")-BeginValue(Foreign(Fn4,"C"))))/BeginValue(Foreign(Fn4,"C")));\r\nFv3=IIf(startdate==0,Fa3,100*(EndValue(Foreign(Fn3,"C")-BeginValue(Foreign(Fn3,"C"))))/BeginValue(Foreign(Fn3,"C")));\r\nFv2=IIf(startdate==0,Fa2,100*(EndValue(Foreign(Fn2,"C")-BeginValue(Foreign(Fn2,"C"))))/BeginValue(Foreign(Fn2,"C")));\r\nFv1=IIf(startdate==0,Fa1,100*(EndValue(Foreign(Fn1,"C")-BeginValue(Foreign(Fn1,"C"))))/BeginValue(Foreign(Fn1,"C")));\r\nFv10=IIf(startdate==0,Fa10,100*(EndValue(Foreign(Fn10,"C")-BeginValue(Foreign(Fn10,"C"))))/BeginValue(Foreign(Fn10,"C")));\r\nFv19=IIf(startdate==0,Fa19,100*(EndValue(Foreign(Fn19,"C")-BeginValue(Foreign(Fn19,"C"))))/BeginValue(Foreign(Fn19,"C")));\r\nFv18=IIf(startdate==0,Fa18,100*(EndValue(Foreign(Fn18,"C")-BeginValue(Foreign(Fn18,"C"))))/BeginValue(Foreign(Fn18,"C")));\r\nFv17=IIf(startdate==0,Fa17,100*(EndValue(Foreign(Fn17,"C")-BeginValue(Foreign(Fn17,"C"))))/BeginValue(Foreign(Fn17,"C")));\r\nFv16=IIf(startdate==0,Fa16,100*(EndValue(Foreign(Fn16,"C")-BeginValue(Foreign(Fn16,"C"))))/BeginValue(Foreign(Fn16,"C")));\r\nFv15=IIf(startdate==0,Fa15,100*(EndValue(Foreign(Fn15,"C")-BeginValue(Foreign(Fn15,"C"))))/BeginValue(Foreign(Fn15,"C")));\r\nFv14=IIf(startdate==0,Fa14,100*(EndValue(Foreign(Fn14,"C")-BeginValue(Foreign(Fn14,"C"))))/BeginValue(Foreign(Fn14,"C")));\r\nFv13=IIf(startdate==0,Fa13,100*(EndValue(Foreign(Fn13,"C")-BeginValue(Foreign(Fn13,"C"))))/BeginValue(Foreign(Fn13,"C")));\r\nFv12=IIf(startdate==0,Fa12,100*(EndValue(Foreign(Fn12,"C")-BeginValue(Foreign(Fn12,"C"))))/BeginValue(Foreign(Fn12,"C")));\r\nFv11=IIf(startdate==0,Fa11,100*(EndValue(Foreign(Fn11,"C")-BeginValue(Foreign(Fn11,"C"))))/BeginValue(Foreign(Fn11,"C")));\r\n\r\n\r\n\r\nTitle=\r\n// Left Bar Date\r\nWriteIf(startdate==0, WriteVal(leftbar,formatDateTime),WriteVal(BeginValue(DateTime()),formatDateTime))+\r\n//Right Bar Date\r\nWriteIf(EndValue(DateTime() )==rightbar, "              Kakata.vn                  "+Date(),\r\n"                       "+WriteVal(Range,1)+" days                       "+WriteVal(EndValue(Month()),1.0) +"/" + WriteVal(EndValue(Day()),1.0) + "/20" + StrRight( WriteVal(EndValue(Year()),1.0),2))\r\n\r\n//List of Funds\r\n+" \\n"+EncodeColor(Cl0)+Fn0 + WriteIf(IsTrue(fa0),"           ["+WriteVal(fv0,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(Cl1)+Fn1 + WriteIf(IsTrue(fa1),"           ["+WriteVal(fv1,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(Cl2)+Fn2 + WriteIf(IsTrue(fa2),"           ["+WriteVal(fv2,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(Cl3)+fn3 + WriteIf(IsTrue(fa3),"           ["+WriteVal(fv3,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(Cl4)+Fn4 + WriteIf(IsTrue(fa4),"           ["+WriteVal(fv4,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(Cl5)+Fn5 + WriteIf(IsTrue(fa5),"           ["+WriteVal(fv5,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(Cl6)+Fn6 + WriteIf(IsTrue(fa6),"           ["+WriteVal(fv6,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(Cl7)+Fn7 + WriteIf(IsTrue(fa7),"           ["+WriteVal(fv7,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(Cl8)+Fn8 + WriteIf(IsTrue(fa8),"           ["+WriteVal(fv8,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(Cl9)+Fn9 + WriteIf(IsTrue(fa9),"           ["+WriteVal(fv9,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(C20)+Fn10 + WriteIf(IsTrue(fa10),"         ["+WriteVal(fv10,1.2)+"]  ","") \r\n+" \\n"+EncodeColor(C21)+Fn11 + WriteIf(IsTrue(fa11),"         ["+WriteVal(fv11,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(C22)+Fn12 + WriteIf(IsTrue(fa12),"         ["+WriteVal(fv12,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(C23)+fn13 + WriteIf(IsTrue(fa13),"         ["+WriteVal(fv13,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(C24)+Fn14 + WriteIf(IsTrue(fa14),"         ["+WriteVal(fv14,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(C25)+Fn15 + WriteIf(IsTrue(fa15),"         ["+WriteVal(fv15,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(C26)+Fn16 + WriteIf(IsTrue(fa16),"         ["+WriteVal(fv16,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(C27)+Fn17 + WriteIf(IsTrue(fa17),"         ["+WriteVal(fv17,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(C28)+Fn18 + WriteIf(IsTrue(fa18),"         ["+WriteVal(fv18,1.2)+"]  ","")\r\n+" \\n"+EncodeColor(C29)+Fn19 + WriteIf(IsTrue(fa19),"         ["+WriteVal(fv19,1.2)+"]  ","");\r\n\r\n\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Drag-drop\\Sector 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-20.7266</Min>
			<Max>27.2953</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>RRG nghanh</Name>
		<Pane>
			<ChartID>1046</ChartID>
			<PercentHeight>100</PercentHeight>
			<Formula>_SECTION_BEGIN( "RRG Chart" );\r\n\r\n//==========================\r\n \r\n_N( base = ParamStr( "Base", "vnindex" ) );\r\ntbar = Param( "Trailing Bar", 12, 1, 100, 1 );\r\n \r\nEnableTextOutput( False );\r\nGfxSetOverlayMode( 2 );\r\n \r\npxl = Status( "pxchartleft" );\r\npxr = Status( "pxchartright" );\r\npxt = Status( "pxcharttop" );\r\npxb = Status( "pxchartbottom" );\r\npxw = ( pxr - pxl ) / 2;\r\npxh = ( pxb - pxt ) / 2;\r\nxm = pxl + pxw;\r\nym = pxt + pxh;\r\n\r\nGfxSelectPen(colorGreen); \r\n\r\n// ve mau cho chart\r\nGfxSelectPen(colorGreen);\r\nGfxSelectSolidBrush(colorBrightGreen);\r\nGfxRectangle( pxw, pxt, pxr, pxh );\r\n\r\nGfxSelectSolidBrush(ColorRGB(255,250,179));\r\nGfxRectangle( pxw, pxh, pxr, pxb );\r\n\r\nGfxSelectSolidBrush(ColorRGB(235,113,83));\r\nGfxRectangle( pxl,pxh, pxw, pxb );\r\n\r\nGfxSelectSolidBrush(ColorRGB(103,191,127));\r\nGfxRectangle( pxl,pxt, pxw, pxh );\r\n\r\n// Viet chu cac goc phan tu\r\nCoChu=Status("pxheight")/20;\r\nXuongHang=Status("pxheight")/12-Status("pxheight")/9;\r\nQuaCot=Status("pxwidth")/4-Status("pxwidth")/6;\r\n\r\nGfxSetBkMode( 1 );\r\nGfxSelectFont("Tahoma", CoChu );\r\nGfxSetTextColor( colorViolet);\r\nGfxTextOut( "DAN DAT +/+", pxr-3*quaCot, pxt-1.2*XuongHang );\r\nGfxTextOut( "SUY YEU +/-", pxr-3*quaCot, pxb+2.6*XuongHang );\r\nGfxTextOut( "TUT HAU -/-", pxl+0.2*quaCot, pxb+2.6*XuongHang );\r\nGfxTextOut( "CAI THIEN -/+", pxl+0.2*quaCot, pxt-1.2*XuongHang );\r\n\r\nGfxSetTextColor( colorBlack );\r\nGfxSelectFont("Tahoma", CoChu/2 );\r\n\r\n// danh sach nghanh\r\nVnindex=ParamStr("VnIndex","VNINDEX");\r\nTHUCPHAM=ParamStr("THUC PHAM","MSN,TNA,VNM,LSS,QNS,SBT,MCH,VOC,NAF,SCD,SAB,SMB,KDC");\r\nBAOHIEM=ParamStr("BAO HIEM","VNR,ABI,BIC,BMI,MIG,PGI,PVI,BVH");\r\nNGANHANG=ParamStr("NGAN HANG","ACB,BID,CTG,HDB,MBB,SSB,SHB,STB,TCB,TPB,VCB,VIB,VPB,ABB,EIB,BVB,KLB,LPB,MSB,NAB,BAB,NVB,OCB,PGB,SGB,VAB,VBB");\r\nCHUNGKHOAN=ParamStr("CHUNG KHOAN","AGR,ART,BSI,BVS,CTS,FTS,HCM,MBS,SBS,SHS,SSI,TVB,TVS,VCI,VDS,VIX,VND");\r\nBATDONGSAN=ParamStr("BAT DONG SAN","IJC,LDG,NVT,AMD,C21,CEO,D2D,DIG,DRH,DXG,FLC,HAR,HDC,HDG,HLD,HQC,ITC,KDH,NBB,NDN,NLG,NTL,NVL,PDR,QCG,SCR,SJS,TDH,TIG,VIC,VPH,IDV,ITA,KBC,LHG,VC3,LGL");\r\nDAUKHI=ParamStr("DAU KHI","PVB,PVC,PVD,PVS,ASP,CNG,GAS,PGC,PGS,PLX,PVG,PVO");\r\nCANG=ParamStr("CANG","HAH,STG,GMD,PDN,PHP,SGP,VSC");\r\nXAYDUNG=ParamStr("XAY DUNG","C32,C47,CII,CTD,CTI,FCN,HBC,HC3,HTI,HUT,L14,MCG,LCG,PC1,DPG,PHC,PVX,PXS,SD5,SD6,SD9,TCD,UIC,VCG,VMC,VNE,THG,VPD,TV2");\r\nTHEP=ParamStr("THEP","HPG,HSG,NKG,POM,SHA,TIS,TVN,VGS,HMC,SHI,SMC,TLH");\r\nNHUA=ParamStr("NHUA","AAA,BMP,DAG,DNP,NTP,RDP");\r\nTHUYSAN=ParamStr("THUYSAN","ANV,ASM,FMC,HVG,IDI,SSN,VHC");\r\nCAOSU=ParamStr("CAO SU","DPR,DRI,HRC,PHR,TRC,GVR");\r\nCONGNGHE=ParamStr("CONG NGHE","CMG,SGT,ITD,VEC,FPT,ELC,ABC");\r\nDUOCPHAM=ParamStr("DUOC PHAM","DCL,DHG,DHT,IMP,TRA,DVN,DBD,JVC");\r\nHANGKHONG=ParamStr("HANG KHONG","NCT,ACV,HVN,SCS,VJC");\r\nHOACHAT=ParamStr("HOA CHAT","HAI,LTG,TSC,VFG,BFC,DCM,DDV,DPM,LAS,QBS,SFG,CSM,DRC,SRC,CSV,DGC,PLC,LIX,NET");\r\nMAYMAC=ParamStr("MAY MAC","ADS,EVE,FTM,GMC,HTG,KMR,STK,TCM,TNG,TVT,VGG,VGT,MSH");\r\nDIENNUOC=ParamStr("DIEN NUOC","BWE,VCW,DQC,GDT,RAL,CHP,NT2,REE,PPC,SBA,SJD,VSH");\r\nVANTAI=ParamStr("VAN TAI","PVT,GSP,SWC,VIP,VOS,VTO,SKG,SRT,VNS,SAS");\r\nBDSKCN=ParamStr("BDS KCN","SZC,SAL,IDC,TIP,NTC,LHG,D2D,KBC,ITA,BCM");\r\nBANLE=ParamStr("BAN LE","MWG,FPT,FRT,PET,DGW,PIV");\r\nPHANBON=ParamStr("PHAN BON","DPM,DCM,LAS,BFC,DDV");\r\nTHAN=ParamStr("THAN","TDN,TC6,TVD,THT,NBC");\r\nVLXD=ParamStr("VLXD","ACC,BCC,BTS,CTI,DC4,DHA,GMX,HOM,HT1,MVC,NNC,QNS,SCJ,VCS,VGC,KSB");\r\nDAUTUCONG=ParamStr("DAU TU CONG","FCN,KSB,PLC,BCC,HT1,DHA,LCG,C4G,C32");\r\nfunction DebugPrint( str )\r\n{\r\n    printf("Value of var: %s\\n", str);\r\n}\r\n\r\n\r\n//tinh gia watchlist\r\nSowl=6;\r\nfunction TinhCList( Sowl )\r\n{\t\r\n\tif(Sowl == "Ngan Hang") {\r\n\t\tlistNganh = NGANHANG;\r\n\t} \r\n\telse if (Sowl ==  "BDS"){\r\n\t\tlistNganh = BATDONGSAN;\r\n\t} \r\n\telse if (Sowl ==  "Chung Khoan"){\r\n\t\tlistNganh = CHUNGKHOAN;\r\n\t} \r\n\telse if (Sowl ==  "Thuc Pham"){\r\n\t\tlistNganh = THUCPHAM;\r\n\t} \r\n\telse if (Sowl ==  "Bao Hiem"){\r\n\t\tlistNganh = BAOHIEM;\r\n\t} \r\n\telse if (Sowl ==  "Dau Khi"){\r\n\t\tlistNganh = DAUKHI;\r\n\t} \r\n\telse if (Sowl ==  "Cang"){\r\n\t\tlistNganh = CANG;\r\n\t} \r\n\telse if (Sowl ==  "Xay Dung"){\r\n\t\tlistNganh = XAYDUNG;\r\n\t} \r\n\telse if (Sowl ==  "Thep"){\r\n\t\tlistNganh = THEP;\r\n\t} \r\n\telse if (Sowl ==  "Nhua"){\r\n\t\tlistNganh = NHUA;\r\n\t} \r\n\telse if (Sowl ==  "Thuy San"){\r\n\t\tlistNganh = THUYSAN;\r\n\t} \r\n\telse if (Sowl ==  "Cao Su"){\r\n\t\tlistNganh = CAOSU;\r\n\t} \r\n\telse if (Sowl ==  "Cong Nghe"){\r\n\t\tlistNganh = CONGNGHE;\r\n\t} \r\n\telse if (Sowl ==  "Duoc Pham"){\r\n\t\tlistNganh = DUOCPHAM;\r\n\t} \r\n\telse if (Sowl ==  "Hang Khong"){\r\n\t\tlistNganh = HANGKHONG;\r\n\t} \r\n\telse if (Sowl ==  "Hoa Chat"){\r\n\t\tlistNganh = HOACHAT;\r\n\t} \r\n\telse if (Sowl ==  "May Mac"){\r\n\t\tlistNganh = MAYMAC;\r\n\t} \r\n\telse if (Sowl ==  "Dien Nuoc"){\r\n\t\tlistNganh = DIENNUOC;\r\n\t} \r\n\telse if (Sowl ==  "Van Tai"){\r\n\t\tlistNganh = VANTAI;\r\n\t} \r\n\telse if (Sowl ==  "BDS KCN"){\r\n\t\tlistNganh = BDSKCN;\r\n\t} \r\n\telse if (Sowl ==  "Ban Le"){\r\n\t\tlistNganh = BANLE;\r\n\t} \r\n\telse if (Sowl ==  "Phan Bon"){\r\n\t\tlistNganh = PHANBON;\r\n\t} \r\n\telse if (Sowl ==  "Than"){\r\n\t\tlistNganh = THAN;\r\n\t} \r\n\telse if (Sowl ==  "Vl Xd"){\r\n\t\tlistNganh = VLXD;\r\n\t} \r\n\telse if (Sowl ==  "Dau Tu Cong"){\r\n\t\tlistNganh = DAUTUCONG;\r\n\t} \r\n\t\r\n\t//listNganh = CategoryGetSymbols( categoryWatchlist, Sowl );\r\n\t// listNganh = ParamStr( Sowl, "" );\r\n\tDebugPrint(listNganh);\r\n    for( a = 0; ( MAcp = StrExtract( Listnganh, a ) ) != ""; a++ )\r\n    { DebugPrint( MAcp );\r\n        Vol= MA(Foreign( MAcp, "V" ),50);\r\n        giatri = Foreign( MAcp, "C" )*Vol;\r\n        if( a == 0 ) {TongVol = 1;\r\n                TongGtri=0;}\r\n        else {TongGtri = tongGtri + GiaTri;\r\n                 TongVol=TongVol+Vol;}\r\n    }\r\n    return (TongGtri / TongVol);\r\n}\r\n\r\n//ham tinh chi so RS, giai quyet cho wl\r\n \r\nfunction getrs ( sowl, t )\r\n{\r\n    \r\n    bc = Foreign( base, "C" );\r\n    sbr = tinhCList(sowl) / bc;\r\n \r\n    rs1 = MA( sbr, 12 );\r\n    rs2 = MA( sbr, 26 );\r\n    rs = 100 * ( ( rs1 - rs2 ) / rs2 + 1 );\r\n \r\n    rm1 = MA( rs, 1 );\r\n    rm2 = MA( rs, 9 );\r\n    rm = 100 * ( ( rm1 - rm2 ) / rm2 + 1 );\r\n \r\n    return IIf( t, rs , rm ) - 100;\r\n}\r\n // ham ve do thi\r\nfunction drawpos (sowl, x, y, text )\r\n{\r\n    rsl = VarGet( "rsl" );\r\n    rsh = VarGet( "rsh" );\r\n    rml = VarGet( "rml" );\r\n    rmh = VarGet( "rmh" );\r\n \r\n    xx = pxl + pxw + x * ( pxw / ( Max( rsh, -rsl ) * 1.10 ) );\r\n    yy = pxb - pxh - y * ( pxh / ( Max( rmh, -rml ) * 1.10 ) );\r\n     \r\n    //Ten=CategoryGetName( categoryWatchlist, sowl );\r\n    Ten = sowl;\r\n    xp = Nz( VarGet( "xp" + ten ), xx );// neu bien xp+sym ko co thi no = xx\r\n    yp = Nz( VarGet( "yp" + ten ), yy );\r\n \r\n    VarSet( "xp" + ten, xx );\r\n    VarSet( "yp" + ten, yy );\r\n \r\n    GfxMoveTo( xp, yp );\r\n    GfxLineTo( xx, yy );\r\n      GfxSelectSolidBrush(colorRed);\r\n    GfxCircle( xx, yy, IIf( text == "", 1, 6 ) );//ve nhung cham nho\r\n\t\r\n\tGfxSelectFont("Tahoma", 10 );\r\n\tGfxSetTextColor( colorViolet);\r\n    if ( text != "" ) GfxTextOut( ten, xx + 6 , yy - 3 );// viet chu cuoi dthi\r\n}\r\n//=====================================\r\nfunction Ve(sowl)\r\n{\r\n    rs = getrs( sowl, 1 );\r\n    rm = getrs( sowl, 0 );\r\n\r\n    \r\n    for ( ii = BarCount - tbar; ii &lt; BarCount; ii++ )\r\n    {\r\n        rs_ = rs[ ii ];\r\n        rm_ = rm[ ii ];\r\n \r\n        rsh = Nz( VarGet( "rsh" ), rs_ );\r\n        if ( rs_ &gt;= rsh )\r\n            VarSet( "rsh", rs_ );\r\n \r\n        rsl = Nz( VarGet( "rsl" ), rs_ );\r\n        if ( rs_ &lt;= rsl )\r\n            VarSet( "rsl", rs_ );\r\n \r\n        rmh = Nz( VarGet( "rmh" ), rm_ );\r\n        if ( rm_ &gt;= rmh )\r\n            VarSet( "rmh", rm_ );\r\n \r\n        rml = Nz( VarGet( "rml" ), rm_ );\r\n        if ( rm_ &lt;= rml )\r\n            VarSet( "rml", rm_ );\r\n\r\n        drawpos(sowl, rs[ ii ], rm[ ii ], WriteIf( ii == BarCount - 1, "yes", "" ) );\r\n    }\r\n}\r\n\r\nColor1=Param("colortext1:",colorDarkBlue);\r\nColor2=Param("colortext2:",colorDarkGreen);\r\nColor3 = ParamColor("Color3", colorBrown );\r\nColor4 = ParamColor("Color4", colorPink );\r\nColor5 = ParamColor("Color5", colorCustom1 );\r\nColor6 = ParamColor("Color6", colorCustom9 );\r\nColor7 = ParamColor("Color7", colorOrange );\r\nColor8 = ParamColor("Color8", colorGold );\r\nColor9 = ParamColor("Color9", colorTan );\r\nColor10 = ParamColor("Color10", colorCustom11 );\r\nColor11 = ParamColor("Color11", colorTeal );\r\nColor12 = ParamColor("Color12", colorCustom5 );\r\nColor13 = ParamColor("Color13", colorCustom13 );\r\nColor14 = ParamColor("Color14", colorPaleGreen );\r\nColor15 = ParamColor("Color15", colorCustom4 );\r\nColor16 = ParamColor("Color16", colorCustom12 );\r\nColor17 = ParamColor("Color17", colorBlue );\r\nColor18 = ParamColor("Color18", colorDarkRed );\r\nColor19 = ParamColor("Color19", colorIndigo );\r\nColor20 = ParamColor("Color20", colorViolet );\r\nColor21 = ParamColor("Color21", colorDarkGrey );\r\nColor22 = ParamColor("Color22", colorLightOrange );\r\nColor23 = ParamColor("Color23", colorWhite );\r\nColor24 = ParamColor("Color24", colorSkyblue );\r\nColor25 = ParamColor("Color25", colorAqua );\r\nColor26 = ParamColor("Color26", colorTurquoise );\r\nColor27 = ParamColor("Color27", colorLime );\r\nColor28 = ParamColor("Color28", colorRose );\r\n\r\n\r\nVeThucPham=ParamList("Thuc Pham","Hien|An");\r\nVeNganHang=ParamList("Ngan Hang","Hien|An");\r\nVeBDS=ParamList("BDS","Hien|An");\r\nVeBaoHiem=ParamList("Bao Hiem","Hien|An");\r\nVeChungKhoan=ParamList("Chung Khoan","Hien|An");\r\nVeDauKhi=ParamList("Dau Khi","Hien|An");\r\nVeCang=ParamList("Cang","Hien|An");\r\nVeXayDung=ParamList("Xay Dung","Hien|An");\r\nVeThep=ParamList("Thep","Hien|An");\r\nVeNhua=ParamList("Nhua","Hien|An");\r\nVeThuySan=ParamList("Thuy San","Hien|An");\r\nVeCaoSu=ParamList("Cao Su","Hien|An");\r\nVeCongNghe=ParamList("Cong Nghe","Hien|An");\r\nVeDuocPham=ParamList("Duoc Pham","Hien|An");\r\nVeHangKhong=ParamList("Hang Khong","Hien|An");\r\nVeHoaChat=ParamList("Hoa Chat","Hien|An");\r\nVeMayMac=ParamList("May Mac","Hien|An");\r\nVeDienNuoc=ParamList("Dien Nuoc","Hien|An");\r\nVeVanTai=ParamList("Van Tai","Hien|An");\r\nVeCangBien=ParamList("Cang Bien","Hien|An");\r\nVeBDSKCN=ParamList("BDS KCN","Hien|An");\r\nVeBanLe=ParamList("Ban Le","Hien|An");\r\nVePhanBon=ParamList("Phan Bon","Hien|An");\r\nVeThan=ParamList("Than","Hien|An");\r\nVeVLXD=ParamList("Vl Xd","Hien|An");\r\nVeDauTuCong=ParamList("Dau Tu Cong","Hien|An");\r\n\r\n//1\r\nswitch(VeThucPham)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color1,width=2);\r\nVe("Thuc Pham");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n//2\r\nswitch(VeNganHang)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color2,width=2);\r\nVe("Ngan Hang");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n//3\r\nswitch(VeBDS)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color3,width=2);\r\nVe("BDS");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n//4\r\nswitch(VeBaoHiem)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color4,width=2);\r\nVe("Bao Hiem");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n//5\r\nswitch(VeChungKhoan)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color5,width=2);\r\nVe("Chung Khoan");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n//6\r\nswitch(VeDauKhi)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color6,width=2);\r\nVe("Dau Khi");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n//7\r\nswitch(VeCang)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color7,width=2);\r\nVe("Cang");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n\r\nswitch(VeXayDung)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color8,width=2);\r\nVe("Xay Dung");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeThep)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color9,width=2);\r\nVe("Thep");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeNhua)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color10,width=2);\r\nVe("Nhua");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeThuySan)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color11,width=2);\r\nVe("Thuy San");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeCaoSu)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color12,width=2);\r\nVe("Cao Su");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeCongNghe)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color13,width=2);\r\nVe("Cong Nghe");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeDuocPham)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color14,width=2);\r\nVe("Duoc Pham");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeHangKhong)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color15,width=2);\r\nVe("Hang Khong");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeHoaChat)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color16,width=2);\r\nVe("Hoa Chat");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeMayMac)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color17,width=2);\r\nVe("May Mac");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeDienNuoc)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color18,width=2);\r\nVe("Dien Nuoc");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeVanTai)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color19,width=2);\r\nVe("Van Tai");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n\r\nswitch(VeBDSKCN)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color20,width=2);\r\nVe("BDS KCN");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeBanLe)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color21,width=2);\r\nVe("Ban Le");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VePhanBon)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color22,width=2);\r\nVe("Phan Bon");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeThan)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color23,width=2);\r\nVe("Than");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\nswitch(VeVLXD)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(Color1,width=2);\r\nVe("Vl Xd");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n\r\nswitch(VeDauTuCong)\r\n{\r\ncase  "Hien":\r\nGfxSelectPen(colorAqua);\r\nVe("Dau Tu Cong");\r\nbreak;\r\ncase "An":\r\nbreak;\r\n}\r\n\r\n\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Indicators\\suutam\\RRG Nganh.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-20.7266</Min>
			<Max>27.2953</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>RRG</Name>
		<Pane>
			<ChartID>1018</ChartID>
			<PercentHeight>100</PercentHeight>
			<Formula>\r\n_SECTION_BEGIN( "XY-Rotation Chart" );\r\n\r\n\r\n//_N( base = ParamList( "Base", "VNINDEX|HNX|VN30|HNX30|UPCOM|VNXALL" ) );    //dong 5  va 6, chi chon 1 trong 2 dong\r\n_N( base = ParamStr( "Base", "VNINDEX" ) );\r\n\r\n_N( list1 = ParamList( "List", "BAN_BUON|BAO_HIEM|BAT_DONG_SAN|CHUNG_KHOAN|CONG_NGHE_THONG_TIN|BAN_LE|CHAM_SOC_SUC_KHOE|KHAI_KHOANG|NGAN_HANG|NONG_LAM_NGU|SXTHIETBI|SX_HANG_GIA_DUNG|CAO_SU|NHUA_HOA_CHAT|THUC_PHAM_DO_UONG|THUY_SAN|VLXD|TIEN_ICH|VAN_TAI|XAY_DUNG|DICHVU|SX_PHU_TRO|THIET_BI_DIEN|DICHVU_TU_VAN" ) );\r\n\r\n\r\nBANBUON1\t\t\t\t= ParamStr("BAN BUON", "PLX,HHS,HAI,KLF,TSC,SHN,PSH,JVC,TLH,AMV,PET,DGW,ABS,SGT,QBS,AAV,SMC,TNI,TTB,TNA");\r\nBAOHIEM1\t\t\t\t= ParamStr("BAO HIEM", "BIC,BMI,BVH,MIG,PGI,PRE,PTI,PVI,VNR");\r\nBATDONGSAN1\t\t\t\t= ParamStr("BAT DONG SAN","VHM,VIC,VRE,NVL,BCM,ITA,FLC,KDH,TCH,DXG,KBC,DIG,PDR,HQC,NLG,SCR,DXS,HUT,KHG,HPX");\r\nCHUNGKHOAN1 \t\t\t= ParamStr("CHUNG KHOAN","SSI,HCM,VND,VCI,SHS,VIX,MBS,AGR,ORS,FTS,BSI,TVB,TVS,CTS,VDS,EVS,ART,APS,APG,BVS");\r\nCONGNGHETHONGTIN1 \t\t= ParamStr("CONG NGHE THONG TIN","FPT,CMG,ELC,DST,ICT,ITD,EID,EBS,SED,GLT,ONE,STC,DAD,VTC,SMN,SGD,ADC,PIA,QST,BED");\r\nBANLE1\t\t\t\t\t= ParamStr("BANLE","MWG,VGC,AMD,FRT,CTF,HAX,AST,SVC,SVN,CIA,CMV,CCI,CTC,COM,BTT,TMC,VTJ,SFC,HTC,PNC");\r\nCHAMSOCSUCkHOE1\t\t\t= ParamStr("CHAM SOC SUC KHOE","FIT,DHG,IMP,DCL,DBD,TNH,TRA,DMC,OPC,DHT,VDP,SPM,LDP,PMC,PPP,DP3,MED,MKV");\r\nKHAIKHOANG1\t\t\t\t= ParamStr("KHAI KHOANG","PVS,PVD,MVB,KSB,ACM,TNT,PVC,TVD,NBC,TC6,DHM,KSQ,TDN,HLC,LCM,THT,NNC,PVB,MDC,SPI");\r\nNGANHANG1\t\t\t\t= ParamStr("NGAN HANG","BID,CTG,VCB,VPB,MBB,TCB,ACB,SHB,HDB,STB,TPB,VIB,MSB,SSB,OCB,EIB,LPB,BAB,NVB,EVF,IPA,OGC,TVC");\r\nNONGLAMNGU1\t\t\t\t= ParamStr("NONG LAM NGU","HNG,HAG,VIF,ASM,SJF,BAF,APC,NSC,HSL,PSW,SSC,CTP,HKT");\r\nSXTHIETBI1\t\t\t\t= ParamStr("SX THIET BI","MCG,THI,NHH,NAG,CTB,SHE,QHD,DZM,CTT,CJC");\r\nSXHANGGIADUNG1\t\t\t= ParamStr("SX HANG GIA DUNG","TTF,TNG,TCM,STK,KMR,MSH,FTM,GIL,ADS,EVE,SHA,GMC,TDT,TVT,GDT,X20,SAV,SVD,TET,MHL");\r\nCAOSU1\t\t\t\t\t= ParamStr("CAO SU","DRC,CSM,SRC,BRC");\r\nNHUAHOACHAT1\t\t\t= ParamStr("NHUA HOA CHAT","GVR,DCM,DPM,AAA,APH,DGC,PHR,DNP,NTP,LAS,BMP,TDP,DAG,BFC,SFG,RDP,CSV,DPR,PLP,VAF");\r\nTHUCPHAMDOUONG1\t\t\t= ParamStr("THUC PHAM DO UONG","VNM,MSN,SAB,SBT,KDC,GTN,BHN,PAN,DBC,LSS,NAF,TAR,DAT,TAC,VHE,SMB,VCF,BCF,BNA,BBC");\r\nTHUYSAN1\t\t\t\t= ParamStr("THUY SAN","IDI,VHC,ANV,CMX,FMC,ACL,SJ1,KHS,BLF,ABT,AAM");\r\nVLXD1\t\t\t\t\t= ParamStr("VLXD","HPG,HSG,HT1,POM,NKG,VCS,BTS,BCC,VIS,HOM,TEG,DTL,VIT,TCR,FCM,VGS,HVX,CVT,TKU,ACC");\r\nTIENICH1\t\t\t\t= ParamStr("TIEN ICH","POW,GAS,DTK,PPC,GEG,IDC,NT2,VSH,BWE,CHP,TTA,VPD,TDM,SHP,PGD,TMP,SJD,SII,TBC,BTP");\r\nVANTAI1\t\t\t\t\t= ParamStr("VAN TAI","HVN,VJC,PHP,PVT,GMD,VOS,TMS,DL1,CDN,STG,VTO,ASG,VIP,VNS,SKG,GSP,VSC,SCS,HAH,MHC");\r\nXAYDUNG1\t\t\t\t= ParamStr("XAY DUNG","ROS,VCG,THD,REE,BCG,HBC,CII,PC1,LGC,TCD,LCG,FCN,HTN,SCG,VNE,CTX,CTD,IDJ,MST,LIG");\r\nDICHVU1\t\t\t\t\t= ParamStr("DICH VU","OCH,VNG,NVT,DAH,RIC,SDA,PDC,SGH,DSN,HOT,TTT,ATS,VCM");\r\nSXPHUTRO1\t\t\t\t= ParamStr("SX PHU TRO","DLG,PNJ,SHI,HTP,PLC,TLG,DHC,HAP,KVC,PTB,TLD,TMT,BKG,HHP,SBV,ITQ,INN,NHT,MCP,SVI");\r\nTHIETBIDIEN1\t\t\t= ParamStr("THIET BI DIEN","GEX,SAM,MBG,CAV,PAC,TYA,DQC,POT,EMC,RAL,KSD,VTB,DHP,PHN,TSB,VTH");\r\nDICHVUTUVAN1\t\t\t= ParamStr("DICH VU TU VAN","IBC,KPF,TV2,SDA,TV4,VNC,TV3,VCM,SDC,INC,PPE,VLA");\r\n\r\n\r\nlist = WriteIf(list1=="BAN_BUON",BANBUON1,WriteIf(list1=="BAO_HIEM",BAOHIEM1,WriteIf(list1=="BAT_DONG_SAN",BATDONGSAN1,WriteIf(list1=="CHUNG_KHOAN",CHUNGKHOAN1,\r\nWriteIf(list1=="CONG_NGHE_THONG_TIN",CONGNGHETHONGTIN1,WriteIf(list1=="BAN_LE",BANLE1,WriteIf(list1=="CHAM_SOC_SUC_KHOE",CHAMSOCSUCKHOE1,\r\nWriteIf(list1=="KHAI_KHOANG",KHAIKHOANG1,WriteIf(list1=="NGAN_HANG",NGANHANG1,WriteIf(list1=="NONG_LAM_NGU",NONGLAMNGU1,WriteIf(list1=="SXTHIETBI",SXTHIETBI1,\r\nWriteIf(list1=="SX_HANG_GIA_DUNG",SXHANGGIADUNG1,WriteIf(list1=="CAO_SU",CAOSU1,WriteIf(list1=="NHUA_HOA_CHAT",NHUAHOACHAT1,WriteIf(list1=="THUC_PHAM_DO_UONG",THUCPHAMDOUONG1,\r\nWriteIf(list1=="THUY_SAN",THUYSAN1,WriteIf(list1=="VLXD",VLXD1,WriteIf(list1=="TIEN_ICH",TIENICH1,WriteIf(list1=="VAN_TAI",VANTAI1,WriteIf(list1=="XAY_DUNG",XAYDUNG1,\r\nWriteIf(list1=="DICHVU",DICHVU1,WriteIf(list1=="SX_PHU_TRO",SXPHUTRO1,WriteIf(list1=="THIET_BI_DIEN",THIETBIDIEN1,DICHVUTUVAN1)))))))))))))))))))))));\r\n\r\ntbar = Param( "Trailing Bar", 12, 1, 100, 1 );\r\n\r\n\r\ncolor1 = ParamColor("Symbol 1:", colorRed);\r\ncolor2 = ParamColor("Symbol 2:", colorOrange);\r\ncolor3 = ParamColor("Symbol 3:", colorBrightGreen);\r\ncolor4 = ParamColor("Symbol 4:", colorDarkGreen);\r\ncolor5 = ParamColor("Symbol 5:", colorBlue);\r\ncolor6 = ParamColor("Symbol 6:", colorCustom10);\r\ncolor7 = ParamColor("Symbol 7:", colorPlum);\r\ncolor8 = ParamColor("Symbol 8:", colorBrown);\r\ncolor9 = ParamColor("Symbol 9:", colorViolet);\r\ncolor10 = ParamColor("Symbol 10:", colorCustom12);\r\ncolor11 = ParamColor("Symbol 11:", colorPink);\r\ncolor12 = ParamColor("Symbol 12:", colorIndigo);\r\ncolor13 = ParamColor("Symbol 13:", colorDarkGrey);\r\ncolor14 = ParamColor("Symbol 14:", colorTeal);\r\ncolor15 = ParamColor("Symbol 15:", colorTan);\r\ncolor16 = ParamColor("Symbol 16:", colorCustom16);\r\ncolor17 = ParamColor("Symbol 17:", colorBrightGreen);\r\ncolor18 = ParamColor("Symbol 18:", colorDarkBlue);\r\ncolor19 = ParamColor("Symbol 19:", colorDarkOliveGreen);\r\ncolor20 = ParamColor("Symbol 20:", colorYellow);\r\n\r\nlist = Name()+","+list;   \t\t\t\t//Them co phieu dang xem vao trong list\r\n\r\nEnableTextOutput( False );\r\nGfxSetOverlayMode( 2 );\r\n\r\npxl = Status( "pxchartleft" );\r\npxr = Status( "pxchartright" );\r\npxt = Status( "pxcharttop" );\r\npxb = Status( "pxchartbottom" );\r\npxw = ( pxr - pxl ) / 2;\r\npxh = ( pxb - pxt ) / 2;\r\nxm = pxl + pxw;\r\nym = pxt + pxh;\r\n\r\nGfxSelectSolidBrush(ColorRGB(231,255,255));\r\nGfxRectangle( xm, ym, pxr, pxt );\r\nGfxSelectSolidBrush(ColorRGB(231,255,231));\r\nGfxRectangle( xm, ym, pxl, pxb );\r\nGfxSelectSolidBrush(ColorRGB(255,231,231));\r\nGfxRectangle( xm, ym, pxr, pxb );\r\nGfxSelectSolidBrush(ColorRGB(255,255,231));\r\nGfxRectangle( xm, ym, pxl, pxt );\r\n\r\n\r\n\r\nGfxSelectFont("Arial", Status("pxheight")/60 );\r\nGfxSetTextColor( ParamColor( "Text Color", colorBlack ) );\r\nGfxSetBkMode(0); // transparent\r\nGfxSetBkColor(colorPaleGreen);\r\nGfxTextOut( "D\\u1EAAN D\\u1EAET", pxr-120 , pxt +50 );\t\t\t// DAN DAT\r\nGfxSetBkColor(colorPink);\r\nGfxTextOut( "T\\u1ee4T H\\u1EACU", pxl+15, pxb-65 );\t\t\t\t// TUT HAU\r\nGfxSetBkColor(colorLightYellow);\r\nGfxTextOut( "SUY Y\\u1EBEU", pxr-120, pxb-65);\t\t\t\t\t// SUY YEU\r\nGfxSetBkColor(colorLightBlue);\r\nGfxTextOut( "C\\u1EA2I THI\\u1EC6N", pxl+15, pxt+50 );\t\t\t// CAI THIEN\r\nGfxSelectFont("", Status("pxheight")/90 );\r\n//GfxTextOut( "Developed by QU\\u00C2N \\u0110\\u1EB6NG - Website: https://wuado.net", Status("pxwidth")/80, Status("pxheight")/1.04 );  \r\n//GfxTextOut( "Developed by QU\\u00C2N \\u0110\\u1EB6NG", Status("pxwidth")/80, Status("pxheight")/1.04 );  \r\n_SECTION_BEGIN("Title");\r\nGfxSelectFont("", Status("pxheight")/40 );\r\nGfxSetBkMode(1);\r\n//GfxSetBkColor(colorDarkRed);\r\nGfxSelectSolidBrush(colorDarkRed);\r\nGfxRectangle(pxl,pxt,pxr,50);\r\nGfxSetTextColor(colorWhite);\r\nGfxSetTextAlign(6);\r\nGfxTextOut( WriteIf(list1=="BAN_BUON","B\\u00C1N BU\\u00D4N",WriteIf(list1=="BAO_HIEM","B\\u1EA2O HI\\u1EC2M",WriteIf(list1=="BAT_DONG_SAN","B\\u1EA4T \\u0110\\u1ed8NG S\\u1EA2N",WriteIf(list1=="CHUNG_KHOAN","CH\\u1ee8NG KHO\\u00C1N",\r\nWriteIf(list1=="CONG_NGHE_THONG_TIN","C\\u00D4NG NGH\\u1EC6 TH\\u00D4NG TIN",WriteIf(list1=="BAN_LE","B\\u00C1N L\\u1EBA",WriteIf(list1=="CHAM_SOC_SUC_KHOE","CH\\u0102M S\\u00D3C S\\u1ee8C KHO\\u1EBA",\r\nWriteIf(list1=="KHAI_KHOANG","KHAI KHO\\u00C1NG",WriteIf(list1=="NGAN_HANG","NG\\u00C2N H\\u00C0NG",WriteIf(list1=="NONG_LAM_NGU","N\\u00D4NG - L\\u00C2M - NG\\u01af",WriteIf(list1=="SXTHIETBI","S\\u1EA2N XU\\u1EA4T THI\\u1EBET B\\u1ECA",\r\nWriteIf(list1=="SX_HANG_GIA_DUNG","S\\u1EA2N XU\\u1EA4T H\\u00C0NG GIA D\\u1ee4NG",WriteIf(list1=="CAO_SU","CAO SU",WriteIf(list1=="NHUA_HOA_CHAT","NH\\u1ef0A - H\\u00D3A CH\\u1EA4T",WriteIf(list1=="THUC_PHAM_DO_UONG","TH\\u1ef0C PH\\u1EA8M - \\u0110\\u1ED2 U\\u1ed0NG",\r\nWriteIf(list1=="THUY_SAN","TH\\u1ee6Y S\\u1EA2N",WriteIf(list1=="VLXD","V\\u1EACT LI\\u1EC6U X\\u00C2Y D\\u1ef0NG",WriteIf(list1=="TIEN_ICH","TI\\u1EC6N \\u00CDCH",WriteIf(list1=="VAN_TAI","V\\u1EACN T\\u1EA2I  KHO B\\u00C3I",WriteIf(list1=="XAY_DUNG","X\\u00c2Y D\\u1ef0NG",\r\nWriteIf(list1=="DICHVU","D\\u1ECACH V\\u1ee4 (L\\u01B0u tr\\u00FA, \\u0102n u\\u1ED1ng, Gi\\u1EA3i tr\\u00ED)",WriteIf(list1=="SX_PHU_TRO","S\\u1EA2N XU\\u1EA4T PH\\u1ee4 TR\\u1ee2",\r\nWriteIf(list1=="THIET_BI_DIEN","THI\\u1EBET B\\u1ECA \\u0110I\\u1EC6N","D\\u1ECACH V\\u1ee4 T\\u01af V\\u1EA4N")))))))))))))))))))))))\r\n, Status("pxwidth")/2, Status("pxheight")/80 ); \r\n\r\n_SECTION_END();\r\n\r\nGfxSelectFont("", Status("pxheight")/60 );\r\nGfxMoveTo( pxl, ym ); \r\nGfxLineTo( pxr, ym );\r\nGfxMoveTo( xm, pxt );\r\nGfxLineTo( xm, pxb );\r\n\r\nbc = Foreign( base, "C" );\r\n\r\n\r\nfunction drawpos ( x, y, color, sym, op )\r\n{ \r\n    rsl = VarGet( "rsl" );\r\n\trsh = VarGet( "rsh" );\r\n\trml = VarGet( "rml" );\r\n\trmh = VarGet( "rmh" );\r\n    xx = pxl + pxw + x * ( pxw / ( Max( rsh, -rsl ) * 1.10 ) );\r\n\tyy = pxb - pxh - y * ( pxh / ( Max( rmh, -rml ) * 1.10 ) );\r\n\r\n    \r\n    xp = Nz( VarGet( "xp" + sym ), xx );\r\n    yp = Nz( VarGet( "yp" + sym ), yy );\r\n\r\n    VarSet( "xp" + sym, xx );\r\n    VarSet( "yp" + sym, yy );\r\n\r\n    GfxMoveTo( xp, yp );\r\n    GfxSelectPen( color); \r\n    GfxLineTo( xx, yy );\r\n\r\n    GfxSelectSolidBrush(color);  \r\n    \r\n    GfxCircle( xx, yy, IIf( op == 1, 2, 4 ) );\r\n    \r\n\tGfxSetBkMode ( 1 ); \r\n\t\r\n\tcheck = StrMid( sym, 0, 1);\r\n\t\tif (check == "0" OR check == "1" OR check == "2" OR check == "3" OR check == "4" OR check == "5" OR check == "6" OR check == "7" OR check == "8" OR check == "9")\r\n\t\t\tsym = FullName();\r\n\t\telse\r\n\t\t\tsym = Name();\r\n\t\t\t\r\n\tGfxSetTextColor( color); \r\n    \r\n\r\n    if ( op != 1 ) GfxTextOut( sym, xx + 6 , yy - 3 );   \r\n}\r\n\r\nfunction getrs ( sc, t ) \r\n{\r\nbc = Foreign( base, "C" );  \r\nsbr = sc / bc;\r\n\r\nrs1 = MA( sbr, 12 );\r\nrs2 = MA( sbr, 26 );\r\nrs = 100 * ( ( rs1 - rs2 ) / rs2 + 1 );\r\n\r\nrm1 = MA( rs, 1 );\r\nrm2 = MA( rs, 9 );\r\nrm = 100 * ( ( rm1 - rm2 ) / rm2 + 1 );\r\n\r\nreturn IIf( t, rs , rm ) - 100;\r\n}\r\n\r\nfor ( i = 0; ( sym = StrExtract( list, i ) ) != ""; i++ )\r\n{\r\n    SetForeign( sym );\r\n\r\n\trs = getrs( C, 1 );\r\n\trm = getrs( C, 0 );\r\n\r\n\r\n    for ( ii = BarCount - tbar; ii &lt; BarCount; ii++ ) \r\n    {\r\n        rs_ = rs[ ii ];\r\n        rm_ = rm[ ii ];        \r\n\r\n        rsh = Nz( VarGet( "rsh" ), rs_ );\r\n        if ( rs_ &gt;= rsh )\r\n            VarSet( "rsh", rs_ );\r\n\r\n        rsl = Nz( VarGet( "rsl" ), rs_ );\r\n        if ( rs_ &lt;= rsl )\r\n            VarSet( "rsl", rs_ );\r\n\r\n        rmh = Nz( VarGet( "rmh" ), rm_ );\r\n        if ( rm_ &gt;= rmh )\r\n            VarSet( "rmh", rm_ );\r\n\r\n        rml = Nz( VarGet( "rml" ), rm_ );\r\n        if ( rm_ &lt;= rml )\r\n            VarSet( "rml", rm_ );\r\n    }\r\n\r\n    RestorePriceArrays( True );\r\n}\r\n\r\nfor ( i = 0; ( sym = StrExtract( list, i ) ) != ""; i++ ) \r\n{\r\n    SetForeign( sym );\r\n\trs = getrs( C, 1 );\r\n\trm = getrs( C, 0 );\r\n\r\n\r\n    \r\n    switch (i) {\r\n\t\tcase 0:\r\n\t\t\tcolor = color1;\r\n\t\t\tbreak;\r\n\t\tcase 1:\r\n\t\t\tcolor = color2;\r\n\t\t\tbreak;\r\n\t\tcase 2:\r\n\t\t\tcolor = color3;\r\n\t\t\tbreak;\r\n\t\tcase 3:\r\n\t\t\tcolor = color4;\r\n\t\t\tbreak;\r\n\t\tcase 4:\r\n\t\t\tcolor = color5;\r\n\t\t\tbreak;\r\n\t\tcase 5:\r\n\t\t\tcolor = color6;\r\n\t\t\tbreak;\r\n\t\tcase 6:\r\n\t\t\tcolor = color7;\r\n\t\t\tbreak;\r\n\t\tcase 7:\r\n\t\t\tcolor = color8;\r\n\t\t\tbreak;\r\n\t\tcase 8:\r\n\t\t\tcolor = color9;\r\n\t\t\tbreak;\r\n\t\tcase 9:\r\n\t\t\tcolor = color10;\r\n\t\t\tbreak;\r\n\t\tcase 10:\r\n\t\t\tcolor = color11;\r\n\t\t\tbreak;\r\n\t\tcase 11:\r\n\t\t\tcolor = color12;\r\n\t\t\tbreak;\r\n\t\tcase 12:\r\n\t\t\tcolor = color13;\r\n\t\t\tbreak;\r\n\t\tcase 13:\r\n\t\t\tcolor = color14;\r\n\t\t\tbreak;\r\n\t\tcase 14:\r\n\t\t\tcolor = color15;\r\n\t\t\tbreak;\r\n\t\tcase 15:\r\n\t\t\tcolor = color16;\r\n\t\t\tbreak;\t\r\n\t\tcase 16:\r\n\t\t\tcolor = color17;\r\n\t\t\tbreak;\t\r\n\t\tcase 17:\r\n\t\t\tcolor = color18;\r\n\t\t\tbreak;\t\r\n\t\tcase 18:\r\n\t\t\tcolor = color19;\r\n\t\t\tbreak;\t\r\n\t\tcase 19:\r\n\t\t\tcolor = color20;\r\n\t\t\tbreak;\t\t\t\r\n\t\tdefault:\r\n\t\t\tcolor = color1;\r\n\t\t\tbreak;\r\n\t}\r\n    \r\n    for ( ii = BarCount - tbar; ii &lt; BarCount; ii++ )\r\n    {\r\n\t\tif (ii == BarCount - 1)\r\n\t\t\top = 0;\r\n\t\telse\r\n\t\t\top = 1;\r\n        drawpos( rs[ ii ], rm[ ii ], color, sym, op  );  \r\n    }\r\n    //WriteIf( ii == BarCount - 1, sym, "" )\r\n\r\n    RestorePriceArrays( True );\r\n}\r\n\r\n_SECTION_END();\r\n</Formula>
			<FilePath>Formulas\\Custom\\RRG 1.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-15.0714</Min>
			<Max>35.35</Max>
		</Pane>
	</Sheet>
	<Sheet>
		<Name>heat map</Name>
		<Pane>
			<ChartID>1082</ChartID>
			<PercentHeight>100</PercentHeight>
			<Formula>//------------------------------------------------------------------------------\r\n\r\n//  Formula Name  : Heat Map and Watchlist flow\r\n\r\n//  Edit by       : HuyTuan \r\n\r\n//  Phone         : 0937798534\r\n\r\n//  Last Update   : 03 June 2023\r\n\r\n//  Version       : 3.0\r\n\r\n// Amibroker Group: https://t.me/amibrokercodevn\r\n\r\n// About me\t\t  : https://t.me/huytuanvt\r\n\r\n// Moi ung ho xin gui vao stk: 0081001154112 - Le Xuan Tuan - Ngan Hang VCB Vung Tau\r\n\r\n//-----------------------------------------------------------------------------\r\n\r\n\r\npxwidth = Status( "pxwidth" );\r\npxheight = Status( "pxheight" );\r\nfixx=1/1880*pxwidth;\r\nfixy=1/870*pxheight;\r\ncolorNen=ParamColor("colorNen", ColorRGB(240,240,240));\r\nGfxSelectSolidBrush( colorNen );\r\nGfxRoundRect( 0, 0 , pxwidth , pxheight , 0, 0 );\r\n_SECTION_BEGIN("Heatmap");\r\nWatchList = "";\r\n//////////////////////////////////////////////////////////////////\r\n\r\nprocedure SetOrigin(x0, y0) {\r\n\tglobal _x0, _y0;\r\n\t_x0 = x0; _y0 = y0;\r\n}\r\n_cursorMouseButtons = GetCursorMouseButtons();\r\nDT_CENTER = 1; DT_VCENTER = 4 | 32; \r\nfunction GfxGetState(id) {\r\n\treturn Nz(StaticVarGet("GfxState"+id+GetChartID()), 0);\r\n}\r\nfunction PointInside(x0, y0, x, y, width, height) {\r\n    global _x0, _y0;\r\n\tx = x+_x0; y = y+_y0;\r\n    x0 = x0+_x0; y0 = y0+_y0;\r\n\treturn ((x0 &gt;= x) &amp;&amp; (y0 &gt;= y) &amp;&amp; (x0 &lt;= (x+width)) &amp;&amp; (y0 &lt;= (y+height)));\r\n}\r\nfunction LeftClickInside(x, y, width, height) {\r\n\tglobal _cursorMouseButtons, _x0, _y0;\r\n\tlocal px, py, res;\r\n\t//x = x+_x0; y = y+_y0;\r\n\tres = False;\r\n\tif (_cursorMouseButtons &amp; 8) { // click\r\n\t\tpx = GetCursorXPosition(1); \r\n\t\tpy = GetCursorYPosition(1); \r\n\t\tres = PointInside(px, py, x, y, width, height);\r\n\t}\r\n\treturn res;\r\n}\r\nprocedure GfxSetState(id, val) {\r\n\tStaticVarSet("GfxState"+id+GetChartID(), val);\r\n}\r\nfunction GfxHTabs(id, headers, headheight, x, y, width, height, colorfg, colorbg) {\r\n\tglobal _x0, _y0;\r\n\tlocal py,choice,na,i,n,header,w, wi, prevwi;\r\n\tx = x+_x0; y = y+_y0; choice = GfxGetState(id);\r\n\tfor(n = 0; (header = StrExtract(headers,n)) != ""; ++n) {};\r\n\tw = width/n; wi = y; prevwi = y;\r\n\tif (LeftClickInside(x,y,width,height)) {\r\n\t\tpy = GetCursorYPosition( 1 );\r\n\t\t//px = GetCursorXPosition(1); \r\n\t\t//choice = floor((px - x)/w);\r\n\t\t //wi = y; prevwi = y;\r\n\t\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\t\twi =wi+headheight;\r\n\t\t\t\r\n\t\t\tif ((py &gt; prevwi) &amp;&amp; (py &lt; wi))  { choice = i; break; }\r\n\t\t}\r\n\t\tGfxSetState(id, choice); // StaticVarSet(na, choice);\r\n\t}\r\n\tGfxSetBkMode(1);\r\n\t// Draw Zone &amp; Tabs\r\n\twi = y; prevwi = y;\r\n\tfor(i = 0; (header = StrExtract(headers,i)) != ""; ++i) {\r\n\t\twi = wi + headheight;\r\n\t\t GfxSelectSolidBrush(colorPaleGreen); \r\n\t\t GfxSelectPen( colorLightGrey, 0 ); // data tooltip round border color\r\n\t\tGfxRoundRect(x,prevwi-1,x+width,wi,5,5); \r\n\t\tGfxSelectSolidBrush( colorbg );\r\n\t\tif (i != choice) {\r\n\t\t\tGfxSelectHatchBrush(colorbg,7); \r\n\t\t\tGfxRoundRect(x,prevwi-1,x+width,wi,5,5);\r\n\t\t\tGfxSelectSolidBrush( colorbg );\r\n\t\t} else {\r\n\t\t\twic = wi; prevwic = prevwi;\r\n\t\t}\r\n\t\tGfxSetTextColor( colorDarkGrey );\r\n\t\tGfxSelectFont("Verdana",8*fixy, 500);//Tahoma\r\n\t\tGfxDrawText(header, (x-100)*fixx, prevwi, (x+235)*fixx, wi, 1|4|32);\r\n////////\r\n\tprevwi = wi;\r\n\t}\r\n\treturn choice;\r\n}\r\nprocedure GfxTSI(x,y) {\r\n\tSetOrigin(x,y);\r\nNGANHANG=ParamStr("NGAN HANG","ABB,ACB,BAB,BID,BVB,CTG,EIB,HDB,KLB,LPB,MBB,MSB,NAB,NVB,OCB,PGB,SGB,SHB,STB,TCB,TPB,VBB,VCB,VIB,VPB,SSB,VAB");\r\nCHUNGKHOAN=ParamStr("CHUNG KHOAN","AAS,AGR,APG,BSI,BVS,CTS,EVF,EVS,FTS,HCM,MBS,SBS,SHS,SSI,VCI,VDS,VIX,VND,APS,HBS,IVS,ORS,TVB,TVS,VIG,WSS,BMS,TCI,VFS");\r\nTHEP=ParamStr("THEP","BVG,HMC,HPG,HSG,NKG,POM,SHA,SHI,SMC,TLH,TVN,VGS,TNS,VCA,KVC,NSH,ITQ");\r\nDAUKHI=ParamStr("DAU KHI","BSR,CNG,GAS,OIL,PET,PLX,POW,PSH,PVB,PVC,PVD,PVS,PVT,PVX,PXS,PGC,PLC");\r\nBAOHIEM=ParamStr("BAO HIEM","BVH,BMI,MIG,PVI,BIC,ABI,VNR");\r\nBATDONGSAN=ParamStr("BAT DONG SAN","AGG,BII,CCL,CEO,DIG,DLG,DPG,DRH,DTD,DXG,HAR,HBC,HDC,HDG,HLD,HQC,HUT,IJC,KDH,LGL,MCG,NBB,NDN,NTL,NVL,PDR,SCR,TCH,TDH,VHM,VIC,VPH,VRE,HTN,VMC,CRE,DTA,HAG,IDJ,IDV,ITC,NHA,OGC,SGR,AAV,API,DXS,FIR,HPX,KHG,NRC,PWA,TEG,VPI,VRC");\r\nBDSKCN=ParamStr("BDS-KCN","D2D,GVR,IDC,ITA,KBC,LDG,LHG,NLG,NTC,PHR,QCG,REE,SIP,SJS,SZC,SZL,TDC,TIG,TIP");\r\nXD_VLXD=ParamStr("XD_VLXD","VCG,VC7,HU4,MST,ROS,VC3,ACC,QNC,SCL,VGC,BCE,CSC,HTI,TTB,APC,C69,CDO,CRC,HID,HVH,LIG,PAS,S99,SCG,SCI,SDP,TLD,UDJ,EVG,CTD,PHC,CKG");\r\nDAUTUCONG=ParamStr("DAU TU CONG","BCC,BTS,C32,C47,C4G,CII,CTI,DHA,FCN,G36,HOM,HT1,KSB,LCG,SD5,SD6,SD9,TCD,THG,TV2");\r\nCAOSU=ParamStr("CAO SU","DPR,DRC,DRI,GVR,PHR,VHG,HNG");\r\nDETMAY=ParamStr("DET MAY","ADS,EVE,FTM,GIL,KMR,MSH,STK,TCM,TNG,VGT");\r\nTHANKHOANGSAN=ParamStr("THAN - KHOANG SAN","CLX,KSB,MDC,NBC,NNC,TDN,THT,TVD,VEF,CST,BMC,DHM,KHB,KSQ,MSR,TC6,TNT");\r\nTHUYSAN=ParamStr("THUYSAN","ACL,ANV,ASM,CMX,FMC,IDI,MPC,VHC");\r\nTHUCPHAMXK=ParamStr("THUC PHAM-XK","AFX,DBC,DHC,GTN,KDC,LTG,MHC,MSN,NAF,PTB,TNA,VCS,VLC,VNM,VOC,APF,BNA,KDF,MCM,MLS,TAR,VHE");\r\nHOACHATPHANBON=ParamStr("HOA CHAT - PHAN BON","BFC,CSV,DCM,DDV,DGC,DPM,LAS,LIX,QBS,TSC,PMB,SBV,HCD,ABS");\r\nBLECONGNGHE=ParamStr("CONG NGHE - BAN LE","CMG,DGW,ELC,FOX,FPT,FRT,ITD,MWG,PET,PNJ,SAB,SGT,SAM,SRA,TTN,CTR,VGI");\r\nCANGVANTAI=ParamStr("CANG - VAN TAI","DVP,DXP,GMD,HAH,PHP,PVP,PVT,SGP,SKG,SWC,TCL,TCW,VIP,VOS,VSC,VTO,STG,GSP,HHG,TCO,TMS,VNA,ILB,PVP");\r\nDICHVU=ParamStr("DICH VU","HAX,PAN,TCT,VNG,VTP,KLF");\r\nDIEN_NANGLUONG=ParamStr("DIEN_NANGLUONG","KHP,PPC,PVG,QTP,VSH,TTA,GEG,SJD,NT2,REE,PC1,HND,GEX,VNE");\r\nDTPT=ParamStr("DTPT","EID,FID,FIT,HHS,SJF,VCR,SHN");\r\nDUONGGO=ParamStr("DUONG - GO","GDT,LSS,QNS,SBT,TTF");\r\nHANGKHONGDULICH=ParamStr("HANG KHONG-DU LICH","ACV,AST,HVN,SAS,VJC,VTD,NCT,DAH,RIC");\r\nNUOCNHUA=ParamStr("NUOC NHUA","AAA,APH,BMP,BWE,DAG,NTP,TDM,VNP,HII,NHH,PGN,PLP");\r\nSXKD=ParamStr("SXKD","DQC,HAP,NAG,PAC,RAL,SAV,TLG");\r\nYTEDUOC=ParamStr("YTEDUOC","AMV,DBD,DCL,DHG,DMC,DVN,JVC,TNH");\r\n//////\r\nn = GfxHTabs("HTab1", "NG\\u00C2N H\\u00C0NG,CH\\u1EE8NG KHO\\u00C1N,TH\\u00C9P,D\\u1EA6U KH\\u00CD,B\\u1EA2O HI\\u1EC2M,B\\u1EA4T \\u0110\\u1ED8NG S\\u1EA2N,BDS - KCN,XD - VLXD,\\u0110\\u1EA6U T\\u01AF C\\u00D4NG,CAO SU, D\\u1EC6T MAY,THAN-KS,TH\\u1EE6Y S\\u1EA2N,TH\\u1EF0C PH\\u1EA8M-XK,H/CH\\u1EA4T-P/B\\u00D3N,B/L\\u1EBA-C/NGH\\u1EC6,C\\u1EA2NG-V\\u1EACN T\\u1EA2I,D\\u1ECACH V\\u1EE4,\\u0110I\\u1EC6N-N/L\\u01AF\\u1EE2NG,DTPT,\\u0110\\u01AF\\u1EDCNG G\\u1ED6,H/KH\\u00D4NG - DL,N\\u01AF\\u1EDA\\u0043 NH\\u1EF0A,SXKD,YT\\u1EBE-D\\u01AF\\u1EE2\\u0043,THEO D\\u00D5I TU\\u1EA6N,THEO D\\u00D5I NG\\u00C0Y,CP NOTE", 28.5*fixy, 0, 0, 135*fixx, 1200, colorBlack, ColorBlend( colorLime, colorWhite, 0.9 )); \r\nswitch(n) {\r\ncase 0: \r\nWatchList =NGANHANG;\r\nbreak;\r\ncase 1: \r\nWatchList =CHUNGKHOAN;\r\nbreak;\r\ncase 2: \r\nWatchList =THEP;\r\nbreak;\r\ncase 3: \r\nWatchList =DAUKHI;\r\nbreak;\r\ncase 4: \r\nWatchList =BAOHIEM;\r\nbreak;\r\ncase 5: \r\nWatchList =BATDONGSAN;\r\nbreak;\r\ncase 6: \r\nWatchList =BDSKCN;\r\nbreak;\r\ncase 7: \r\nWatchList =XD_VLXD;\r\nbreak;\r\ncase 8: \r\nWatchList =DAUTUCONG;\r\nbreak;\r\ncase 9: \r\nWatchList =CAOSU;\r\nbreak;\r\ncase 10: \r\nWatchList =DETMAY;\r\nbreak;\r\ncase 11: \r\nWatchList =THANKHOANGSAN;\r\nbreak;\r\ncase 12: \r\nWatchList =THUYSAN;\r\nbreak;\r\ncase 13: \r\nWatchList =THUCPHAMXK;\r\nbreak;\r\ncase 14: \r\nWatchList =HOACHATPHANBON;\r\nbreak;\r\ncase 15: \r\nWatchList =BLECONGNGHE;\r\nbreak;\r\ncase 16: \r\nWatchList =CANGVANTAI;\r\nbreak;\r\ncase 17: \r\nWatchList =DICHVU;\r\nbreak;\r\ncase 18: \r\nWatchList =DIEN_NANGLUONG;\r\nbreak;\r\ncase 19: \r\nWatchList =DTPT;\r\nbreak;\r\ncase 20: \r\nWatchList =DUONGGO;\r\nbreak;\r\ncase 21: \r\nWatchList =HANGKHONGDULICH;\r\nbreak;\r\ncase 22: \r\nWatchList =NUOCNHUA;\r\nbreak;\r\ncase 23: \r\nWatchList =SXKD;\r\nbreak;\r\ncase 24: \r\nWatchList =YTEDUOC;\r\nbreak;\r\ncase 25: \r\nWatchlistName1 = ParamStr("WL1", "Theo Doi");\r\nwlnumber = CategoryFind(WatchlistName1, cat = categoryWatchlist); \r\nWatchList =CategoryGetSymbols(cat, wlnumber);\r\nbreak;\r\ncase 26: \r\nWatchlistName = ParamStr("WL2", "TD New");\r\nwlnumber = CategoryFind(WatchlistName, cat = categoryWatchlist); \r\nWatchList =CategoryGetSymbols(cat, wlnumber);\r\nbreak;\r\ncase 27: \r\nWatchlistName = ParamStr("WL3", "Note");\r\nwlnumber = CategoryFind(WatchlistName, cat = categoryWatchlist); \r\nWatchList =CategoryGetSymbols(cat, wlnumber);\r\nbreak;\r\n}}\r\nx = Param("X_Menu", 0, 0, 1980, 20);\r\ny1 = Param("Y_Menu", 68, 0, 1980, 20);\r\ny=y1*fixy;\r\nGfxTSI(x,y);\r\n\r\n\r\nNumRowColumn        = Param("Number of Rows/Columns:", 8, 2, 10, 1);\r\nBasePeriod      = 30;\r\nglobal Prefix, Suffix, SgnFlag, format, TrendAngle;\r\nSgnFlag         = 1;\r\nTotalScore      = 0;\r\nMouseFlag       = 0;\r\nTimeStamp       = 0;\r\nExecuteTime     = 0;\r\nNumTickers      = NumRowColumn^2;\r\nTrigger         = 0;\r\nDoRefresh       = 0;\r\nBackGroundColor = 0;\r\nEnableScript("JScript");\r\n &lt;%\r\n function SetChartTicker(newTicker)\r\n{\r\n AB = new ActiveXObject("Broker.Application");\r\n AB.ActiveDocument.Name = newTicker;\r\n return 1;\r\n}\r\n %&gt;\r\n function GetSymbols()\r\n{\r\n TickerList = "";\r\n\r\n for(n = 0; n &lt; NumTickers; n++)\r\n    {\r\n     Ticker         = StrExtract(WatchList,n);\r\n     TickerList     = TickerList + Ticker + ",";\r\n    }\r\n return TickerList;\r\n}\r\n function GetSecondNum()\r\n{\r\n    Time        = Now( 4 );\r\n    Seconds     = int( Time % 100 );\r\n    Minutes     = int( Time / 100 % 100 );\r\n    Hours       = int( Time / 10000 % 100 );\r\n    SecondNum = int( Hours * 60 * 60 + Minutes * 60 + Seconds );\r\n    return SecondNum;\r\n}\r\nglobal SVKey;\r\nSVKey = NumToStr(GetChartID(),1.0,False);\r\n \r\nprocedure xStaticVarSet( SName, SValue )\r\n{\r\n global SVKey;\r\n InIndicator = Status("Action") == 1;\r\n if( InIndicator ) StaticVarSet(Sname+SVKey, Svalue);\r\n}\r\nfunction xStaticVarGet( SName )\r\n{\r\n global SVKey;\r\n if( IsNull( Var = StaticVarGet(Sname+SVKey) ) ) Var = 0;;\r\n return Var;\r\n}\r\nprocedure xStaticVarSetText( SName, SValue )\r\n{\r\n global SVKey;\r\n InIndicator = Status("Action") == 1;\r\n if( InIndicator ) StaticVarSetText(Sname+SVKey, Svalue);\r\n}\r\nfunction xStaticVarGetText( SName )\r\n{\r\n global SVKey;\r\n return StaticVarGetText(Sname+SVKey);\r\n}\r\nfunction GetScore(Ticker )\r\n{\r\n     C1      = SelectedValue(TimeFrameGetPrice( "C", inDaily, -1 ));\r\n    Value   = (LastValue(Close)-LastValue(Ref(Close,-1)))/LastValue(Ref(Close,-1))*100;\r\n    Prefix  = "Chg%: ";\r\n    Suffix  = "%";\r\n    SgnFlag= 0;\r\n    format  = 1.2;\r\n     xStaticVarSetText("Prefix", Prefix);\r\nxStaticVarSetText("Suffix", Suffix);\r\nxStaticVarSet("SgnFlag", SgnFlag);\r\nxStaticVarSet("format", format);\r\n\r\nreturn Value;\r\n}\r\n//====================================================================\r\nprocedure getPositionScores(WatchList, NumTickers)\r\n{\r\n    global TopTickerList, TopTickerClose, TopTickerVolume, TickerList, TopTickerScore, TopTickerNum, TotalScore, MaxNegVal, MinNegVal, MaxPosVal, MinPosVal;\r\n    TotalScore      = 0;\r\n    TickerList      = GetSymbols();\r\n    CompTickers = "";\r\n    MaxNegVal       = 0;\r\n    MinNegVal       = -100000000;\r\n    MaxPosVal       = 0;\r\n    MinPosVal       = 100000000;\r\n    TickerClose = TickerVolume = TickerScores = Tickerindex = 0;\r\n \r\n    // Create zero-based Scores array in wrt to current data\r\n    for( n = 0; (Ticker = StrExtract(TickerList, n)) != ""; n++)\r\n        {\r\n        SetForeign(Ticker);\r\n        Temp    = LastValue(GetScore(Ticker));\r\n        SClose = LastValue(Close);\r\n        SVolume = LastValue(Volume);\r\n        TotalScore  = TotalScore + abs(temp);\r\n \r\n\r\n \r\n        if(temp &lt; 0){\r\n        if(MinNegVal &lt; temp) MinNegVal = temp;\r\n        if(MaxNegVal &gt; temp) MaxNegVal = temp;}\r\n \r\n        if(temp &gt; 0){\r\n        if(MinPosVal &gt; temp) MinPosVal = temp;\r\n        if(MaxPosVal &lt; temp) MaxPosVal = temp;}\r\n \r\n        RestorePriceArrays();\r\n        TickerScores[n]     = Temp;\r\n        TickerIndex[n]  = n;\r\n        TickerClose[n]  = SClose;\r\n        TickerVolume[n]  = SVolume;\r\n        }\r\n \r\n    TickerCount= n;\r\n    TopTickerList  = TopTickerClose = TopTickerVolume = TopTickerNum = TopTickerScore = Toptickerlist     = "";\r\n    i = 0;\r\n \r\nif( TotalScore &gt; 0)\r\n{      \r\n    // Sort Tickers by rank\r\n    for(i = n; i &gt; 0; i--)\r\n        {\r\n        for (j = 1; j &lt; i; j++)\r\n            {\r\n            if (TickerScores[j-1] &gt; TickerScores[j])\r\n                {\r\n                temp                = TickerScores[j-1];\r\n                TickerScores[j-1]   = TickerScores[j];\r\n                TickerScores[j]     = temp;\r\n                temp                = TickerIndex[j-1];\r\n                TickerIndex[j-1]    = TickerIndex[j];\r\n                TickerIndex[j]  = temp;\r\n                }\r\n            }\r\n        }\r\n \r\n    for(n = TickerCount-1; n &gt; -1; n--)\r\n        {\r\n        T5[i++]             = TickerIndex[n];\r\n        Ticker          = StrExtract(Tickerlist,T5[i-1]);\r\n        SClose              = NumToStr(TickerClose[T5[i-1]],1.2,0);\r\n        SVolume              = NumToStr(TickerVolume[T5[i-1]],1.0,0);\r\n        Score           = NumToStr(TickerScores[n],1.2,0);\r\n        TickerNum           = NumToStr(TickerIndex[n],1.0,0);\r\n        TopTickerList   = TopTickerList + Ticker + ",";\r\n        TopTickerClose  = TopTickerClose + SClose + ",";\r\n        TopTickerVolume  = TopTickerVolume + SVolume + ",";\r\n        TopTickerScore  = TopTickerScore + Score +",";\r\n        TopTickerNum        = TopTickerNum + TickerNum +",";\r\n        }\r\n}\r\nelse //But if we do not want to sort the Tickers, then we need to do this:\r\n{   for(n = 0; n &lt; 100; n++)\r\n        {\r\n        Ticker          = StrExtract(Tickerlist,n);\r\n        SClose              = NumToStr(TickerClose[n],1.2,0);\r\n        SVolume              = NumToStr(TickerVolume[n],1.0,0);\r\n        Score           = NumToStr(TickerScores[n],1.2,0);\r\n        TickerNum           = NumToStr(TickerIndex[n],1.0,0);\r\n        TopTickerList   = TopTickerList + Ticker + ",";\r\n        TopTickerClose  = TopTickerClose + SClose + ",";\r\n        TopTickerVolume  = TopTickerVolume + SVolume + ",";\r\n        TopTickerScore  = TopTickerScore + Score +",";\r\n        TopTickerNum        = TopTickerNum + TickerNum +",";\r\n        }\r\n}\r\nxStaticVarSet("TotalScore", TotalScore);\r\nxStaticVarSet("MinNegVal", MinNegVal);\r\nxStaticVarSet("MaxNegVal", MaxNegVal);\r\nxStaticVarSet("MinPosVal", MinPosVal);\r\nxStaticVarSet("MaxPosVal", MaxPosVal);\r\nxStaticVarSetText("TopTickerList", TopTickerList);\r\nxStaticVarSetText("TopTickerClose", TopTickerClose);\r\nxStaticVarSetText("TopTickerVolume", TopTickerVolume);\r\nxStaticVarSetText("TopTickerScore", TopTickerScore);\r\nStaticVarSetText("CompTickers",CompTickers);\r\n//Let you retrieve the list of Tickers in the Composite from other Indicators.\r\nxStaticVarSet("BackGroundColor", colorWhite);\r\n}\r\n//====================================================================\r\n// DEFINE THE COLORS FOR THE SYMBOL RECTANGLES:\r\n// Higher positive value = green, Lower positive value = light green\r\n// Higher negative value = red  , Lower negative value = pink\r\n//====================================================================\r\nfunction FillColor(Value)\r\n{\r\nUpRed       = 0;\r\nUpGreen = 255;\r\nUpBlue      = 0;\r\nDnRed       = 255;\r\nDnGreen = 0;\r\nDnBlue      = 0;\r\nDarkColor   = 0;\r\nLightColor  = 230;\r\n////////==0\r\n Red=255;\r\n Green = 255;\r\n Blue =200;    \r\nif(Value &gt; 0)\r\n{\r\n    UpRed = LightColor - int((LightColor -(((MaxPosVal-Value)*(LightColor-DarkColor))/(MaxPosVal-MinPosVal))));\r\n    if(Value == 0) UpRed = 255;\r\n    UpBlue = UpRed;\r\n}\r\nif(Value &lt; 0)\r\n{\r\n    DnGreen = LightColor - int((LightColor -(((abs(MaxNegVal)-abs(Value))*(LightColor-DarkColor))/(abs(MaxNegVal)-abs(MinNegVal)))));\r\n    if(Value == 0) DnGreen = 255;\r\n    DnBlue = DnGreen;\r\n}\r\n \r\n if(Value == 0)\r\n{\r\n   Red=255;\r\n   Green = 255;\r\n    Blue =200;\r\n}\r\nColor   = IIf(Value &gt; 0,ColorBlend( ColorRGB(UpRed, UpGreen, UpBlue), colorWhite, 0.5 ) ,IIf(Value &lt; 0,ColorBlend( ColorRGB(DnRed, DnGreen, DnBlue), colorWhite, 0.5 ),ColorBlend(ColorRGB(Red, Green, Blue), colorWhite, 0.4 ) ));\r\nreturn Color;\r\n}\r\n\r\n\r\n//====================================================================\r\n// CAN SWITCH OFF THE INDICATOR, SINCE IT'S VERY POWER HUNGRY!\r\n// BUT THE REFRESH TIME CAN ALSO BE SET: 1- 300 SECONDS.\r\n//====================================================================\r\nif( Status("Action") == 1 )\r\n{\r\n \r\n\r\n Value      = 0;\r\n Prefix     = "";\r\n Suffix     = "";\r\n SgnFlag        = 0;\r\n format     = 0;\r\n//====================================================================\r\n// GET STATIC VALUES, CHECK IF ANYTHING UPDATED AND REFRESH ACCORDINGLY\r\n//====================================================================\r\n RefreshFlag        = 0;\r\n Prefix             = xStaticVarGetText("Prefix");\r\n Suffix             = xStaticVarGetText("Suffix");\r\n SgnFlag            = xStaticVarGet("SgnFlag");\r\n format         = xStaticVarGet("format");\r\n \r\n TotalScore         = xStaticVarGet("TotalScore");\r\n MinNegVal      = xStaticVarGet("MinNegVal");\r\n MaxNegVal      = xStaticVarGet("MaxNegVal");\r\n MinPosVal      = xStaticVarGet("MinPosVal");\r\n MaxPosVal          = xStaticVarGet("MaxPosVal");\r\n TopTickerList  = xStaticVarGetText("TopTickerList");\r\n TopTickerClose = xStaticVarGetText("TopTickerClose");\r\n TopTickerVolume = xStaticVarGetText("TopTickerVolume");\r\n TopTickerScore = xStaticVarGetText("TopTickerScore");\r\n \r\n TimePeriod = Interval();\r\n\r\n {\r\n  RefreshFlag = 1;\r\n  //xStaticVarSet("ParamTotal", ParamTotal);\r\n  //xStaticVarSetText("SortBy", SortBy);\r\n  xStaticVarSet("BasePeriod", BasePeriod);\r\n  xStaticVarSet("TimePeriod", TimePeriod);\r\n  xStaticVarSet("MouseFlag", 0);\r\n }\r\n \r\nTimeFrame = Interval();\r\nSecNumber = GetSecondNum();\r\nNewperiod = SecNumber % TimeFrame == 0;\r\nSecsLeft    = SecNumber - int( SecNumber / TimeFrame ) * TimeFrame;\r\nSecsToGo    = TimeFrame - SecsLeft;\r\nif(xStaticVarGet("DoRefresh"))\r\n{\r\nif(NumTickers &lt; BarCount)\r\n{\r\n xStaticVarSet("DoRefresh", False);\r\n GetPerformanceCounter(True);\r\n getPositionScores(WatchList, NumTickers);\r\n xStaticVarSet("ExecuteTime", GetPerformanceCounter());\r\n}\r\nelse\r\n    PopupWindow( "Edited by Huy Tuan-0937798534    (https://t.me/amibrokercodevn)", "Heatmap and Watchlist flow!", 5, -1, -1 );\r\n}\r\n     xStaticVarSet("Trigger", True);\r\n \r\nif(xStaticVarGet("Trigger"))\r\n{\r\n Time = NumToStr(Now(4) , 1.0, 0);\r\n if(StrLen(Time)== 4) Time = "00"+Time;\r\n if(StrLen(Time)== 5) Time = "0"+Time;\r\n Hours  = StrLeft(Time, 2);\r\n Minutes    = StrMid(Time, 2, 2);\r\n Seconds    = StrRight(Time, 2);\r\n xStaticVarSetText("TimeStamp", Hours+":"+Minutes+":"+Seconds);\r\n \r\nxStaticVarSet("DoRefresh",True); // this queues the refresh operation for the next pass through the code\r\nxStaticVarSet("Trigger", False);\r\nxStaticVarSet("BackGroundColor", ColorRGB(255, 255, 150));\r\n}\r\n SetChartBkColor(Nz(xStaticVarGet("BackGroundColor")));\r\n//====================================================================\r\n// THE GRAPHIC PRESENTATION:\r\n//====================================================================\r\n x2         = Status("pxchartright");\r\n y2         = Status("pxchartbottom");\r\nPenColor   = ColorBlend( colorBlack, colorWhite, 0.2 );\r\nPenColor1   = ColorBlend( colorBlack, colorWhite, 0.5 );\r\n Width  = Param("Width", 217.5, 100, 500, 1);\r\n Hight    = Param("Hight", 100, 50, 200, 1);\r\n StartX =1;\r\n StartY =1;\r\n khoangtren1=Param("khoangtren:", 65, 0, 200, 1);\r\n khoangtren= khoangtren1*fixy;\r\n\r\n PointSize  = 10;\r\n Weight = 100;\r\n GfxSetBkMode(1);\r\n//////////////\r\n\r\n\r\n for( i = 0; i &lt; NumRowColumn; i++ )\r\n {\r\n    for(e=0; e &lt; NumRowColumn; e++)\r\n    {\r\n        Symbol  = StrExtract(TopTickerList, i + (e * NumRowColumn));\r\n        ForClose    = StrExtract( TopTickerClose, i + (e * NumRowColumn));\r\n        ForVolume    = StrExtract( TopTickerVolume, i + (e * NumRowColumn));\r\n        Value2  = StrToNum(StrExtract(TopTickerScore, i + (e * (NumRowColumn))));\r\n        Sgn = IIf(SgnFlag &lt; 1, 1, IIf( Value2 &gt; 0, 1, -1));\r\n        Favourites = CategoryGetSymbols(categoryFavorite, 0);\r\n        sym_num = StrCount(WatchList, ",")+1;\r\n        CO=IIf(i + (e * NumRowColumn)&lt;sym_num,FillColor(Value2),colorNen);\r\n        CO1=IIf(i + (e * NumRowColumn)&lt;sym_num,PenColor,colorNen);\r\n        CO2=IIf(i + (e * NumRowColumn)&lt;sym_num,PenColor1,colorNen);\r\n        PenWidth = IIf(StrFind(","+Favourites+",", ","+Symbol+",") &gt; 0, 4, 1);\r\n        GfxSelectPen(CO2,1);\r\n        //GfxSetTextAlign( 0 );\r\n        GfxSelectSolidBrush(CO);\r\n        Result  = NumToStr(Sgn * Value2, Format,1);\r\n        //mav20=ForVolume/MA(ForVolume,20);\r\n        GfxRoundRect( (StartX + ((i+1) * Width)-80)*fixx, (StartY+1 + (e * Hight))*fixy+khoangtren, (Width * (i+2)-80)*fixx, Hight * (e+1)*fixy+khoangtren, 15, 15 );\r\n            PlotInformation ="\\r"+ "Gia: " + ForClose +"\\r"+ "Vol: " + ForVolume + "\\r"+ Prefix + Result + Suffix;\r\n            GfxSelectFont( "Arial", 17*fixy, 600 );\r\n\t\t\tGfxSetTextColor( CO1 );\r\n        GfxDrawText(Symbol, (StartX + ((i) * Width))*fixx, (16 + StartY + (e * Hight))*fixy+khoangtren, (Width * (i+2)-80)*fixx, Hight * (e+1)*fixy+khoangtren, 1);\r\n        GfxSelectFont( "Arial", 10*fixy, 600 );\r\n         GfxDrawText(ForClose, (StartX + ((i) * Width))*fixx, (16 + StartY+5 + (e * Hight))*fixy+khoangtren, (Width * (i+2)+50)*fixx, Hight * (e+1)*fixy+khoangtren, 1);\r\n         GfxDrawText(Result + Suffix, (StartX + ((i) * Width))*fixx, (16 + StartY+5 + (e * Hight))*fixy+khoangtren, (Width * (i+2)+200)*fixx, Hight * (e+1)*fixy+khoangtren, 1);\r\n         GfxSelectFont( "Arial", 11*fixy, 500 );\r\n         GfxDrawText("Volume: " +ForVolume, (StartX + ((i) * Width))*fixx, (6 + StartY+60 + (e * Hight))*fixy+khoangtren, (Width * (i+2)+50)*fixx, Hight * (e+1)*fixy+khoangtren, 1);\r\n     if (LeftClickInside((StartX + ((i+1) * Width)-80)*fixx,(StartY+1 + (e * Hight))*fixy+khoangtren,Width*fixx,Hight*fixy)) \r\n\t\t{\r\n\t\tpy = GetCursorYPosition( 1 );\r\n\t\tpx = GetCursorXPosition(1); \r\n\t\t//choice = floor((px - x)/w);\r\n\t\t //wi = y; prevwi = y;\r\n\t\t script = GetScriptObject();\r\n\t\tscript.SetChartTicker(Symbol);\r\n\t\t}\r\n    }}}\r\n\r\n\r\n//##KHUNG THI TRUONG CHUNG\r\n{\r\nListthitruongchung = "VNINDEX,VN30INDEX,HNXINDEX,UPCOMINDEX,VN30F1M";\r\nfor ( e = 0; e &lt;= 4; e++ ) \r\n{\r\nthitruong=StrExtract(Listthitruongchung, e);\r\nthitruong1=WriteIf(thitruong=="VN30INDEX","VN30",WriteIf(thitruong=="HNXINDEX","HNX",WriteIf(thitruong=="UPCOMINDEX","UPCOM",thitruong)));\r\nXX=IIf(thitruong=="VN30INDEX",15,IIf(thitruong=="HNXINDEX",10,0));\r\nCl_thitruong=Foreign(thitruong,"Close");\r\nROC_thitruong=ROC(Cl_thitruong,1);\r\nCHG_thitruong=LastValue(Cl_thitruong-Ref(Cl_thitruong,-1));\r\nthitruong_statusc1=WriteIf(LastValue(ROC_thitruong)&gt;0,WriteVal(LastValue(Cl_thitruong),1.2),"");\r\nthitruong_statusc2=WriteIf(LastValue(ROC_thitruong)&lt;0,WriteVal(LastValue(Cl_thitruong),1.2),"");\r\nthitruong_statusc3=WriteIf(LastValue(ROC_thitruong)==0,WriteVal(LastValue(Cl_thitruong),1.2),"");\r\nthitruong_statust1=WriteIf(LastValue(ROC_thitruong)&gt;0,WriteVal(LastValue(ROC_thitruong),1.2)+" %","");\r\nthitruong_statust2=WriteIf(LastValue(ROC_thitruong)&lt;0,WriteVal(LastValue(ROC_thitruong),1.2)+" %","");\r\nthitruong_statust3=WriteIf(LastValue(ROC_thitruong)==0,WriteVal(LastValue(ROC_thitruong),1.2)+" %","");\r\nGfxSetOverlayMode( 2 );\r\nGfxSetBkMode( 0 ); // transparent\r\nGfxSelectPen( colorLightGrey, 1 );\r\nGfxSelectSolidBrush( ColorBlend( colorLightGrey, colorWhite, 0.8 ) );\r\nGfxRoundRect(((303*e)+1)/1880*pxwidth, 0, (303*(e+1))/1880*pxwidth, 65/870*pxheight, 15, 15 );\r\nGfxSelectFont( "Verdana", 14/870*pxheight, 700 );\r\nGfxSetTextColor( colorGrey40 );\r\nGfxTextOut(thitruong1,(20+303*e+XX)/1880*pxwidth, 10/870*pxheight);\r\nGfxSelectFont( "Verdana", 12/870*pxheight, 500 );\r\nGfxTextOut(WriteVal(CHG_thitruong,1.2),(35+303*e)/1880*pxwidth, 35/870*pxheight);\r\n\tGfxSelectFont( "Verdana", 12/870*pxheight, 600 );\r\n    GfxSetTextColor( colorGreen);\r\n    GfxTextOut( thitruong_statusc1, (190+303*e)/1880*pxwidth, 10/870*pxheight );\r\n    GfxSelectFont( "Verdana", 10/870*pxheight, 600 );\r\n    GfxTextOut( thitruong_statust1, (190+303*e)/1880*pxwidth, 40/870*pxheight );\r\n    GfxSelectFont( "Verdana", 12/870*pxheight, 600 );\r\n    GfxSetTextColor( colorRed);\r\n    GfxTextOut( thitruong_statusc2, (190+303*e)/1880*pxwidth, 10/870*pxheight );\r\n    GfxSelectFont( "Verdana", 10/870*pxheight, 600 );\r\n    GfxTextOut( thitruong_statust2, (190+303*e)/1880*pxwidth, 40/870*pxheight );\r\n    GfxSelectFont( "Verdana", 12/870*pxheight, 600 );\r\n    GfxSetTextColor( colorDarkYellow);\r\n    GfxTextOut( thitruong_statusc3, (190+303*e)/1880*pxwidth, 10/870*pxheight );\r\n    GfxSelectFont( "Verdana", 10/870*pxheight, 600 );\r\n    GfxTextOut( thitruong_statust3, (190+303*e)/1880*pxwidth, 40/870*pxheight );\r\n}\r\n}\r\n\r\nGfxSelectSolidBrush( ColorBlend( colorLightGrey, colorWhite, 0.8 ) );\r\nGfxRoundRect( 1517/1880*pxwidth, 0, 1880/1880*pxwidth, 65/870*pxheight, 15, 15 );\r\n\t\tGfxSetOverlayMode( 2 );\r\n\t\tGfxSetBkMode( 0 );\r\n\t\tGfxSetTextAlign( 6 );\r\nGfxSelectFont("Verdana",10/870*pxheight, 700);\r\nGfxSetTextColor( colorBlue );\r\nGfxTextOut("TSI - HEATMAP", 1790/1880*pxwidth, 5/870*pxheight);\r\nGfxSelectFont("Verdana",8.5/870*pxheight, 500);\r\nGfxSetTextColor( colorDarkGrey );\r\nGfxTextOut("Date: "+Date(), 1790/1880*pxwidth, 25/870*pxheight);\r\nGfxTextOut("Time: " + Now( 2 ), 1790/1880*pxwidth, 45/870*pxheight);\r\nGfxSelectFont("Verdana",9/870*pxheight, 700);\r\nGfxSetTextColor( colorRed );\r\nGfxTextOut("EDIT BY HUY TUAN", 1620/1880*pxwidth, 15/870*pxheight);\r\nGfxTextOut("0 9 3 7 7 9 8 5 3 4", 1620/1880*pxwidth, 35/870*pxheight);\r\n</Formula>
			<FilePath>Formulas\\Indicators\\suutam\\Heat Map and Watchlist Follow.afl</FilePath>
			<Flags>256</Flags>
			<MoreFlags>1342177281</MoreFlags>
			<Min>-15.0714</Min>
			<Max>35.35</Max>
		</Pane>
	</Sheet>
</Window>
